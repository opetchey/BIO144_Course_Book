<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>R and RStudio (L2) – BIO144 Course Book (version 2026)</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./4.1-regression-part1.html" rel="next">
<link href="./1.1-intro.html" rel="prev">
<link href="./cover.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-485d01fc63b59abcd3ee1bf1e8e2748d.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./2.1-R-and-RStudio.html">R and RStudio (L2)</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">BIO144 Course Book (version 2026)</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/opetchey/BIO144_Course_Book/" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1.1-intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction (L1)</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2.1-R-and-RStudio.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">R and RStudio (L2)</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./4.1-regression-part1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Regression Part 1 (L3)</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./5.1-regression-part2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Regression Part 2 (L4)</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./6.1-anova.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Analysis of variance (ANOVA) (L5)</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./7.1-multiple-explanatory-variables-part1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Multiple explanatory variables Part 1 (L6)</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#sec-using-r-and-rstudio" id="toc-sec-using-r-and-rstudio" class="nav-link active" data-scroll-target="#sec-using-r-and-rstudio">Getting R and RStudio</a></li>
  <li><a href="#sec-getting-to-know-the-rstudio-ide" id="toc-sec-getting-to-know-the-rstudio-ide" class="nav-link" data-scroll-target="#sec-getting-to-know-the-rstudio-ide">Getting to know the RStudio IDE</a></li>
  <li><a href="#sec-getting-to-know-r" id="toc-sec-getting-to-know-r" class="nav-link" data-scroll-target="#sec-getting-to-know-r">Getting to know R</a></li>
  <li><a href="#sec-getting-help" id="toc-sec-getting-help" class="nav-link" data-scroll-target="#sec-getting-help">Getting help</a></li>
  <li><a href="#sec-add-on-packages" id="toc-sec-add-on-packages" class="nav-link" data-scroll-target="#sec-add-on-packages">Add-on packages</a></li>
  <li><a href="#sec-r-versions" id="toc-sec-r-versions" class="nav-link" data-scroll-target="#sec-r-versions">R Version and add-on package versions</a></li>
  <li><a href="#sec-r-projects" id="toc-sec-r-projects" class="nav-link" data-scroll-target="#sec-r-projects">R Projects</a></li>
  <li><a href="#sec-importing-data" id="toc-sec-importing-data" class="nav-link" data-scroll-target="#sec-importing-data">Importing data</a></li>
  <li><a href="#sec-viewing-data" id="toc-sec-viewing-data" class="nav-link" data-scroll-target="#sec-viewing-data">Viewing the data</a></li>
  <li><a href="#sec-data-wrangling" id="toc-sec-data-wrangling" class="nav-link" data-scroll-target="#sec-data-wrangling">Data wrangling</a>
  <ul class="collapse">
  <li><a href="#clean-the-variable-names" id="toc-clean-the-variable-names" class="nav-link" data-scroll-target="#clean-the-variable-names">Clean the variable names</a></li>
  <li><a href="#manipulate-the-data-frame" id="toc-manipulate-the-data-frame" class="nav-link" data-scroll-target="#manipulate-the-data-frame">Manipulate the data frame</a></li>
  <li><a href="#select-columns-select-columns" id="toc-select-columns-select-columns" class="nav-link" data-scroll-target="#select-columns-select-columns">Select columns [#select-columns]</a></li>
  <li><a href="#filter-getting-particular-rows-of-data-filter-rows" id="toc-filter-getting-particular-rows-of-data-filter-rows" class="nav-link" data-scroll-target="#filter-getting-particular-rows-of-data-filter-rows">Filter: Getting particular rows of data [#filter-rows]</a></li>
  <li><a href="#slice-getting-rows-by-position-slice-rows" id="toc-slice-getting-rows-by-position-slice-rows" class="nav-link" data-scroll-target="#slice-getting-rows-by-position-slice-rows">Slice: Getting rows by position [#slice-rows]</a></li>
  <li><a href="#arrange-reordering-rows-arrange-rows" id="toc-arrange-reordering-rows-arrange-rows" class="nav-link" data-scroll-target="#arrange-reordering-rows-arrange-rows">Arrange: Reordering rows [#arrange-rows]</a></li>
  <li><a href="#mutate-adding-new-variables-mutate-variables" id="toc-mutate-adding-new-variables-mutate-variables" class="nav-link" data-scroll-target="#mutate-adding-new-variables-mutate-variables">Mutate: Adding new variables [#mutate-variables]</a></li>
  <li><a href="#working-with-categorical-variables-sec-categorical-variables" id="toc-working-with-categorical-variables-sec-categorical-variables" class="nav-link" data-scroll-target="#working-with-categorical-variables-sec-categorical-variables">Working with categorical variables [#sec-categorical-variables]</a></li>
  </ul></li>
  <li><a href="#sec-visualisation" id="toc-sec-visualisation" class="nav-link" data-scroll-target="#sec-visualisation">Visualisation</a>
  <ul class="collapse">
  <li><a href="#three-basic-types-of-visualisation-three-basic-visualisations" id="toc-three-basic-types-of-visualisation-three-basic-visualisations" class="nav-link" data-scroll-target="#three-basic-types-of-visualisation-three-basic-visualisations">Three basic types of visualisation [#three-basic-visualisations]</a></li>
  <li><a href="#understanding-ggplot2-syntax-understanding-ggplot2" id="toc-understanding-ggplot2-syntax-understanding-ggplot2" class="nav-link" data-scroll-target="#understanding-ggplot2-syntax-understanding-ggplot2">Understanding ggplot2 syntax [#understanding-ggplot2]</a></li>
  <li><a href="#saving-ggplot-visualisations-saving-ggplot" id="toc-saving-ggplot-visualisations-saving-ggplot" class="nav-link" data-scroll-target="#saving-ggplot-visualisations-saving-ggplot">Saving ggplot visualisations [#saving-ggplot]</a></li>
  </ul></li>
  <li><a href="#extras" id="toc-extras" class="nav-link" data-scroll-target="#extras">Extras</a>
  <ul class="collapse">
  <li><a href="#making-reports-directly-using-quarto-quarto-reports" id="toc-making-reports-directly-using-quarto-quarto-reports" class="nav-link" data-scroll-target="#making-reports-directly-using-quarto-quarto-reports">Making reports directly using Quarto [#quarto-reports]</a></li>
  <li><a href="#combining-ggplots-with-patchwork-combining-ggplots" id="toc-combining-ggplots-with-patchwork-combining-ggplots" class="nav-link" data-scroll-target="#combining-ggplots-with-patchwork-combining-ggplots">Combining ggplots with patchwork [#combining-ggplots]</a></li>
  <li><a href="#sec-ref-level" id="toc-sec-ref-level" class="nav-link" data-scroll-target="#sec-ref-level">Setting a reference level in a linear model</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/opetchey/BIO144_Course_Book/edit/main/2.1-R-and-RStudio.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/opetchey/BIO144_Course_Book/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">R and RStudio (L2)</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="sec-using-r-and-rstudio" class="level2">
<h2 class="anchored" data-anchor-id="sec-using-r-and-rstudio">Getting R and RStudio</h2>
<p><strong><em>R</em></strong> is a programming language and software environment for statistical computing and graphics. RStudio is an integrated development environment (IDE) for R. <strong><em>RStudio</em></strong> provides a user-friendly interface for working with R, including a console, a script editor, and tools for managing packages and projects.</p>
<p>We highly recommend using <strong>RStudio</strong> to work with <strong>R</strong>.</p>
<p>There are two ways to use <strong>RStudio</strong>:</p>
<ol type="1">
<li><p><strong>RStudio Desktop</strong>: a standalone application that you can install on your computer. If you choose this option, you will need to install R first, and then install RStudio. This usually requires administrator privileges on your computer. If you have problems installing add-on packages, they will have to be fixed by you or with our help (rarely we cannot find a solution). Follow the instructions on this website about how to install R and RStudio: https://posit.co/download/rstudio-desktop/.</p></li>
<li><p><strong>Rstudio Cloud</strong>: a web-based version of RStudio that you can use in your web browser. You don’t need to install anything on your computer, and you can access your work from any computer with an internet connection. The Faculty of Science has a <a href="https://rstudio2024.mnf.uzh.ch">RStudio Cloud here</a> that you can use (and will have to use during the final exam).</p></li>
</ol>
<p>What do we recommend? Try the cloud first. If you like it then continue to use it.</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p>Whether you use the RStudio application on your computer, or use RStudio on the Cloud, you are responsible for the safety and persistence of your files (data, code, etc.). Just because you’re using RStudio on the Cloud does not mean your files are automatically saved forever. Make sure to download and back up your important files regularly!</p>
</div>
</div>
</section>
<section id="sec-getting-to-know-the-rstudio-ide" class="level2">
<h2 class="anchored" data-anchor-id="sec-getting-to-know-the-rstudio-ide">Getting to know the RStudio IDE</h2>
<p>When you open RStudio, you will see a window with four main panes:</p>
<ol type="1">
<li><strong>Source pane</strong>: where you can write and edit R scripts, R Markdown documents, and other files. This pane can have multiple tabs, so you can have several files open at the same time.</li>
<li><strong>Console pane</strong>: where you can type and execute R commands directly. This pane has multiple tabs, including: <strong>Console</strong>, <strong>Terminal</strong>, and <strong>Jobs</strong>. During this course we will mostly use the <strong>Console</strong> tab.</li>
<li><strong>Environment pane</strong>: where you can see the objects (data frames, vectors, etc.) that are currently in your R session. This pane has multiple tabs, including: <strong>Environment</strong>, <strong>History</strong>, <strong>Connections</strong>, and <strong>Tutorial</strong>. During this course we will mostly use the <strong>Environment</strong> tab.</li>
<li><strong>Files/Plots/Packages/Help pane</strong>: where you can manage files, view plots, manage packages, and access help documentation. This pane has multiple tabs, including: <strong>Files</strong>, <strong>Plots</strong>, <strong>Packages</strong>, <strong>Help</strong>, and <strong>Viewer</strong>. During this course we will mostly use the <strong>Files</strong>, <strong>Plots</strong>, <strong>Packages</strong>, and <strong>Help</strong> tabs.</li>
</ol>
<p>Our <strong>Scripts</strong> are in the Source pane tabs. The code / script we write in R is usually saved in a file with the extension <code>.R</code>. This file can be opened and edited in the Source pane. Creating a new R script: File &gt; New File &gt; R Script.</p>
<p>You can run code from the script by selecting the code and clicking the “Run” button, or by using the keyboard shortcut <code>Ctrl + Enter</code> (Windows) or <code>Cmd + Enter</code> (Mac).</p>
<p>There is so much more to learn about the RStudio IDE, but we will cover that as we go along in the course.</p>
</section>
<section id="sec-getting-to-know-r" class="level2">
<h2 class="anchored" data-anchor-id="sec-getting-to-know-r">Getting to know R</h2>
<p>In our newly opened script file, type the following code:</p>
<p>Then type the following code:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 7.389056</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4</code></pre>
</div>
</div>
<p>Select all the code and run it (using the “Run” button or <code>Ctrl + Enter</code> / <code>Cmd + Enter</code>). You should see the results of the calculations in the Console pane.</p>
<p>Now try assigning values to named object:</p>
<p>And then print the value of <code>c</code>:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] 15</code></pre>
</div>
</div>
<p>You should see the value <code>15</code> printed in the Console pane.</p>
<p>We can also create vectors:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1 2 3 4 5</code></pre>
</div>
</div>
<p>And do maths on vectors:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1]  2  4  6  8 10</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 11 12 13 14 15</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  1  4  9 16 25</code></pre>
</div>
</div>
<p>We can vectors of strings (text):</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] "apple"  "banana" "cherry"</code></pre>
</div>
</div>
<p>And can perform operations on strings:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] "I like apple"  "I like banana" "I like cherry"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "APPLE"  "BANANA" "CHERRY"</code></pre>
</div>
</div>
<p>And we can create data frames, which are like tables of data</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>     Name Age Height
1   Alice  25    165
2     Bob  30    180
3 Charlie  35    175</code></pre>
</div>
</div>
<p>Above we have numerous examples of functions: <code>exp()</code>, <code>sqrt()</code>, <code>c()</code>, <code>paste()</code>, <code>toupper()</code>, and <code>data.frame()</code>. Functions are a fundamental part of R programming. They are used to perform specific tasks, such as calculations, data manipulation, and data analysis. All functions have a name and can take arguments (inputs) and return values (outputs). They are called by writing the function name followed by parentheses, with any arguments inside the parentheses.</p>
<p>You likely guessed that there is much much more to learn about R, but we will cover that as we go along in the course.</p>
</section>
<section id="sec-getting-help" class="level2">
<h2 class="anchored" data-anchor-id="sec-getting-help">Getting help</h2>
<p>R has a built-in help system that you can use to get information about functions, packages, and other topics. To access the help system, you can use the <code>?</code> operator followed by the name of the function or topic you want to learn about. For example, to get help on the <code>mean()</code> function, you would type:</p>
<p>This will open the help documentation for the <code>mean()</code> function in the Help pane of RStudio. The documentation includes a description of the function, its arguments, and examples of how to use it. Some of the help documentation is very useful and accessible, other is less so. Over time you will learn which functions and packages have good documentation, and you will get better and better at understanding R help files.</p>
<p>Of course you can use any other resources to get help with R, including online forums, tutorials, and books. Some popular online resources for R help include:</p>
<ul>
<li><a href="https://stackoverflow.com/questions/tagged/r">Stack Overflow</a></li>
<li><a href="https://community.rstudio.com/">RStudio Community</a></li>
<li><a href="https://www.r-bloggers.com/">R-bloggers</a></li>
<li><a href="https://www.r-graph-gallery.com/">The R Graph Gallery</a></li>
</ul>
<p>You can also use search engines like Google to find answers to your R questions. Just be sure to include “R” in your search query to get relevant results.</p>
<p>AI assistants like ChatGPT can also be useful for getting help with R programming. You can ask specific questions about R code, functions, and packages, and get instant responses.</p>
<p>And of course there is always your course instructors and fellow students to help you out when you get stuck.</p>
</section>
<section id="sec-add-on-packages" class="level2">
<h2 class="anchored" data-anchor-id="sec-add-on-packages">Add-on packages</h2>
<p>R has a vast ecosystem of add-on packages that extend its functionality. These packages are collections of functions, data, and documentation that can be installed and loaded into your R session. There are thousands of packages available on CRAN (the Comprehensive R Archive Network) and other repositories like Bioconductor and GitHub.</p>
<p>We will be using several packages throughout this course. To install a package, you can use the <code>install.packages()</code> function. For example, to install the <code>ggplot2</code> package, you would type:</p>
<p>You can also use the RStudio interface to install packages. Go to the “Packages” tab in the bottom right pane, click on “Install”, type the name of the package you want to install, and click “Install”.</p>
<p>You can see which packages are currently installed by looking in the “Packages” tab.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>You only need to install a package once. After it is installed, you can load it into your R session using the <code>library()</code> function. Do not install packages every time you want to use them; just load them with <code>library()</code>.</p>
</div>
</div>
</section>
<section id="sec-r-versions" class="level2">
<h2 class="anchored" data-anchor-id="sec-r-versions">R Version and add-on package versions</h2>
<p>(This section concerns the Desktop version of R and RStudio, and not so much the Cloud version, because version management is handled for you in the Cloud.)</p>
<p>R and its add-on packages are constantly being updated and improved. This can cause problems when trying to install or use packages that depend on specific versions of R or other packages.</p>
<p>Imagine that the online version of a package has been updated and now only works with the lastest version of R. If you are using an older version of R, you may not be able to install or use that package.</p>
<p>Or if a package depends on another package that has been updated, you may need to update that package as well to use the first package.</p>
<p>This sounds complicated, but there are some simple steps you can take to reduce the chances of running into version-related problems:</p>
<ol type="1">
<li><p><strong>Keep your R version up to date.</strong> New versions of R are released every 6 months or so, and they often include important bug fixes and new features. You can check your current R version by typing <code>R.version.string</code> in the Console. To update R, you can download the latest version from the <a href="https://cran.r-project.org/">CRAN website</a>.</p></li>
<li><p><strong>Keep your add-on packages up to date.</strong> You can update all your installed packages by using the <code>update.packages()</code> function. This will check for updates for all installed packages and install the latest versions. You can also use the RStudio interface to update packages by going to the “Packages” tab, clicking on “Update”, selecting the packages you want to update, and clicking “Install Updates”.</p></li>
<li><p><strong>Do this well before critical deadlines or important events (e.g., exams).</strong> Updating R and packages can sometimes lead to unexpected issues, so it’s best to do it well in advance of when you need everything to work perfectly.</p></li>
</ol>
<p>Nevertheless, even with these precautions, you may still encounter version-related issues from time to time. When this happens, don’t panic!</p>
<p>A common problem you might see is an error message when trying to install or load a package, indicating that the package requires a newer version of R or another package. The error / warning message might look like:</p>
<p><code>warning: package 'xyz' requires R version &gt;= 4.2.0</code></p>
<p><code>Warning in install.packages: package ‘XYZ’ is not available (for R version 4.2.0)</code></p>
<p>These messages indicate that the package you are trying to install or load requires a newer version of R than the one you currently have. To fix this, you will need to update your R installation to the required version or higher. Then its also a good idea to update your packages as well.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>RStudio is also regularly updated, with new version released every several months or so. Your version of RStudio is independent of your version of R, so you can update RStudio without changing your R version. Note that usually your version of RStudio is not as important as your version of R and the packages you are using. So updating RStudio is usually not a high priority and doesn’t often help solve problems related to add on package versions.</p>
</div>
</div>
</section>
<section id="sec-r-projects" class="level2">
<h2 class="anchored" data-anchor-id="sec-r-projects">R Projects</h2>
<p>I always work within R Projects. R Projects help you to organise your work and keep all files related to a project in one place. They also make importing data a breeze.</p>
<p>But what is an R Project? An R Project is a directory (folder) that contains all the files related to a specific project. When you open an R Project, RStudio automatically sets the working directory to the project directory, so you don’t have to worry about setting the working directory manually.</p>
<p>To see if you’re working within an R Project, look at the top right of the RStudio window. If you see the name of your project there, you’re good to go. If you see “Project: (None)”, then you’re not working within an R Project.</p>
<p>If you click on the project name, a dropdown menu will appear. From there, you can create a new project, open an existing project, or switch between projects.</p>
<p><strong>Create a new R Project:</strong> File &gt; New Project &gt; New Directory or Existing Directory &gt; New Project &gt; Choose a name and location for your project &gt; Create Project.</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Get organised!</strong> Put all files for a project in one folder. For example, I made a folder called <code>BIO144_2026</code> and put all files related to this course in that folder. Within that folder, I have subfolders for <code>data</code>, <code>scripts</code>, and <code>results</code>. I then create an R Project in the <code>BIO144_2026</code> folder. This way, all files related to the course are in one place, and I can easily find them later.</p>
</div>
</div>
<p>Now, always open and ensure you’re working within the R Project for your project. As mentioned, you can see the project name at the top right of the RStudio window. And if its not the correct project, click on the name to get the drop-down list of available projects from which you can switch to the correct one.</p>
</section>
<section id="sec-importing-data" class="level2">
<h2 class="anchored" data-anchor-id="sec-importing-data">Importing data</h2>
<p>First, get some data sets for us to work with. <strong>XYZ</strong> You can download them from the course website or use your own data sets. Save the data files in a folder called <code>data</code> within your R Project directory.</p>
<p>We will use the <code>readr</code> package to import data into R. The <code>readr</code> package provides functions to read data from various file formats, including CSV (comma-separated values) files, tab-separated values files, and others.</p>
<p>To read a CSV file, we can use the <code>read_csv()</code> function from the <code>readr</code> package. For example, to read a CSV file called <code>data.csv</code>, we can use the following code:</p>
<p>This code will read the <code>data.csv</code> file from the <code>data</code> folder within the current working directory (which should be the R Project directory) and store it in a data frame called <code>data</code>.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Easily getting the file path</strong> In RStudio, you can easily get the file path by putting the cursor in the parentheses of the <code>read_csv()</code> function, the press the tab key. A drop-down menu will appear with options to navigate to the file. This way, you don’t have to type the file path manually.</p>
</div>
</div>
</section>
<section id="sec-viewing-data" class="level2">
<h2 class="anchored" data-anchor-id="sec-viewing-data">Viewing the data</h2>
<p>Once you’ve imported your data, you can view it in several ways:</p>
<ul>
<li>Click on the data frame in the Environment tab in RStudio to open it in a new tab.</li>
<li>Use the <code>View()</code> function to open the data frame in a new tab in RStudio.</li>
<li>Use the <code>head()</code> function to view the first few rows of the data frame.</li>
<li>Use the <code>str()</code> function to view the structure of the data frame, including the variable names and types.</li>
<li>Use the <code>summary()</code> function to get a summary of the data frame, including basic statistics for each variable.</li>
</ul>
<p>Another useful function is <code>glimpse()</code> from the <code>dplyr</code> package, which provides a quick overview of the data frame.</p>
<p>There are many checks you can do to ensure your data was imported correctly. For example checking if there are duplicated values in a variable when there shouldn’t be:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] FALSE</code></pre>
</div>
</div>
<p>The function <code>any()</code> will return <code>TRUE</code> if there are any duplicated values in the <code>Name</code> variable, and <code>FALSE</code> otherwise. The function <code>duplicated()</code> returns a logical vector indicating which values are duplicates. We use the dollar sign <code>$</code> to access a specific variable (column) in the data frame. A logical vector is a vector that contains only <code>TRUE</code> or <code>FALSE</code> values:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] FALSE FALSE FALSE</code></pre>
</div>
</div>
<p>All three logicals are <code>FALSE</code>, meaning none of the three are duplicates. If there were duplicates, the corresponding positions in the logical vector would be <code>TRUE</code>. For example:</p>
<p>What do you expect the output of <code>duplicated(example_vector)</code> to be?</p>
<p>A final check (though not the final one we could do–there are many others). Let us check for missing values and get a count of how many there are in each variable. We can do this with the following <em>tidyverse</em> code:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>  Name Age Height
1    0   0      0</code></pre>
</div>
</div>
<p>Looks complicated eh! Well, that’s because it is, for sure. But let’s break it down:</p>
<ul>
<li><code>summarise()</code> creates a new data frame with summary statistics.</li>
<li><code>across(everything(), ~ sum(is.na(.)))</code> applies the function <code>sum(is.na(.))</code> to every variable in the data frame.</li>
<li>The <code>is.na()</code> function returns a logical vector indicating which values are missing (<code>NA</code>), and the <code>sum()</code> function counts the number of <code>TRUE</code> values in that vector (i.e., the number of missing values).</li>
</ul>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Let’s assume your data was imported incorrectly.</strong> This means you have to inspect it carefully. Check that the variable names are correct, that the data types are correct (e.g., numeric, character, factor), that there are the correct number of rows and columns. If you find any issues, you need to find out what caused them, fix them, and re-import the data (see below).</p>
</div>
</div>
<p>Common data import problems:</p>
<ul>
<li>Incorrect delimiter: If your data file uses a different delimiter (e.g., tab, semicolon), you need to specify it in the <code>read_csv()</code> function using the <code>delim</code> argument (e.g., <code>read_delim("data.csv", delim = "\t")</code> for tab-delimited files).</li>
<li>Missing values: If your data file uses a specific value to represent missing data (e.g., “NA”, “-999”), you need to specify it in the <code>read_csv()</code> function using the <code>na</code> argument (e.g., <code>read_csv("data.csv", na = c("NA", "-999"))</code>).</li>
<li>Only one column: If your data file has only one column, it may be because the delimiter is incorrect. Check the delimiter and re-import the data with the correct delimiter.</li>
<li>You opened the downloaded file in Excel and then saved it: Excel may have changed the format of the file when you opened and saved it. Always work with the original downloaded file.</li>
<li>Wrong path or file name: Make sure the file path and name are correct. Remember, when you work in an R Project, you can place the cursor in the parentheses of the <code>read_csv()</code> function and press the tab key to navigate to the file.</li>
</ul>
</section>
<section id="sec-data-wrangling" class="level2">
<h2 class="anchored" data-anchor-id="sec-data-wrangling">Data wrangling</h2>
<p>Now we have our data imported and checked, and we’re ready to start working with it. This process is called data wrangling, and it involves cleaning, transforming, and reshaping the data to make it suitable for visualisation and analysis.</p>
<section id="clean-the-variable-names" class="level3">
<h3 class="anchored" data-anchor-id="clean-the-variable-names">Clean the variable names</h3>
<p>The first thing I like to do is standardise and clean up the variable names. I like to use the <code>janitor</code> package for this:</p>
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'janitor'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:stats':

    chisq.test, fisher.test</code></pre>
</div>
</div>
<p>The <code>clean_names()</code> function from the <code>janitor</code> package will convert variable names to a consistent format (lowercase, spaces replaced by underscores, no special characters).</p>
</section>
<section id="manipulate-the-data-frame" class="level3">
<h3 class="anchored" data-anchor-id="manipulate-the-data-frame">Manipulate the data frame</h3>
<p>Functions in the <code>dplyr</code> package are used to manipulate data frames:</p>
<ul>
<li><code>select()</code>: select columns by position, or by name, or by other methods</li>
<li><code>filter()</code>: select rows that meet a logical condition</li>
<li><code>slice()</code>: select rows by position</li>
<li><code>arrange()</code>: reorder rows</li>
<li><code>mutate()</code>: add new variables</li>
</ul>
<p>The <code>dplyr</code> package also provides functions to group data frames and to summarize data:</p>
<ul>
<li><code>group_by()</code>: add to a data frame a grouping structure</li>
<li><code>summarize()</code>: summarize data, respecting any grouping structure specified by <code>group_by()</code></li>
</ul>
<p>The pipe operator <code>|&gt;</code> is used to chain together multiple operations on a data frame.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>Note that you will often see another pipe operator <code>%&gt;%</code> used in examples. The pipe operator <code>|&gt;</code> is a newer version of <code>%&gt;%</code> that is more efficient and easier to use. The pipe operator <code>|&gt;</code> is available in R version 4.1.0 and later.</p>
</div>
</div>
<p>Lets work through some examples with a sample data frame:</p>
<p>Here is the same dataset with 100 rows:</p>
</section>
<section id="select-columns-select-columns" class="level3">
<h3 class="anchored" data-anchor-id="select-columns-select-columns">Select columns [#select-columns]</h3>
<p>We can select columns by name</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 100 × 2
   name       score
   &lt;chr&gt;      &lt;dbl&gt;
 1 Person_001  91.9
 2 Person_002  87.3
 3 Person_003  77.8
 4 Person_004  64.5
 5 Person_005  69.8
 6 Person_006  91.2
 7 Person_007  64.3
 8 Person_008  91.9
 9 Person_009  72.6
10 Person_010  70.3
# ℹ 90 more rows</code></pre>
</div>
</div>
<p>We can select columns by position</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 100 × 2
   name       score
   &lt;chr&gt;      &lt;dbl&gt;
 1 Person_001  91.9
 2 Person_002  87.3
 3 Person_003  77.8
 4 Person_004  64.5
 5 Person_005  69.8
 6 Person_006  91.2
 7 Person_007  64.3
 8 Person_008  91.9
 9 Person_009  72.6
10 Person_010  70.3
# ℹ 90 more rows</code></pre>
</div>
</div>
<p>We can select columns by a condition, for example select only the numeric columns:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 100 × 2
     age score
   &lt;int&gt; &lt;dbl&gt;
 1    50  91.9
 2    34  87.3
 3    38  77.8
 4    33  64.5
 5    22  69.8
 6    29  91.2
 7    37  64.3
 8    41  91.9
 9    30  72.6
10    24  70.3
# ℹ 90 more rows</code></pre>
</div>
</div>
<p>We can select a column by pattern matching, using helper functions, for example select columns that contain the letter “a”:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 100 × 2
   name         age
   &lt;chr&gt;      &lt;int&gt;
 1 Person_001    50
 2 Person_002    34
 3 Person_003    38
 4 Person_004    33
 5 Person_005    22
 6 Person_006    29
 7 Person_007    37
 8 Person_008    41
 9 Person_009    30
10 Person_010    24
# ℹ 90 more rows</code></pre>
</div>
</div>
<p>Other helpers include <code>starts_with()</code>, <code>ends_with()</code>, <code>matches()</code>, and <code>everything()</code>.</p>
</section>
<section id="filter-getting-particular-rows-of-data-filter-rows" class="level3">
<h3 class="anchored" data-anchor-id="filter-getting-particular-rows-of-data-filter-rows">Filter: Getting particular rows of data [#filter-rows]</h3>
<p>To get particular rows of data, we can use the <code>filter()</code> function. This function takes a <em>logical condition</em> as an argument and returns only the rows that meet that condition. For example, to get all rows where the Age is greater than 30:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 66 × 3
   name         age score
   &lt;chr&gt;      &lt;int&gt; &lt;dbl&gt;
 1 Person_001    50  91.9
 2 Person_002    34  87.3
 3 Person_003    38  77.8
 4 Person_004    33  64.5
 5 Person_007    37  64.3
 6 Person_008    41  91.9
 7 Person_011    39  67.3
 8 Person_012    33  96.5
 9 Person_013    41  61.7
10 Person_014    44  80.0
# ℹ 56 more rows</code></pre>
</div>
</div>
<p>Here, the logical condition is <code>age &gt; 30</code>.</p>
<p>We can combine multiple conditions using the logical operators <code>&amp;</code> (and), <code>|</code> (or), and <code>!</code> (not). For example, to get all rows where the Age is greater than 30 and the Score is less than 90:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 60 × 3
   name         age score
   &lt;chr&gt;      &lt;int&gt; &lt;dbl&gt;
 1 Person_002    34  87.3
 2 Person_003    38  77.8
 3 Person_004    33  64.5
 4 Person_007    37  64.3
 5 Person_011    39  67.3
 6 Person_013    41  61.7
 7 Person_014    44  80.0
 8 Person_015    45  87.3
 9 Person_016    46  81.3
10 Person_018    38  82.9
# ℹ 50 more rows</code></pre>
</div>
</div>
<p>Other logical operators include <code>==</code> (equal to), <code>!=</code> (not equal to), <code>&lt;=</code> (less than or equal to), and <code>&gt;=</code> (greater than or equal to).</p>
</section>
<section id="slice-getting-rows-by-position-slice-rows" class="level3">
<h3 class="anchored" data-anchor-id="slice-getting-rows-by-position-slice-rows">Slice: Getting rows by position [#slice-rows]</h3>
<p>The <code>slice()</code> function allows us to get rows by their position in the data frame. For example, to get the first two rows:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 3
  name         age score
  &lt;chr&gt;      &lt;int&gt; &lt;dbl&gt;
1 Person_001    50  91.9
2 Person_002    34  87.3</code></pre>
</div>
</div>
<p>I very rarely use this function, as I prefer to use <code>filter()</code> with logical conditions. I can’t think of a good use case for this function right now! Perhaps you can?</p>
</section>
<section id="arrange-reordering-rows-arrange-rows" class="level3">
<h3 class="anchored" data-anchor-id="arrange-reordering-rows-arrange-rows">Arrange: Reordering rows [#arrange-rows]</h3>
<p>The <code>arrange()</code> function allows us to reorder the rows of a data frame based on the values in one or more columns. For example, to reorder the rows by Age in ascending order:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 100 × 3
   name         age score
   &lt;chr&gt;      &lt;int&gt; &lt;dbl&gt;
 1 Person_064    20  88.8
 2 Person_056    21  79.5
 3 Person_091    21  67.4
 4 Person_005    22  69.8
 5 Person_025    22  74.9
 6 Person_033    23  67.3
 7 Person_092    23  72.4
 8 Person_010    24  70.3
 9 Person_017    24  79.1
10 Person_058    24  72.7
# ℹ 90 more rows</code></pre>
</div>
</div>
<p>I f we want to reorder the rows by Age in descending order, we can use the <code>desc()</code> function:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 100 × 3
   name         age score
   &lt;chr&gt;      &lt;int&gt; &lt;dbl&gt;
 1 Person_001    50  91.9
 2 Person_061    50  79.9
 3 Person_075    50  67.3
 4 Person_085    50  50.1
 5 Person_096    50  86.8
 6 Person_031    49  71.8
 7 Person_078    49  72.6
 8 Person_024    48  81.2
 9 Person_057    48  80.3
10 Person_021    47  66.0
# ℹ 90 more rows</code></pre>
</div>
</div>
<p>It’s unusual to need the rows of a dataset to be arranged in a specific order, but it can be useful when looking at the data directly.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>Note that when you view the data in RStudio, it will always be arranged by the row number. In the viewer you can sort by clicking on the column headers.</p>
</div>
</div>
</section>
<section id="mutate-adding-new-variables-mutate-variables" class="level3">
<h3 class="anchored" data-anchor-id="mutate-adding-new-variables-mutate-variables">Mutate: Adding new variables [#mutate-variables]</h3>
<p>The <code>mutate()</code> function allows us to add new variables to a data frame. For example, to add a new variable called <code>Age_in_5_years</code> that is the Age plus 5:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 100 × 4
   name         age score age_in_5_years
   &lt;chr&gt;      &lt;int&gt; &lt;dbl&gt;          &lt;dbl&gt;
 1 Person_001    50  91.9             55
 2 Person_002    34  87.3             39
 3 Person_003    38  77.8             43
 4 Person_004    33  64.5             38
 5 Person_005    22  69.8             27
 6 Person_006    29  91.2             34
 7 Person_007    37  64.3             42
 8 Person_008    41  91.9             46
 9 Person_009    30  72.6             35
10 Person_010    24  70.3             29
# ℹ 90 more rows</code></pre>
</div>
</div>
<p>We can add multiple new variables at once:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 100 × 5
   name         age score age_in_5_years percentage_score
   &lt;chr&gt;      &lt;int&gt; &lt;dbl&gt;          &lt;dbl&gt;            &lt;dbl&gt;
 1 Person_001    50  91.9             55            0.919
 2 Person_002    34  87.3             39            0.873
 3 Person_003    38  77.8             43            0.778
 4 Person_004    33  64.5             38            0.645
 5 Person_005    22  69.8             27            0.698
 6 Person_006    29  91.2             34            0.912
 7 Person_007    37  64.3             42            0.643
 8 Person_008    41  91.9             46            0.919
 9 Person_009    30  72.6             35            0.726
10 Person_010    24  70.3             29            0.703
# ℹ 90 more rows</code></pre>
</div>
</div>
</section>
<section id="working-with-categorical-variables-sec-categorical-variables" class="level3">
<h3 class="anchored" data-anchor-id="working-with-categorical-variables-sec-categorical-variables">Working with categorical variables [#sec-categorical-variables]</h3>
<p>Variables in a data frame in R have a <em>type</em>. The most common types of variables are numeric and categorical. Numeric variables are variables that take on numerical values, such as age or score. Categorical variables are variables that take on a limited number of values, often representing categories or groups. In R, categorical variables are typically have <em>type</em> <code>&lt;chr&gt;</code> which is <code>character</code>. Or they can be of type <code>&lt;fct&gt;</code> which is <code>factor</code>.</p>
<p>When we import data categorical variable is usually imported as a <code>character</code> variable. For example, the variable <code>name</code> in our example dataset is a categorical variable of type <code>character</code>. Look at the first few rows of the dataset again, and see that below the variable name it says <code>&lt;chr&gt;</code> for the <code>name</code> variable:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 100 × 3
   name         age score
   &lt;chr&gt;      &lt;int&gt; &lt;dbl&gt;
 1 Person_001    50  91.9
 2 Person_002    34  87.3
 3 Person_003    38  77.8
 4 Person_004    33  64.5
 5 Person_005    22  69.8
 6 Person_006    29  91.2
 7 Person_007    37  64.3
 8 Person_008    41  91.9
 9 Person_009    30  72.6
10 Person_010    24  70.3
# ℹ 90 more rows</code></pre>
</div>
</div>
<p>This is all totally fine. There are, however, use cases where we might want to convert a <code>character</code> variable to a <code>factor</code> variable. Factors are useful when we have a categorical variable with a fixed number of levels, and we want to specify the order of those levels. For example, if we had a variable called <code>education_level</code> with the values “High School”, “Bachelor’s”, “Master’s”, and “PhD”, we might want to convert this variable to a factor and specify the order of the levels.</p>
<p>Let’s make a new dataset to illustrate this:</p>
<p>Look at the structure of this new dataset:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 3
  name    education_level   age
  &lt;chr&gt;   &lt;chr&gt;           &lt;dbl&gt;
1 Alice   Bachelor's         19
2 Bob     Master's           23
3 Charlie PhD                25
4 David   High School        16
5 Eve     Bachelor's         20</code></pre>
</div>
</div>
<p>We can see that the <code>education_level</code> variable is of type <code>&lt;chr&gt;</code>, which is <code>character</code>.</p>
<p>We can convert the <code>education_level</code> variable to a factor:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 3
  name    education_level   age
  &lt;chr&gt;   &lt;fct&gt;           &lt;dbl&gt;
1 Alice   Bachelor's         19
2 Bob     Master's           23
3 Charlie PhD                25
4 David   High School        16
5 Eve     Bachelor's         20</code></pre>
</div>
</div>
<p>Now, the <code>education_level</code> variable is of type <code>&lt;fct&gt;</code>, which is <code>factor</code>.</p>
<p>Here is a graph of age by education level:</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="2.1-R-and-RStudio_files/figure-html/unnamed-chunk-37-1.png" class="img-fluid figure-img" width="480"></p>
</figure>
</div>
</div>
</div>
<p>We have a problem here: the education levels are not in a sensible order. The first level is “Bachelor’s”, followed by “High School”, “Master’s”, and “PhD”.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Why do you think the levels are in this order? We didn’t tell R to order them like this! The answer is that R orders factor levels alphabetically by default. So when we convert a character variable to a factor without specifying the order of the levels, R will order them alphabetically.</p>
</div>
</div>
<p>It would be much better to have the levels ordered as “High School”, “Bachelor’s”, “Master’s”, and “PhD”.</p>
<p>We can fix this by specifying the order of the levels when we convert the variable to a factor:</p>
<p>Now when we plot the data again, the education levels are in the correct order:</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="2.1-R-and-RStudio_files/figure-html/unnamed-chunk-39-1.png" class="img-fluid figure-img" width="480"></p>
</figure>
</div>
</div>
</div>
<p>Another use case is when we are making a linear model and want to specify the reference level for a categorical variable. We will look at this when we get to linear models. If you want to skip ahead, you can see how this works in a section at the end of this chapter (Section <a href="#sec-ref-level" class="quarto-xref"><span>Setting a reference level in a linear model</span></a>).</p>
</section>
</section>
<section id="sec-visualisation" class="level2">
<h2 class="anchored" data-anchor-id="sec-visualisation">Visualisation</h2>
<p>There are many many many types of data visualisation. We will not explore them all in this course! In fact, we will use only a few basic types of visualisation, but we will use them well and critically. The three types of visualisation we will focus on are scatter plots, histograms, and box and whisker plots.</p>
<section id="three-basic-types-of-visualisation-three-basic-visualisations" class="level3">
<h3 class="anchored" data-anchor-id="three-basic-types-of-visualisation-three-basic-visualisations">Three basic types of visualisation [#three-basic-visualisations]</h3>
<p><em>Scatterplots</em> are used to visualise the relationship between two continuous variables. Here is an example of a scatterplot:</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="2.1-R-and-RStudio_files/figure-html/unnamed-chunk-40-1.png" class="img-fluid figure-img" width="480"></p>
</figure>
</div>
</div>
</div>
<p><em>Histograms</em> are used to visualise the distribution of a single continuous variable. The axiss are different to scatterplots: the x-axis is the variable being measured, and the y-axis is the count (or frequency) of observations in each bin. A bin is a range of values. Here is an esample of a histogram:</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="2.1-R-and-RStudio_files/figure-html/unnamed-chunk-41-1.png" class="img-fluid figure-img" width="480"></p>
</figure>
</div>
</div>
</div>
<p><em>Box and whisker plots</em> are used to visualise the distribution of a continuous variable across different categories. Here is an example of a box and whisker plot. First we add a new variable that is age group:</p>
<p>The new variable <code>age_group</code> is a categorical variable with three levels: “20-29”, “30-39”, and “40-49”. We make this using the <code>case_when()</code> function. This function works by checking each condition (which are given as the arguments to the function) in turn, and assigning the corresponding value when the condition is true. Now we can make the box and whisker plot:</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="2.1-R-and-RStudio_files/figure-html/unnamed-chunk-43-1.png" class="img-fluid figure-img" width="480"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="understanding-ggplot2-syntax-understanding-ggplot2" class="level3">
<h3 class="anchored" data-anchor-id="understanding-ggplot2-syntax-understanding-ggplot2">Understanding ggplot2 syntax [#understanding-ggplot2]</h3>
<p>We have used the <code>ggplot2</code> package to create visualisations. The <code>ggplot2</code> package is based on the grammar of graphics, which provides a consistent way to create visualisations. It is amazing, and when it was created it revolutionised data visualisation in R.</p>
<p>You can see that for each of the three visualisations, we use the <code>ggplot()</code> function to create the base plot, and then we add layers to the plot using the <code>+</code> operator.</p>
<p>The first argument to the <code>ggplot()</code> function is the data frame that we want to visualise. The layers that we add to the plot each have two main components. The first component is the <em>aesthetic mappings</em>, which specify how the variables in the data frame are mapped to the visual properties of the plot (e.g., x-axis, y-axis, color, size). The second component is the <em>geometric object</em>, which defines how the data is represented in the plot (e.g., points, lines, bars).</p>
<p>The <em>aesthetic mappings</em> are specified using the <code>aes()</code> function, which takes arguments that define the mappings. Inside the <code>aes()</code> function, we specify the variables from the data frame that we want to map to the visual properties of the plot. For example, in the scatterplot, we map the <code>age</code> variable to the x-axis and the <code>score</code> variable to the y-axis using <code>aes(x = age, y = score)</code>.</p>
<p>The <em>geometric object</em> is specified using functions that start with <code>geom_</code>, such as <code>geom_point()</code>, <code>geom_histogram()</code>, and <code>geom_boxplot()</code>.</p>
<p>You will notice that for the scatterplot and the box and whisker plot, we specify both an x- and a y-variable, but for the histogram we only specify an x-variable. This is because histograms only have one variable, which is the variable being measured. The y-axis is automatically calculated as the count (or frequency) of observations in each bin.</p>
<p>We can customise many features of the graph using additional arguments to the <code>ggplot()</code> function and the <code>geom_</code> functions. For example, we can add titles and labels to the axes using the <code>labs()</code> function:</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="2.1-R-and-RStudio_files/figure-html/unnamed-chunk-44-1.png" class="img-fluid figure-img" width="480"></p>
</figure>
</div>
</div>
</div>
<p>We can also change the theme of the plot using the <code>theme_</code> functions. For example, to use a minimal theme, and add it the customisations we already made:</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="2.1-R-and-RStudio_files/figure-html/unnamed-chunk-45-1.png" class="img-fluid figure-img" width="480"></p>
</figure>
</div>
</div>
</div>
<p>There are a million and one ways to customise visualisations in <code>ggplot2</code>. We will explore many of them during the course in a rather ad-hoc way. In this course we do not <em>assess</em> your skill and competence in making clear and beautiful visualisations. We will, however, be very happy to help you make beautiful and effective visualisations for your assignments and projects. And please be sure that making beautiful and effective visualisations is a skill that is very highly valued in the workplace.</p>
</section>
<section id="saving-ggplot-visualisations-saving-ggplot" class="level3">
<h3 class="anchored" data-anchor-id="saving-ggplot-visualisations-saving-ggplot">Saving ggplot visualisations [#saving-ggplot]</h3>
<p>Another feature that is very useful is to save ggplot visualisations to objects and then save to a file (for example a pdf). First, here is how we save a ggplot to an object:</p>
<p>Now we can save the plot to a file using the <code>ggsave()</code> function:</p>
<p>Note two things about the <code>ggsave()</code> function. First, the first argument is the file name (including the file extension). The file extension determines the file type (e.g., pdf, png, jpeg). Second, we can specify the width and height of the plot in inches.</p>
<p>Also note that the file is saved to the current working directory. When you’re working in an R project, this is usually the base directory of the project. If you want to save your plots in a folder named <code>plots</code> you would first need to create the folder (if it doesn’t already exist) and then specify the path in the file name:</p>
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dir.create("plots"): 'plots' already exists</code></pre>
</div>
</div>
</section>
</section>
<section id="extras" class="level2">
<h2 class="anchored" data-anchor-id="extras">Extras</h2>
<section id="making-reports-directly-using-quarto-quarto-reports" class="level3">
<h3 class="anchored" data-anchor-id="making-reports-directly-using-quarto-quarto-reports">Making reports directly using Quarto [#quarto-reports]</h3>
<p>We don’t explicitly ask you to make reports using Quarto in this course, but it is a very useful skill to have, and I highly recommend you explore it further in your own time. Here are a few basics to get you started.</p>
<p>One of the great features of R and RStudio is the ability to create reports that combine text, code, and visualisations. One of the most popular tools for this is Quarto (https://quarto.org/), which allows you to create documents in various formats (HTML, PDF, Word, etc.) using a combination of <em>Markdown</em> and R code.</p>
<p>**Why is this so great???* If you want to show someone your analysis and visualisation, say a team member or supervisor, it is often good to prepare a report that explains what you did, perhaps shows the code you used, and presents the results (including visualisations). One way to go about this is to prepare a powerpoint presentation or a word document, and then copy and paste code and visualisations into the document. Its what I used to do. It works. But it is tedious, error prone, and when you change something in your code or data, you have to remember to go back and update the powerpoint or word document.</p>
<p>With Quarto, you can create a report that automatically includes the code and visualisations directly from your R script. This way, if you change the code or data, you can simply re-render the report and everything is automatically updated. It takes away a lot of the tediousness and potential for errors. And it makes updating reports much easier.</p>
<p>If you’d like to get started with Quarto, check out the Quarto website (https://quarto.org/) and the RStudio Quarto documentation (https://quarto.org/docs/get-started/). There are also many tutorials and resources available online to help you learn how to use Quarto effectively.</p>
<p>If you have questions about Quarto, feel free to ask me or TAs during the practicals, though note that any particular TAs may or may not be experienced with Quarto themselves.</p>
</section>
<section id="combining-ggplots-with-patchwork-combining-ggplots" class="level3">
<h3 class="anchored" data-anchor-id="combining-ggplots-with-patchwork-combining-ggplots">Combining ggplots with patchwork [#combining-ggplots]</h3>
<p>We often make multiple ggplots in our analyses. Sometimes it is useful to combine multiple plots into a single figure for easier comparison or presentation. We can do with ggplots and the lovely add-on package called <code>patchwork</code>. The <code>patchwork</code> package allows us to combine multiple ggplots into a single plot layout. Here is an example of how to use <code>patchwork</code> to combine the three plots we made earlier (scatterplot, histogram, and boxplot):</p>
<p>First, load the <code>patchwork</code> package:</p>
<p>Next make the first plot and assign it to an object:</p>
<p>Now make the second plot and assign it to an object:</p>
<p>Now make the third plot and assign it to an object:</p>
<p>Now we can combine the three plots into a single layout using the <code>patchwork</code> syntax. Here, we arrange <code>plot1</code> on the top row, and <code>plot2</code> and <code>plot3</code> side by side on the bottom row:</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="2.1-R-and-RStudio_files/figure-html/unnamed-chunk-53-1.png" class="img-fluid figure-img" width="480"></p>
</figure>
</div>
</div>
</div>
<p>Amazing eh! OK, lets leave it there for now. We’ll use ggplot2 throughout the course, and explore more features as we go along.</p>
</section>
<section id="sec-ref-level" class="level3">
<h3 class="anchored" data-anchor-id="sec-ref-level">Setting a reference level in a linear model</h3>
<p>Sometimes when fitting linear models with categorical explanatory (independent) variables, it is useful to set a specific reference level for the categorical variable. This can help in interpreting the model coefficients. In R, we can set the reference level using the <code>relevel()</code> function or by using the <code>factor()</code> function with the <code>levels</code> argument.</p>
<p>First, let’s create a simple dataset:</p>
<p>By default, R will set the first level of the factor (in alphabetical order) as the reference level. In this case, “Aspirin” would be the reference level. Therefore when we visualise the data:</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="2.1-R-and-RStudio_files/figure-html/unnamed-chunk-55-1.png" class="img-fluid figure-img" width="480"></p>
</figure>
</div>
</div>
</div>
<p>It would be nicer to have the “Control” group as the first level on the left of the x-axis.</p>
<p>Likewise, when we make a linear model:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = response ~ treatment, data = my_data)

Residuals:
   1    2    3    4    5    6 
 0.5 -0.5 -0.5 -0.5  0.5  0.5 

Coefficients:
                   Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)          7.5000     0.5000  15.000 0.000643 ***
treatmentControl    -3.0000     0.7071  -4.243 0.023981 *  
treatmentIbuprofen  -1.0000     0.7071  -1.414 0.252215    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.7071 on 3 degrees of freedom
Multiple R-squared:  0.8615,    Adjusted R-squared:  0.7692 
F-statistic: 9.333 on 2 and 3 DF,  p-value: 0.05152</code></pre>
</div>
</div>
<p>The (Intercept) term corresponds to the “Aspirin” group, and the coefficients for “Control” and “Ibuprofen” are relative to “Aspirin”. <em>R</em> has done this because in the factor levels, “Aspirin” comes first alphabetically and was therefore set as the reference level when the factor variable was created.</p>
<p>If we want to set “Control” as the reference level, we can do so using <code>relevel()</code>:</p>
<p>Now when we visualise the data again:</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="2.1-R-and-RStudio_files/figure-html/unnamed-chunk-58-1.png" class="img-fluid figure-img" width="480"></p>
</figure>
</div>
</div>
</div>
<p>Magic! The “Control” group is now the first level on the left of the x-axis.</p>
<p>And when we fit the linear model again:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = response ~ treatment, data = my_data)

Residuals:
   1    2    3    4    5    6 
 0.5 -0.5 -0.5 -0.5  0.5  0.5 

Coefficients:
                   Estimate Std. Error t value Pr(&gt;|t|)   
(Intercept)          4.5000     0.5000   9.000   0.0029 **
treatmentAspirin     3.0000     0.7071   4.243   0.0240 * 
treatmentIbuprofen   2.0000     0.7071   2.828   0.0663 . 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.7071 on 3 degrees of freedom
Multiple R-squared:  0.8615,    Adjusted R-squared:  0.7692 
F-statistic: 9.333 on 2 and 3 DF,  p-value: 0.05152</code></pre>
</div>
</div>
<p>The (Intercept) term now corresponds to the “Control” group, and the coefficients for “Aspirin” and “Ibuprofen” are relative to “Control”. This makes interpretation of the model coefficients more intuitive.</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/opetchey\.github\.io\/BIO144_Course_Book\/");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./1.1-intro.html" class="pagination-link" aria-label="Introduction (L1)">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Introduction (L1)</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./4.1-regression-part1.html" class="pagination-link" aria-label="Regression Part 1 (L3)">
        <span class="nav-page-text">Regression Part 1 (L3)</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>BIO144 Data Analysis for Biologists, Course Book written by Owen Petchey</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/opetchey/BIO144_Course_Book/edit/main/2.1-R-and-RStudio.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/opetchey/BIO144_Course_Book/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
<p>This book was built with <a href="https://quarto.org/">Quarto</a>.</p>
</div>
  </div>
</footer>




</body></html>