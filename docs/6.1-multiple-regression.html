<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Multiple regression (L6) – BIO144 Course Book (version 2026)</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./7.1-interactions.html" rel="next">
<link href="./5.1-anova.html" rel="prev">
<link href="./cover.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-485d01fc63b59abcd3ee1bf1e8e2748d.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<script src="site_libs/plotly-binding-4.10.4/plotly.js"></script>
<script src="site_libs/typedarray-0.1/typedarray.min.js"></script>
<script src="site_libs/jquery-3.5.1/jquery.min.js"></script>
<link href="site_libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">
<script src="site_libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>
<link href="site_libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="site_libs/plotly-main-2.11.1/plotly-latest.min.js"></script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./6.1-multiple-regression.html">Multiple regression (L6)</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">BIO144 Course Book (version 2026)</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/opetchey/BIO144_Course_Book/" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1.1-intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction (L1)</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2.1-R-and-RStudio.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">R and RStudio (L2)</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./3.1-regression-part1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Regression Part 1 (L3)</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./4.1-regression-part2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Regression Part 2 (L4)</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./5.1-anova.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Analysis of variance (L5)</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./6.1-multiple-regression.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Multiple regression (L6)</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./7.1-interactions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Interactions (L7)</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./8.1-GLM1-count-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Count data (L8)</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./9.1-GLM2-binary-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Binary data (L9)</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10.1-ordination.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Ordination (L10)</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11.1-mixed-models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Mixed models (L11-1)</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11.2-what-next.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">What next (L11-2)</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./12.1-review.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Review (L12)</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a></li>
  <li><a href="#multiple-regression" id="toc-multiple-regression" class="nav-link" data-scroll-target="#multiple-regression">Multiple regression</a>
  <ul class="collapse">
  <li><a href="#an-example-dataset" id="toc-an-example-dataset" class="nav-link" data-scroll-target="#an-example-dataset">An example dataset</a></li>
  <li><a href="#the-multiple-linear-regression-model" id="toc-the-multiple-linear-regression-model" class="nav-link" data-scroll-target="#the-multiple-linear-regression-model">The multiple linear regression model</a></li>
  <li><a href="#fitting-the-model" id="toc-fitting-the-model" class="nav-link" data-scroll-target="#fitting-the-model">Fitting the model</a></li>
  <li><a href="#checking-the-assumptions" id="toc-checking-the-assumptions" class="nav-link" data-scroll-target="#checking-the-assumptions">Checking the assumptions</a></li>
  </ul></li>
  <li><a href="#question-1-as-an-ensemble-are-the-explanatory-variables-useful" id="toc-question-1-as-an-ensemble-are-the-explanatory-variables-useful" class="nav-link" data-scroll-target="#question-1-as-an-ensemble-are-the-explanatory-variables-useful">Question 1: As an ensemble, are the explanatory variables useful?</a>
  <ul class="collapse">
  <li><a href="#the-f-statistic-in-r" id="toc-the-f-statistic-in-r" class="nav-link" data-scroll-target="#the-f-statistic-in-r">The F-statistic in R</a></li>
  </ul></li>
  <li><a href="#question-2-which-variables-are-associated-with-the-response" id="toc-question-2-which-variables-are-associated-with-the-response" class="nav-link" data-scroll-target="#question-2-which-variables-are-associated-with-the-response">Question 2: Which variables are associated with the response?</a></li>
  <li><a href="#question-3-what-proportion-of-variability-is-explained" id="toc-question-3-what-proportion-of-variability-is-explained" class="nav-link" data-scroll-target="#question-3-what-proportion-of-variability-is-explained">Question 3: What proportion of variability is explained?</a>
  <ul class="collapse">
  <li><a href="#multiple-r2" id="toc-multiple-r2" class="nav-link" data-scroll-target="#multiple-r2">Multiple <span class="math inline">\(R^2\)</span></a></li>
  <li><a href="#adjusted-r2" id="toc-adjusted-r2" class="nav-link" data-scroll-target="#adjusted-r2">Adjusted <span class="math inline">\(R^2\)</span></a></li>
  </ul></li>
  <li><a href="#question-4-are-some-explanatory-variables-more-important-than-others" id="toc-question-4-are-some-explanatory-variables-more-important-than-others" class="nav-link" data-scroll-target="#question-4-are-some-explanatory-variables-more-important-than-others">Question 4: Are some explanatory variables more important than others?</a></li>
  <li><a href="#question-5-how-do-we-make-predictions" id="toc-question-5-how-do-we-make-predictions" class="nav-link" data-scroll-target="#question-5-how-do-we-make-predictions">Question 5: How do we make predictions?</a></li>
  <li><a href="#collinearity" id="toc-collinearity" class="nav-link" data-scroll-target="#collinearity">Collinearity</a>
  <ul class="collapse">
  <li><a href="#collinearity-and-interpretation-of-r2" id="toc-collinearity-and-interpretation-of-r2" class="nav-link" data-scroll-target="#collinearity-and-interpretation-of-r2">Collinearity and interpretation of <span class="math inline">\(R^2\)</span></a></li>
  <li><a href="#do-i-have-a-problem-with-collinearity" id="toc-do-i-have-a-problem-with-collinearity" class="nav-link" data-scroll-target="#do-i-have-a-problem-with-collinearity">Do I have a problem (with collinearity)?</a></li>
  <li><a href="#what-to-do-about-collinearity" id="toc-what-to-do-about-collinearity" class="nav-link" data-scroll-target="#what-to-do-about-collinearity">What to do about collinearity?</a></li>
  <li><a href="#assessing-the-importance-of-an-explanatory-variables-in-the-presence-of-collinearity" id="toc-assessing-the-importance-of-an-explanatory-variables-in-the-presence-of-collinearity" class="nav-link" data-scroll-target="#assessing-the-importance-of-an-explanatory-variables-in-the-presence-of-collinearity">Assessing the importance of an explanatory variables in the presence of collinearity</a></li>
  </ul></li>
  <li><a href="#review" id="toc-review" class="nav-link" data-scroll-target="#review">Review</a></li>
  <li><a href="#extras" id="toc-extras" class="nav-link" data-scroll-target="#extras">Extras</a>
  <ul class="collapse">
  <li><a href="#d-plot-of-multiple-linear-regression" id="toc-d-plot-of-multiple-linear-regression" class="nav-link" data-scroll-target="#d-plot-of-multiple-linear-regression">3D plot of multiple linear regression</a></li>
  <li><a href="#publication-ready-table-of-results" id="toc-publication-ready-table-of-results" class="nav-link" data-scroll-target="#publication-ready-table-of-results">Publication ready table of results</a></li>
  <li><a href="#a-figure-showing-the-coefficients-and-confidence-intervals" id="toc-a-figure-showing-the-coefficients-and-confidence-intervals" class="nav-link" data-scroll-target="#a-figure-showing-the-coefficients-and-confidence-intervals">A figure showing the coefficients and confidence intervals</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/opetchey/BIO144_Course_Book/edit/main/6.1-multiple-regression.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/opetchey/BIO144_Course_Book/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Multiple regression (L6)</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>In the previous chapters we covered simple linear regression and one-way analysis of variance. In both we had one response variable and one explanatory variable. In both cases we made a linear model to relate the response variable to the explanatory variable. The two cases differed in the type of explanatory variable. In the case of simple linear regression, the explanatory variable was continuous. In the case of one-way ANOVA, the explanatory variable was categorical.</p>
<p>We will now extend the linear model and analyses to cases with more than one (i.e., multiple) explanatory variables. The explanatory variables can be continuous or categorical, and can be a mixture of the two.</p>
<p>Some combinations of explanatory variables have special names:</p>
<ul>
<li>Multiple (more than one) continuous explanatory variables -&gt; Multiple linear regression.</li>
<li>Two categorical explanatory variables -&gt; Two-way ANOVA.</li>
<li>One continuous and one categorical explanatory variable -&gt; Analysis of covariance (ANCOVA).</li>
</ul>
<p>We will look at each of these, and start with multiple linear regression which is usually shortened to just multiple regression.</p>
</section>
<section id="multiple-regression" class="level2">
<h2 class="anchored" data-anchor-id="multiple-regression">Multiple regression</h2>
<p>We previously looked at whether blood pressure is associated with age. This is an important question, because blood pressure has many health implications. However, blood pressure is not only associated with age, but also with other factors, such as weight, height, and lifestyle. In this chapter, we will look at how to investigate the association between blood pressure and multiple explanatory variables.</p>
<p>When we have multiple explanatory variables, we are often interested in questions such as:</p>
<ul>
<li>Question 1: As an ensemble (i.e., all together), are the explanatory variables “useful”?</li>
<li>Question 2: Are each of the explanatory variables associated with the response?</li>
<li>Question 3: What proportion of variability is explained?</li>
<li>Question 4: Are some explanatory variables more important than others?</li>
</ul>
<section id="an-example-dataset" class="level3">
<h3 class="anchored" data-anchor-id="an-example-dataset">An example dataset</h3>
<p>Blood pressure is again the response variable, with age and lifestyle as two explanatory variables. Lifestyle is a continuous variable that is the number of minutes of exercise per week.</p>
<p>Reading in the dataset:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>bp_data_multreg <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"datasets/bp_data_multreg.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 100 Columns: 3
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
dbl (3): age, mins_exercise, bp

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
</div>
<p>Here is a look at the dataset:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(bp_data_multreg)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 3
    age mins_exercise    bp
  &lt;dbl&gt;         &lt;dbl&gt; &lt;dbl&gt;
1    45           248    80
2    49            61   119
3    78            21   109
4    60            37   112
5    39           125    86
6    40            55   117</code></pre>
</div>
</div>
<p>Since there are three variables, we can make three different scatter plots to visualise the relationships:</p>
<p><strong>1. Age vs blood pressure.</strong> This is the graph of the response variable (blood pressure) against one of the explanatory variables (age). It looks like there is evidence of a positive relationship.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="6.1-multiple-regression_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="432"></p>
</figure>
</div>
</div>
</div>
<p>Here we see a positive relationship between age and blood pressure. Blood pressure tends to increase with age.</p>
<p><strong>2. Minutes of exercise vs blood pressure.</strong> This is a graph of the response variable (blood pressure) against the other explanatory variable (minutes of exercise). It looks like there is evidence of a negative relationship.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="6.1-multiple-regression_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="432"></p>
</figure>
</div>
</div>
</div>
<p>Here we see a negative relationship between minutes of exercise and blood pressure. Blood pressure tends to decrease with more minutes of exercise.</p>
<p><strong>3. Age vs minutes of exercise.</strong> This is a graph of the two explanatory variables against each other. It looks like there is no relationship.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="6.1-multiple-regression_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="432"></p>
</figure>
</div>
</div>
</div>
<p>And here we see no relationship between age and minutes of exercise. The two explanatory variables appear to be independent.</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p>The lack of correlation between the two explanatory variables is very important. If the two explanatory variables were correlated, we would have a situation known as multicollinearity. Multicollinearity can greatly complicate the interpretation of the results of a multiple regression analysis. We will discuss multicollinearity later.</p>
</div>
</div>
</section>
<section id="the-multiple-linear-regression-model" class="level3">
<h3 class="anchored" data-anchor-id="the-multiple-linear-regression-model">The multiple linear regression model</h3>
<p>The multiple linear regression model is an extension of the simple linear regression model. Recall the simple linear regression model is:</p>
<p><span class="math display">\[y_i = \beta_0 + \beta_1 x_i + \epsilon_i\]</span></p>
<p>where:</p>
<ul>
<li><span class="math inline">\(y_i\)</span> is the response variable</li>
<li><span class="math inline">\(x_i\)</span> is the explanatory variable</li>
<li><span class="math inline">\(\beta_0\)</span> is the intercept</li>
<li><span class="math inline">\(\beta_1\)</span> is the slope</li>
<li><span class="math inline">\(\epsilon_i\)</span> is the error term.</li>
</ul>
<p>The multiple linear regression model with two explanatory variables is:</p>
<p><span class="math display">\[y_i = \beta_0 + \beta_1 x_i^{(1)} + \beta_2 x_i^{(2)} + \epsilon_i\]</span></p>
<p>where:</p>
<ul>
<li><span class="math inline">\(x_i^{(1)}\)</span> and <span class="math inline">\(x_i^{(2)}\)</span> are the two explanatory variables</li>
<li><span class="math inline">\(\beta_0\)</span> is the intercept</li>
<li><span class="math inline">\(\beta_1\)</span> is the slope for the first explanatory variable</li>
<li><span class="math inline">\(\beta_2\)</span> is the slope for the second explanatory variable</li>
</ul>
<p>Note that the intercept <span class="math inline">\(\beta_0\)</span> is the value of the response variable when all explanatory variables are zero. In this example, it would be the blood pressure for someone that is 0 years old and does 0 minutes of exercise per week. This is not a particularly useful scenario, but it is a necessary mathematical construct that helps us to build the model.</p>
<p>We can extend the multiple regression model to have an arbitrary number of explanatory variables:</p>
<p><span class="math display">\[y_i = \beta_0 + \beta_1 x_i^{(1)} + \beta_2 x_i^{(2)} + \ldots + \beta_p x_i^{(p)} + \epsilon_i\]</span></p>
<p>Where:</p>
<p><span class="math inline">\(x_i^{(1)}, x_i^{(2)}, \ldots, x_i^{(p)}\)</span> are the <span class="math inline">\(p\)</span> explanatory variables and all else is as before.</p>
<p>or with summation notation:</p>
<p><span class="math display">\[y_i = \beta_0 + \sum_{j=1}^p \beta_j x_i^{(j)} + \epsilon_i\]</span></p>
<p>Just like in simple linear regression, we can estimate the parameters <span class="math inline">\(\beta_0, \beta_1, \ldots, \beta_p\)</span> using the method of least squares. The least squares method minimizes the sum of the squared residuals:</p>
<p><span class="math display">\[\sum_{i=1}^n \epsilon_i^2 = \sum_{i=1}^n (y_i - \hat{y}_i)^2\]</span></p>
<p>where <span class="math inline">\(\hat{y}_i\)</span> is the predicted value of the response variable for the <span class="math inline">\(i\)</span>th observation:</p>
<p><span class="math display">\[\hat{y}_i = \hat{\beta}_0 + \sum_{j=1}^p \hat{\beta}_j x_i^{(j)}\]</span> where:</p>
<p><span class="math inline">\(\hat{\beta}_0, \hat{\beta}_1, \ldots, \hat{\beta}_p\)</span> are the estimated parameters.</p>
<p><strong>Think-Pair-Share</strong> (#tps-two-shape) Graphically, a linear regression with one explanatory variable is a line. What is a geometric representation of linear regression with two explanatory variables?</p>
<p>Here is a graph of the geometric representation of a multiple linear regression model with two explanatory variables (please note that this plot is best viewed in the HTML version of the book; in the PDF version, it will appear as a static image):</p>
<div class="cell">
<div class="cell-output-display">
<div id="htmlwidget-845d1d820e094601f516" style="width:100%;height:650px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-845d1d820e094601f516">{"x":{"visdat":{"a8274b99aabe":["function () ","plotlyVisDat"]},"cur_data":"a8274b99aabe","attrs":{"a8274b99aabe":{"x":{},"y":{},"z":{},"colorscale":"Viridis","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"surface"}},"layout":{"width":500,"height":500,"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Multiple Linear Regression Plane","scene":{"xaxis":{"title":"Explanatory Variable 1 (x1)"},"yaxis":{"title":"Explanatory Variable 2 (x2)"},"zaxis":{"title":"Response Variable (y)"}},"hovermode":"closest","showlegend":false,"legend":{"yanchor":"top","y":0.5}},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"colorbar":{"title":"z_matrix","ticklen":2,"len":0.5,"lenmode":"fraction","y":1,"yanchor":"top"},"colorscale":"Viridis","showscale":true,"x":[-5,-4.795918367346939,-4.591836734693878,-4.3877551020408161,-4.1836734693877551,-3.9795918367346941,-3.7755102040816326,-3.5714285714285712,-3.3673469387755102,-3.1632653061224492,-2.9591836734693877,-2.7551020408163263,-2.5510204081632653,-2.3469387755102042,-2.1428571428571428,-1.9387755102040813,-1.7346938775510203,-1.5306122448979593,-1.3265306122448979,-1.1224489795918364,-0.91836734693877542,-0.71428571428571441,-0.51020408163265252,-0.30612244897959151,-0.1020408163265305,0.1020408163265305,0.30612244897959151,0.51020408163265341,0.71428571428571441,0.91836734693877542,1.1224489795918373,1.3265306122448983,1.5306122448979593,1.7346938775510203,1.9387755102040813,2.1428571428571432,2.3469387755102042,2.5510204081632653,2.7551020408163271,2.9591836734693882,3.1632653061224492,3.3673469387755102,3.5714285714285712,3.7755102040816322,3.979591836734695,4.183673469387756,4.387755102040817,4.591836734693878,4.795918367346939,5],"y":[-5,-4.795918367346939,-4.591836734693878,-4.3877551020408161,-4.1836734693877551,-3.9795918367346941,-3.7755102040816326,-3.5714285714285712,-3.3673469387755102,-3.1632653061224492,-2.9591836734693877,-2.7551020408163263,-2.5510204081632653,-2.3469387755102042,-2.1428571428571428,-1.9387755102040813,-1.7346938775510203,-1.5306122448979593,-1.3265306122448979,-1.1224489795918364,-0.91836734693877542,-0.71428571428571441,-0.51020408163265252,-0.30612244897959151,-0.1020408163265305,0.1020408163265305,0.30612244897959151,0.51020408163265341,0.71428571428571441,0.91836734693877542,1.1224489795918373,1.3265306122448983,1.5306122448979593,1.7346938775510203,1.9387755102040813,2.1428571428571432,2.3469387755102042,2.5510204081632653,2.7551020408163271,2.9591836734693882,3.1632653061224492,3.3673469387755102,3.5714285714285712,3.7755102040816322,3.979591836734695,4.183673469387756,4.387755102040817,4.591836734693878,4.795918367346939,5],"z":[[0.5,0.37755102040816313,0.2551020408163267,0.13265306122448939,0.010204081632652962,-0.11224489795918347,-0.23469387755102034,-0.35714285714285721,-0.47959183673469408,-0.6020408163265305,-0.72448979591836737,-0.84693877551020424,-0.96938775510204089,-1.0918367346938775,-1.2142857142857144,-1.3367346938775513,-1.4591836734693879,-1.5816326530612246,-1.7040816326530615,-1.8265306122448983,-1.9489795918367347,-2.0714285714285712,-2.1938775510204085,-2.3163265306122449,-2.4387755102040818,-2.5612244897959182,-2.6836734693877551,-2.806122448979592,-2.9285714285714288,-3.0510204081632653,-3.1734693877551026,-3.295918367346939,-3.4183673469387754,-3.5408163265306118,-3.6632653061224487,-3.7857142857142856,-3.9081632653061225,-4.0306122448979593,-4.1530612244897966,-4.2755102040816331,-4.3979591836734695,-4.5204081632653059,-4.6428571428571423,-4.7653061224489797,-4.887755102040817,-5.0102040816326534,-5.1326530612244898,-5.2551020408163271,-5.3775510204081627,-5.5],[0.6020408163265305,0.47959183673469363,0.35714285714285721,0.23469387755101989,0.11224489795918347,-0.010204081632652962,-0.13265306122448983,-0.2551020408163267,-0.37755102040816357,-0.5,-0.62244897959183687,-0.74489795918367374,-0.86734693877551039,-0.98979591836734704,-1.1122448979591839,-1.2346938775510208,-1.3571428571428574,-1.4795918367346941,-1.6020408163265309,-1.7244897959183678,-1.8469387755102042,-1.9693877551020409,-2.091836734693878,-2.2142857142857144,-2.3367346938775513,-2.4591836734693877,-2.5816326530612246,-2.7040816326530615,-2.8265306122448983,-2.9489795918367347,-3.0714285714285721,-3.1938775510204085,-3.3163265306122449,-3.4387755102040813,-3.5612244897959182,-3.6836734693877551,-3.806122448979592,-3.9285714285714288,-4.0510204081632661,-4.1734693877551026,-4.295918367346939,-4.4183673469387754,-4.5408163265306118,-4.6632653061224492,-4.7857142857142865,-4.9081632653061229,-5.0306122448979593,-5.1530612244897966,-5.2755102040816322,-5.3979591836734695],[0.70408163265306101,0.58163265306122414,0.45918367346938771,0.3367346938775504,0.21428571428571397,0.091836734693877542,-0.030612244897959329,-0.1530612244897962,-0.27551020408163307,-0.3979591836734695,-0.52040816326530637,-0.64285714285714324,-0.76530612244897989,-0.88775510204081653,-1.0102040816326534,-1.1326530612244903,-1.2551020408163269,-1.3775510204081636,-1.5000000000000004,-1.6224489795918373,-1.7448979591836737,-1.8673469387755104,-1.9897959183673475,-2.1122448979591839,-2.2346938775510208,-2.3571428571428572,-2.4795918367346941,-2.6020408163265309,-2.7244897959183678,-2.8469387755102042,-2.9693877551020416,-3.091836734693878,-3.2142857142857144,-3.3367346938775508,-3.4591836734693877,-3.5816326530612246,-3.7040816326530615,-3.8265306122448983,-3.9489795918367352,-4.0714285714285721,-4.1938775510204085,-4.3163265306122449,-4.4387755102040813,-4.5612244897959187,-4.683673469387756,-4.8061224489795924,-4.9285714285714288,-5.0510204081632661,-5.1734693877551017,-5.295918367346939],[0.80612244897959195,0.68367346938775508,0.56122448979591866,0.43877551020408134,0.31632653061224492,0.19387755102040849,0.071428571428571619,-0.051020408163265252,-0.17346938775510212,-0.29591836734693855,-0.41836734693877542,-0.54081632653061229,-0.66326530612244894,-0.78571428571428559,-0.90816326530612246,-1.0306122448979593,-1.153061224489796,-1.2755102040816326,-1.3979591836734695,-1.5204081632653064,-1.6428571428571428,-1.7653061224489794,-1.8877551020408165,-2.010204081632653,-2.1326530612244898,-2.2551020408163263,-2.3775510204081631,-2.5,-2.6224489795918369,-2.7448979591836733,-2.8673469387755102,-2.989795918367347,-3.1122448979591835,-3.2346938775510203,-3.3571428571428568,-3.4795918367346941,-3.6020408163265305,-3.7244897959183669,-3.8469387755102042,-3.9693877551020407,-4.091836734693878,-4.2142857142857135,-4.3367346938775508,-4.4591836734693873,-4.5816326530612255,-4.704081632653061,-4.8265306122448983,-4.9489795918367347,-5.0714285714285712,-5.1938775510204085],[0.90816326530612246,0.78571428571428559,0.66326530612244916,0.54081632653061185,0.41836734693877542,0.29591836734693899,0.17346938775510212,0.051020408163265252,-0.071428571428571619,-0.19387755102040805,-0.31632653061224492,-0.43877551020408179,-0.56122448979591844,-0.68367346938775508,-0.80612244897959195,-0.92857142857142883,-1.0510204081632655,-1.1734693877551021,-1.295918367346939,-1.4183673469387759,-1.5408163265306123,-1.6632653061224489,-1.785714285714286,-1.9081632653061227,-2.0306122448979593,-2.1530612244897958,-2.2755102040816326,-2.3979591836734695,-2.5204081632653064,-2.6428571428571428,-2.7653061224489797,-2.8877551020408165,-3.010204081632653,-3.1326530612244898,-3.2551020408163263,-3.3775510204081636,-3.5,-3.6224489795918364,-3.7448979591836737,-3.8673469387755102,-3.989795918367347,-4.112244897959183,-4.2346938775510203,-4.3571428571428568,-4.479591836734695,-4.6020408163265305,-4.7244897959183678,-4.8469387755102042,-4.9693877551020407,-5.091836734693878],[1.010204081632653,0.88775510204081609,0.76530612244897966,0.64285714285714235,0.52040816326530592,0.3979591836734695,0.27551020408163263,0.15306122448979576,0.030612244897958885,-0.091836734693877542,-0.21428571428571441,-0.33673469387755128,-0.45918367346938793,-0.58163265306122458,-0.70408163265306145,-0.82653061224489832,-0.94897959183673497,-1.0714285714285716,-1.1938775510204085,-1.3163265306122454,-1.4387755102040818,-1.5612244897959184,-1.6836734693877555,-1.8061224489795922,-1.9285714285714288,-2.0510204081632653,-2.1734693877551021,-2.295918367346939,-2.4183673469387759,-2.5408163265306123,-2.6632653061224492,-2.785714285714286,-2.9081632653061225,-3.0306122448979593,-3.1530612244897958,-3.2755102040816331,-3.3979591836734695,-3.5204081632653059,-3.6428571428571432,-3.7653061224489797,-3.8877551020408165,-4.0102040816326525,-4.1326530612244898,-4.2551020408163263,-4.3775510204081645,-4.5,-4.6224489795918373,-4.7448979591836737,-4.8673469387755102,-4.9897959183673475],[1.1122448979591837,0.98979591836734682,0.86734693877551039,0.74489795918367308,0.62244897959183665,0.50000000000000022,0.37755102040816335,0.25510204081632648,0.13265306122448961,0.010204081632653184,-0.11224489795918369,-0.23469387755102056,-0.35714285714285721,-0.47959183673469385,-0.60204081632653073,-0.7244897959183676,-0.84693877551020424,-0.96938775510204078,-1.0918367346938775,-1.2142857142857144,-1.3367346938775511,-1.4591836734693877,-1.5816326530612248,-1.7040816326530615,-1.8265306122448981,-1.9489795918367345,-2.0714285714285712,-2.1938775510204085,-2.3163265306122449,-2.4387755102040813,-2.5612244897959187,-2.6836734693877551,-2.806122448979592,-2.9285714285714284,-3.0510204081632653,-3.1734693877551021,-3.295918367346939,-3.4183673469387754,-3.5408163265306127,-3.6632653061224492,-3.7857142857142856,-3.908163265306122,-4.0306122448979593,-4.1530612244897958,-4.2755102040816331,-4.3979591836734695,-4.5204081632653068,-4.6428571428571432,-4.7653061224489797,-4.8877551020408161],[1.2142857142857144,1.0918367346938775,0.96938775510204112,0.8469387755102038,0.72448979591836737,0.60204081632653095,0.47959183673469408,0.35714285714285721,0.23469387755102034,0.11224489795918391,-0.010204081632652962,-0.13265306122448983,-0.25510204081632648,-0.37755102040816313,-0.5,-0.62244897959183687,-0.74489795918367352,-0.86734693877551006,-0.98979591836734693,-1.1122448979591839,-1.2346938775510203,-1.357142857142857,-1.4795918367346941,-1.6020408163265307,-1.7244897959183674,-1.8469387755102038,-1.9693877551020404,-2.0918367346938775,-2.2142857142857144,-2.3367346938775508,-2.4591836734693882,-2.5816326530612246,-2.704081632653061,-2.8265306122448974,-2.9489795918367343,-3.0714285714285712,-3.193877551020408,-3.3163265306122449,-3.4387755102040818,-3.5612244897959187,-3.6836734693877551,-3.8061224489795915,-3.9285714285714284,-4.0510204081632644,-4.1734693877551026,-4.295918367346939,-4.4183673469387763,-4.5408163265306118,-4.6632653061224492,-4.7857142857142856],[1.3163265306122449,1.193877551020408,1.0714285714285716,0.9489795918367343,0.82653061224489788,0.70408163265306145,0.58163265306122458,0.45918367346938771,0.33673469387755084,0.21428571428571441,0.091836734693877542,-0.030612244897959329,-0.15306122448979598,-0.27551020408163263,-0.3979591836734695,-0.52040816326530637,-0.64285714285714302,-0.76530612244897955,-0.88775510204081642,-1.0102040816326534,-1.1326530612244898,-1.2551020408163265,-1.3775510204081636,-1.5000000000000002,-1.6224489795918369,-1.7448979591836733,-1.8673469387755099,-1.989795918367347,-2.1122448979591839,-2.2346938775510203,-2.3571428571428577,-2.4795918367346941,-2.6020408163265305,-2.7244897959183669,-2.8469387755102038,-2.9693877551020407,-3.0918367346938775,-3.2142857142857144,-3.3367346938775513,-3.4591836734693882,-3.5816326530612246,-3.704081632653061,-3.8265306122448979,-3.9489795918367343,-4.0714285714285721,-4.1938775510204085,-4.3163265306122458,-4.4387755102040813,-4.5612244897959187,-4.6836734693877551],[1.4183673469387754,1.2959183673469385,1.1734693877551021,1.0510204081632648,0.92857142857142838,0.80612244897959195,0.68367346938775508,0.56122448979591821,0.43877551020408134,0.31632653061224492,0.19387755102040805,0.071428571428571175,-0.051020408163265474,-0.17346938775510212,-0.29591836734693899,-0.41836734693877586,-0.54081632653061251,-0.66326530612244905,-0.78571428571428592,-0.90816326530612279,-1.0306122448979593,-1.153061224489796,-1.2755102040816331,-1.3979591836734697,-1.5204081632653064,-1.6428571428571428,-1.7653061224489794,-1.8877551020408165,-2.0102040816326534,-2.1326530612244898,-2.2551020408163271,-2.3775510204081636,-2.5,-2.6224489795918364,-2.7448979591836733,-2.8673469387755102,-2.989795918367347,-3.1122448979591839,-3.2346938775510208,-3.3571428571428577,-3.4795918367346941,-3.6020408163265305,-3.7244897959183674,-3.8469387755102038,-3.9693877551020416,-4.091836734693878,-4.2142857142857153,-4.3367346938775508,-4.4591836734693882,-4.5816326530612246],[1.5204081632653061,1.3979591836734693,1.2755102040816328,1.1530612244897955,1.0306122448979591,0.90816326530612268,0.78571428571428581,0.66326530612244894,0.54081632653061207,0.41836734693877564,0.29591836734693877,0.1734693877551019,0.051020408163265252,-0.071428571428571397,-0.19387755102040827,-0.31632653061224514,-0.43877551020408179,-0.56122448979591832,-0.68367346938775519,-0.80612244897959207,-0.9285714285714286,-1.0510204081632653,-1.1734693877551023,-1.295918367346939,-1.4183673469387756,-1.5408163265306121,-1.6632653061224487,-1.7857142857142858,-1.9081632653061225,-2.0306122448979593,-2.1530612244897962,-2.2755102040816331,-2.3979591836734695,-2.5204081632653059,-2.6428571428571423,-2.7653061224489797,-2.8877551020408161,-3.010204081632653,-3.1326530612244898,-3.2551020408163267,-3.3775510204081636,-3.5,-3.6224489795918364,-3.7448979591836729,-3.8673469387755111,-3.9897959183673475,-4.1122448979591839,-4.2346938775510203,-4.3571428571428568,-4.4795918367346941],[1.6224489795918369,1.5,1.3775510204081636,1.2551020408163263,1.1326530612244898,1.0102040816326534,0.88775510204081653,0.76530612244897966,0.64285714285714279,0.52040816326530637,0.3979591836734695,0.27551020408163263,0.15306122448979598,0.030612244897959329,-0.091836734693877542,-0.21428571428571441,-0.33673469387755106,-0.4591836734693876,-0.58163265306122447,-0.70408163265306134,-0.82653061224489788,-0.94897959183673453,-1.0714285714285716,-1.1938775510204083,-1.3163265306122449,-1.4387755102040813,-1.561224489795918,-1.6836734693877551,-1.8061224489795917,-1.9285714285714284,-2.0510204081632653,-2.1734693877551021,-2.2959183673469385,-2.4183673469387754,-2.5408163265306118,-2.6632653061224492,-2.7857142857142856,-2.908163265306122,-3.0306122448979593,-3.1530612244897958,-3.2755102040816326,-3.3979591836734691,-3.5204081632653059,-3.6428571428571423,-3.7653061224489801,-3.8877551020408165,-4.0102040816326534,-4.1326530612244898,-4.2551020408163263,-4.3775510204081627],[1.7244897959183674,1.6020408163265305,1.4795918367346941,1.3571428571428568,1.2346938775510203,1.1122448979591839,0.98979591836734704,0.86734693877551017,0.7448979591836733,0.62244897959183687,0.5,0.37755102040816313,0.25510204081632648,0.13265306122448983,0.010204081632652962,-0.11224489795918391,-0.23469387755102056,-0.3571428571428571,-0.47959183673469397,-0.60204081632653084,-0.72448979591836737,-0.84693877551020402,-0.96938775510204112,-1.0918367346938778,-1.2142857142857144,-1.3367346938775508,-1.4591836734693875,-1.5816326530612246,-1.7040816326530612,-1.8265306122448979,-1.948979591836735,-2.0714285714285716,-2.193877551020408,-2.3163265306122449,-2.4387755102040813,-2.5612244897959187,-2.6836734693877551,-2.8061224489795915,-2.9285714285714288,-3.0510204081632653,-3.1734693877551021,-3.2959183673469385,-3.4183673469387754,-3.5408163265306118,-3.6632653061224496,-3.785714285714286,-3.9081632653061229,-4.0306122448979593,-4.1530612244897958,-4.2755102040816322],[1.8265306122448979,1.704081632653061,1.5816326530612246,1.4591836734693873,1.3367346938775508,1.2142857142857144,1.0918367346938775,0.96938775510204067,0.8469387755102038,0.72448979591836737,0.6020408163265305,0.47959183673469363,0.35714285714285698,0.23469387755102034,0.11224489795918347,-0.010204081632653406,-0.13265306122449005,-0.25510204081632659,-0.37755102040816346,-0.50000000000000033,-0.62244897959183687,-0.74489795918367352,-0.86734693877551061,-0.98979591836734726,-1.1122448979591839,-1.2346938775510203,-1.357142857142857,-1.4795918367346941,-1.6020408163265307,-1.7244897959183674,-1.8469387755102045,-1.9693877551020411,-2.0918367346938775,-2.2142857142857144,-2.3367346938775508,-2.4591836734693882,-2.5816326530612246,-2.704081632653061,-2.8265306122448983,-2.9489795918367347,-3.0714285714285716,-3.193877551020408,-3.3163265306122449,-3.4387755102040813,-3.5612244897959191,-3.6836734693877555,-3.8061224489795924,-3.9285714285714288,-4.0510204081632653,-4.1734693877551017],[1.9285714285714286,1.8061224489795917,1.6836734693877553,1.561224489795918,1.4387755102040816,1.3163265306122451,1.1938775510204083,1.0714285714285714,0.94897959183673453,0.8265306122448981,0.70408163265306123,0.58163265306122436,0.45918367346938771,0.33673469387755106,0.21428571428571419,0.09183673469387732,-0.030612244897959329,-0.15306122448979587,-0.27551020408163274,-0.39795918367346961,-0.52040816326530615,-0.64285714285714279,-0.76530612244897989,-0.88775510204081653,-1.0102040816326532,-1.1326530612244896,-1.2551020408163263,-1.3775510204081634,-1.5,-1.6224489795918366,-1.7448979591836737,-1.8673469387755104,-1.989795918367347,-2.1122448979591835,-2.2346938775510203,-2.3571428571428572,-2.4795918367346941,-2.6020408163265305,-2.7244897959183678,-2.8469387755102042,-2.9693877551020407,-3.0918367346938771,-3.2142857142857144,-3.3367346938775508,-3.4591836734693882,-3.5816326530612246,-3.7040816326530619,-3.8265306122448983,-3.9489795918367347,-4.0714285714285712],[2.0306122448979593,1.9081632653061225,1.785714285714286,1.6632653061224487,1.5408163265306123,1.4183673469387759,1.295918367346939,1.1734693877551021,1.0510204081632653,0.92857142857142883,0.80612244897959195,0.68367346938775508,0.56122448979591844,0.43877551020408179,0.31632653061224492,0.19387755102040805,0.071428571428571397,-0.051020408163265141,-0.17346938775510201,-0.29591836734693888,-0.41836734693877542,-0.54081632653061207,-0.66326530612244916,-0.78571428571428581,-0.90816326530612235,-1.0306122448979589,-1.1530612244897955,-1.2755102040816326,-1.3979591836734693,-1.5204081632653059,-1.642857142857143,-1.7653061224489797,-1.8877551020408161,-2.0102040816326525,-2.1326530612244894,-2.2551020408163263,-2.3775510204081631,-2.5,-2.6224489795918369,-2.7448979591836737,-2.8673469387755102,-2.9897959183673466,-3.1122448979591835,-3.2346938775510199,-3.3571428571428577,-3.4795918367346941,-3.6020408163265309,-3.7244897959183674,-3.8469387755102038,-3.9693877551020407],[2.1326530612244898,2.010204081632653,1.8877551020408165,1.7653061224489792,1.6428571428571428,1.5204081632653064,1.3979591836734695,1.2755102040816326,1.1530612244897958,1.0306122448979593,0.90816326530612246,0.78571428571428559,0.66326530612244894,0.54081632653061229,0.41836734693877542,0.29591836734693855,0.1734693877551019,0.051020408163265363,-0.071428571428571508,-0.19387755102040838,-0.31632653061224492,-0.43877551020408151,-0.56122448979591866,-0.68367346938775531,-0.80612244897959184,-0.92857142857142849,-1.051020408163265,-1.1734693877551021,-1.2959183673469388,-1.4183673469387754,-1.5408163265306125,-1.6632653061224492,-1.7857142857142856,-1.9081632653061222,-2.0306122448979589,-2.1530612244897958,-2.2755102040816326,-2.3979591836734695,-2.5204081632653064,-2.6428571428571432,-2.7653061224489797,-2.8877551020408161,-3.010204081632653,-3.1326530612244894,-3.2551020408163271,-3.3775510204081636,-3.5000000000000004,-3.6224489795918369,-3.7448979591836733,-3.8673469387755102],[2.2346938775510203,2.1122448979591835,1.989795918367347,1.8673469387755097,1.7448979591836733,1.6224489795918369,1.5,1.3775510204081631,1.2551020408163263,1.1326530612244898,1.010204081632653,0.88775510204081609,0.76530612244897944,0.64285714285714279,0.52040816326530592,0.39795918367346905,0.2755102040816324,0.15306122448979587,0.030612244897958996,-0.091836734693877875,-0.21428571428571441,-0.33673469387755101,-0.45918367346938815,-0.5816326530612248,-0.70408163265306134,-0.82653061224489799,-0.94897959183673453,-1.0714285714285716,-1.1938775510204083,-1.3163265306122449,-1.438775510204082,-1.5612244897959187,-1.6836734693877551,-1.8061224489795917,-1.9285714285714284,-2.0510204081632653,-2.1734693877551021,-2.295918367346939,-2.4183673469387759,-2.5408163265306127,-2.6632653061224492,-2.7857142857142856,-2.9081632653061225,-3.0306122448979589,-3.1530612244897966,-3.2755102040816331,-3.3979591836734699,-3.5204081632653064,-3.6428571428571428,-3.7653061224489797],[2.3367346938775508,2.2142857142857144,2.091836734693878,1.9693877551020404,1.846938775510204,1.7244897959183676,1.6020408163265307,1.4795918367346939,1.357142857142857,1.2346938775510206,1.1122448979591837,0.98979591836734682,0.86734693877551017,0.74489795918367352,0.62244897959183665,0.49999999999999978,0.37755102040816313,0.25510204081632659,0.13265306122448972,0.010204081632652851,-0.11224489795918369,-0.23469387755102028,-0.35714285714285743,-0.47959183673469408,-0.60204081632653061,-0.72448979591836726,-0.8469387755102038,-0.96938775510204089,-1.0918367346938775,-1.2142857142857142,-1.3367346938775513,-1.4591836734693879,-1.5816326530612246,-1.704081632653061,-1.8265306122448977,-1.9489795918367347,-2.0714285714285712,-2.193877551020408,-2.3163265306122449,-2.4387755102040818,-2.5612244897959187,-2.6836734693877551,-2.8061224489795915,-2.9285714285714279,-3.0510204081632661,-3.1734693877551026,-3.295918367346939,-3.4183673469387754,-3.5408163265306118,-3.6632653061224492],[2.4387755102040818,2.3163265306122449,2.1938775510204085,2.0714285714285712,1.9489795918367347,1.8265306122448983,1.7040816326530615,1.5816326530612246,1.4591836734693877,1.3367346938775513,1.2142857142857144,1.0918367346938775,0.96938775510204089,0.84693877551020424,0.72448979591836737,0.6020408163265305,0.47959183673469385,0.35714285714285732,0.23469387755102045,0.11224489795918358,-0.010204081632652962,-0.13265306122448955,-0.2551020408163267,-0.37755102040816335,-0.49999999999999989,-0.62244897959183654,-0.74489795918367308,-0.86734693877551017,-0.98979591836734682,-1.1122448979591835,-1.2346938775510206,-1.3571428571428572,-1.4795918367346936,-1.6020408163265303,-1.7244897959183669,-1.846938775510204,-1.9693877551020407,-2.0918367346938771,-2.2142857142857144,-2.3367346938775508,-2.4591836734693877,-2.5816326530612241,-2.704081632653061,-2.8265306122448974,-2.9489795918367352,-3.0714285714285716,-3.1938775510204085,-3.3163265306122449,-3.4387755102040813,-3.5612244897959182],[2.5408163265306123,2.4183673469387754,2.295918367346939,2.1734693877551017,2.0510204081632653,1.9285714285714288,1.806122448979592,1.6836734693877551,1.5612244897959182,1.4387755102040818,1.3163265306122449,1.193877551020408,1.0714285714285714,0.94897959183673475,0.82653061224489788,0.70408163265306101,0.58163265306122436,0.45918367346938782,0.33673469387755095,0.21428571428571408,0.091836734693877542,-0.030612244897959051,-0.1530612244897962,-0.27551020408163285,-0.39795918367346939,-0.52040816326530603,-0.64285714285714257,-0.76530612244897966,-0.88775510204081631,-1.010204081632653,-1.1326530612244901,-1.2551020408163267,-1.3775510204081631,-1.4999999999999998,-1.6224489795918364,-1.7448979591836735,-1.8673469387755102,-1.9897959183673468,-2.1122448979591839,-2.2346938775510203,-2.3571428571428572,-2.4795918367346936,-2.6020408163265305,-2.7244897959183669,-2.8469387755102047,-2.9693877551020411,-3.091836734693878,-3.2142857142857144,-3.3367346938775508,-3.4591836734693877],[2.6428571428571428,2.5204081632653059,2.3979591836734695,2.2755102040816322,2.1530612244897958,2.0306122448979593,1.9081632653061225,1.7857142857142856,1.6632653061224487,1.5408163265306123,1.4183673469387754,1.2959183673469385,1.1734693877551019,1.0510204081632653,0.92857142857142838,0.80612244897959151,0.68367346938775486,0.56122448979591832,0.43877551020408145,0.31632653061224458,0.19387755102040805,0.071428571428571452,-0.051020408163265696,-0.17346938775510232,-0.29591836734693888,-0.41836734693877553,-0.54081632653061207,-0.66326530612244916,-0.78571428571428581,-0.90816326530612246,-1.0306122448979596,-1.1530612244897962,-1.2755102040816326,-1.3979591836734693,-1.5204081632653059,-1.642857142857143,-1.7653061224489797,-1.8877551020408163,-2.0102040816326534,-2.1326530612244898,-2.2551020408163267,-2.3775510204081631,-2.5,-2.6224489795918364,-2.7448979591836742,-2.8673469387755106,-2.9897959183673475,-3.1122448979591839,-3.2346938775510203,-3.3571428571428572],[2.7448979591836737,2.6224489795918369,2.5000000000000004,2.3775510204081631,2.2551020408163267,2.1326530612244903,2.0102040816326534,1.8877551020408165,1.7653061224489797,1.6428571428571432,1.5204081632653064,1.3979591836734695,1.2755102040816328,1.1530612244897962,1.0306122448979593,0.90816326530612246,0.78571428571428581,0.66326530612244927,0.5408163265306124,0.41836734693877553,0.29591836734693899,0.1734693877551024,0.051020408163265252,-0.071428571428571369,-0.19387755102040796,-0.31632653061224458,-0.43877551020408112,-0.56122448979591821,-0.68367346938775486,-0.80612244897959151,-0.9285714285714286,-1.0510204081632653,-1.1734693877551017,-1.2959183673469383,-1.418367346938775,-1.5408163265306121,-1.6632653061224487,-1.7857142857142854,-1.9081632653061225,-2.0306122448979593,-2.1530612244897958,-2.2755102040816322,-2.3979591836734691,-2.5204081632653055,-2.6428571428571432,-2.7653061224489797,-2.8877551020408165,-3.010204081632653,-3.1326530612244894,-3.2551020408163263],[2.8469387755102042,2.7244897959183674,2.6020408163265309,2.4795918367346936,2.3571428571428572,2.2346938775510208,2.1122448979591839,1.989795918367347,1.8673469387755102,1.7448979591836737,1.6224489795918369,1.5,1.3775510204081634,1.2551020408163267,1.1326530612244898,1.010204081632653,0.88775510204081631,0.76530612244897978,0.6428571428571429,0.52040816326530603,0.3979591836734695,0.2755102040816329,0.15306122448979576,0.030612244897959134,-0.091836734693877459,-0.21428571428571405,-0.33673469387755062,-0.45918367346938777,-0.58163265306122436,-0.70408163265306101,-0.8265306122448981,-0.94897959183673475,-1.0714285714285712,-1.1938775510204078,-1.3163265306122445,-1.4387755102040816,-1.5612244897959182,-1.6836734693877549,-1.806122448979592,-1.9285714285714286,-2.0510204081632653,-2.1734693877551017,-2.2959183673469385,-2.418367346938775,-2.5408163265306127,-2.6632653061224492,-2.785714285714286,-2.9081632653061225,-3.0306122448979589,-3.1530612244897958],[2.9489795918367347,2.8265306122448979,2.7040816326530615,2.5816326530612241,2.4591836734693877,2.3367346938775513,2.2142857142857144,2.0918367346938775,1.9693877551020407,1.8469387755102042,1.7244897959183674,1.6020408163265305,1.4795918367346939,1.3571428571428572,1.2346938775510203,1.1122448979591835,0.98979591836734682,0.86734693877551028,0.74489795918367341,0.62244897959183654,0.5,0.37755102040816341,0.25510204081632626,0.13265306122448964,0.010204081632653045,-0.11224489795918355,-0.23469387755102014,-0.35714285714285726,-0.47959183673469391,-0.6020408163265305,-0.7244897959183676,-0.84693877551020424,-0.96938775510204078,-1.0918367346938773,-1.214285714285714,-1.3367346938775511,-1.4591836734693877,-1.5816326530612244,-1.7040816326530615,-1.8265306122448981,-1.9489795918367347,-2.0714285714285712,-2.193877551020408,-2.3163265306122445,-2.4387755102040822,-2.5612244897959187,-2.6836734693877555,-2.806122448979592,-2.9285714285714284,-3.0510204081632653],[3.0510204081632653,2.9285714285714284,2.806122448979592,2.6836734693877546,2.5612244897959182,2.4387755102040818,2.3163265306122449,2.193877551020408,2.0714285714285712,1.9489795918367347,1.8265306122448979,1.704081632653061,1.5816326530612244,1.4591836734693877,1.3367346938775508,1.214285714285714,1.0918367346938773,0.96938775510204078,0.84693877551020391,0.72448979591836704,0.6020408163265305,0.47959183673469391,0.35714285714285676,0.23469387755102014,0.11224489795918355,-0.010204081632653045,-0.13265306122448964,-0.25510204081632676,-0.37755102040816341,-0.5,-0.62244897959183709,-0.74489795918367374,-0.86734693877551028,-0.98979591836734682,-1.1122448979591835,-1.2346938775510206,-1.3571428571428572,-1.4795918367346939,-1.6020408163265309,-1.7244897959183676,-1.8469387755102042,-1.9693877551020407,-2.0918367346938775,-2.214285714285714,-2.3367346938775517,-2.4591836734693882,-2.581632653061225,-2.7040816326530615,-2.8265306122448979,-2.9489795918367347],[3.1530612244897958,3.0306122448979589,2.9081632653061225,2.7857142857142851,2.6632653061224487,2.5408163265306123,2.4183673469387754,2.2959183673469385,2.1734693877551017,2.0510204081632653,1.9285714285714284,1.8061224489795915,1.6836734693877549,1.5612244897959182,1.4387755102040813,1.3163265306122445,1.1938775510204078,1.0714285714285712,0.94897959183673442,0.82653061224489754,0.70408163265306101,0.58163265306122436,0.45918367346938727,0.33673469387755062,0.21428571428571405,0.091836734693877459,-0.030612244897959134,-0.15306122448979625,-0.2755102040816329,-0.3979591836734695,-0.52040816326530659,-0.64285714285714324,-0.76530612244897978,-0.88775510204081631,-1.010204081632653,-1.1326530612244901,-1.2551020408163267,-1.3775510204081634,-1.5000000000000004,-1.6224489795918371,-1.7448979591836737,-1.8673469387755102,-1.989795918367347,-2.1122448979591835,-2.2346938775510212,-2.3571428571428577,-2.4795918367346945,-2.6020408163265309,-2.7244897959183674,-2.8469387755102042],[3.2551020408163267,3.1326530612244898,3.0102040816326534,2.8877551020408161,2.7653061224489797,2.6428571428571432,2.5204081632653064,2.3979591836734695,2.2755102040816326,2.1530612244897962,2.0306122448979593,1.9081632653061225,1.7857142857142858,1.6632653061224492,1.5408163265306123,1.4183673469387754,1.2959183673469388,1.1734693877551021,1.0510204081632653,0.92857142857142849,0.80612244897959195,0.68367346938775531,0.56122448979591821,0.43877551020408156,0.31632653061224503,0.19387755102040841,0.071428571428571813,-0.051020408163265307,-0.17346938775510196,-0.29591836734693855,-0.41836734693877564,-0.54081632653061229,-0.66326530612244883,-0.78571428571428537,-0.90816326530612201,-1.0306122448979591,-1.1530612244897958,-1.2755102040816324,-1.3979591836734695,-1.5204081632653061,-1.6428571428571428,-1.7653061224489792,-1.8877551020408161,-2.0102040816326525,-2.1326530612244903,-2.2551020408163267,-2.3775510204081636,-2.5,-2.6224489795918364,-2.7448979591836733],[3.3571428571428572,3.2346938775510203,3.1122448979591839,2.9897959183673466,2.8673469387755102,2.7448979591836737,2.6224489795918369,2.5,2.3775510204081631,2.2551020408163267,2.1326530612244898,2.010204081632653,1.8877551020408163,1.7653061224489797,1.6428571428571428,1.5204081632653059,1.3979591836734693,1.2755102040816326,1.1530612244897958,1.0306122448979589,0.90816326530612246,0.78571428571428581,0.66326530612244872,0.54081632653061207,0.41836734693877553,0.29591836734693888,0.17346938775510232,0.051020408163265196,-0.071428571428571452,-0.19387755102040805,-0.31632653061224514,-0.43877551020408179,-0.56122448979591832,-0.68367346938775486,-0.80612244897959151,-0.9285714285714286,-1.0510204081632653,-1.1734693877551019,-1.295918367346939,-1.4183673469387756,-1.5408163265306123,-1.6632653061224487,-1.7857142857142856,-1.908163265306122,-2.0306122448979598,-2.1530612244897962,-2.2755102040816331,-2.3979591836734695,-2.5204081632653059,-2.6428571428571428],[3.4591836734693877,3.3367346938775508,3.2142857142857144,3.0918367346938771,2.9693877551020407,2.8469387755102042,2.7244897959183674,2.6020408163265305,2.4795918367346936,2.3571428571428572,2.2346938775510203,2.1122448979591835,1.9897959183673468,1.8673469387755102,1.7448979591836733,1.6224489795918364,1.4999999999999998,1.3775510204081631,1.2551020408163263,1.1326530612244894,1.010204081632653,0.88775510204081631,0.76530612244897922,0.64285714285714257,0.52040816326530603,0.39795918367346939,0.27551020408163285,0.1530612244897957,0.030612244897959051,-0.091836734693877542,-0.21428571428571463,-0.33673469387755128,-0.45918367346938782,-0.58163265306122436,-0.70408163265306101,-0.8265306122448981,-0.94897959183673475,-1.0714285714285714,-1.1938775510204085,-1.3163265306122451,-1.4387755102040818,-1.5612244897959182,-1.6836734693877551,-1.8061224489795915,-1.9285714285714293,-2.0510204081632657,-2.1734693877551026,-2.295918367346939,-2.4183673469387754,-2.5408163265306123],[3.5612244897959187,3.4387755102040818,3.3163265306122454,3.193877551020408,3.0714285714285716,2.9489795918367352,2.8265306122448983,2.7040816326530615,2.5816326530612246,2.4591836734693882,2.3367346938775513,2.2142857142857144,2.091836734693878,1.9693877551020411,1.8469387755102042,1.7244897959183674,1.6020408163265307,1.4795918367346941,1.3571428571428572,1.2346938775510203,1.1122448979591839,0.98979591836734726,0.86734693877551017,0.74489795918367352,0.62244897959183698,0.50000000000000033,0.3775510204081638,0.25510204081632665,0.13265306122449,0.010204081632653406,-0.11224489795918369,-0.23469387755102034,-0.35714285714285687,-0.47959183673469341,-0.60204081632653006,-0.72448979591836715,-0.8469387755102038,-0.96938775510204045,-1.0918367346938775,-1.2142857142857142,-1.3367346938775508,-1.4591836734693873,-1.5816326530612241,-1.7040816326530606,-1.8265306122448983,-1.9489795918367347,-2.0714285714285716,-2.193877551020408,-2.3163265306122445,-2.4387755102040813],[3.6632653061224492,3.5408163265306123,3.4183673469387759,3.2959183673469385,3.1734693877551021,3.0510204081632657,2.9285714285714288,2.806122448979592,2.6836734693877551,2.5612244897959187,2.4387755102040818,2.3163265306122449,2.1938775510204085,2.0714285714285716,1.9489795918367347,1.8265306122448979,1.7040816326530612,1.5816326530612246,1.4591836734693877,1.3367346938775508,1.2142857142857144,1.0918367346938778,0.96938775510204067,0.84693877551020402,0.72448979591836749,0.60204081632653084,0.4795918367346943,0.35714285714285715,0.2346938775510205,0.11224489795918391,-0.010204081632653184,-0.13265306122448983,-0.25510204081632637,-0.37755102040816291,-0.49999999999999956,-0.62244897959183665,-0.7448979591836733,-0.86734693877550995,-0.98979591836734704,-1.1122448979591837,-1.2346938775510203,-1.3571428571428568,-1.4795918367346936,-1.6020408163265301,-1.7244897959183678,-1.8469387755102042,-1.9693877551020411,-2.0918367346938775,-2.214285714285714,-2.3367346938775508],[3.7653061224489797,3.6428571428571428,3.5204081632653064,3.3979591836734691,3.2755102040816326,3.1530612244897962,3.0306122448979593,2.9081632653061225,2.7857142857142856,2.6632653061224492,2.5408163265306123,2.4183673469387754,2.295918367346939,2.1734693877551021,2.0510204081632653,1.9285714285714284,1.8061224489795917,1.6836734693877551,1.5612244897959182,1.4387755102040813,1.3163265306122449,1.1938775510204083,1.0714285714285712,0.94897959183673453,0.82653061224489799,0.70408163265306134,0.5816326530612248,0.45918367346938765,0.33673469387755101,0.21428571428571441,0.09183673469387732,-0.030612244897959329,-0.15306122448979587,-0.2755102040816324,-0.39795918367346905,-0.52040816326530615,-0.64285714285714279,-0.76530612244897944,-0.88775510204081653,-1.0102040816326532,-1.1326530612244898,-1.2551020408163263,-1.3775510204081631,-1.4999999999999996,-1.6224489795918373,-1.7448979591836737,-1.8673469387755106,-1.989795918367347,-2.1122448979591835,-2.2346938775510203],[3.8673469387755102,3.7448979591836733,3.6224489795918369,3.4999999999999996,3.3775510204081631,3.2551020408163267,3.1326530612244898,3.010204081632653,2.8877551020408161,2.7653061224489797,2.6428571428571428,2.5204081632653059,2.3979591836734695,2.2755102040816326,2.1530612244897958,2.0306122448979589,1.9081632653061222,1.7857142857142856,1.6632653061224487,1.5408163265306118,1.4183673469387754,1.2959183673469388,1.1734693877551017,1.051020408163265,0.92857142857142849,0.80612244897959184,0.68367346938775531,0.56122448979591821,0.43877551020408151,0.31632653061224492,0.19387755102040782,0.071428571428571175,-0.051020408163265363,-0.1734693877551019,-0.29591836734693855,-0.41836734693877564,-0.54081632653061229,-0.66326530612244894,-0.78571428571428603,-0.90816326530612268,-1.0306122448979593,-1.1530612244897958,-1.2755102040816326,-1.3979591836734691,-1.5204081632653068,-1.6428571428571432,-1.7653061224489801,-1.8877551020408165,-2.010204081632653,-2.1326530612244898],[3.9693877551020407,3.8469387755102038,3.7244897959183674,3.6020408163265301,3.4795918367346936,3.3571428571428572,3.2346938775510203,3.1122448979591835,2.9897959183673466,2.8673469387755102,2.7448979591836733,2.6224489795918364,2.5,2.3775510204081631,2.2551020408163263,2.1326530612244894,2.0102040816326525,1.8877551020408161,1.7653061224489792,1.6428571428571423,1.5204081632653059,1.3979591836734693,1.2755102040816322,1.1530612244897955,1.0306122448979589,0.90816326530612235,0.78571428571428581,0.66326530612244872,0.54081632653061207,0.41836734693877542,0.29591836734693833,0.17346938775510168,0.051020408163265141,-0.071428571428571397,-0.19387755102040805,-0.31632653061224514,-0.43877551020408179,-0.56122448979591844,-0.68367346938775553,-0.80612244897959218,-0.92857142857142883,-1.0510204081632653,-1.1734693877551021,-1.2959183673469385,-1.4183673469387763,-1.5408163265306127,-1.6632653061224496,-1.785714285714286,-1.9081632653061225,-2.0306122448979593],[4.0714285714285712,3.9489795918367347,3.8265306122448983,3.704081632653061,3.5816326530612246,3.4591836734693882,3.3367346938775513,3.2142857142857144,3.0918367346938775,2.9693877551020411,2.8469387755102042,2.7244897959183674,2.6020408163265305,2.4795918367346941,2.3571428571428572,2.2346938775510203,2.1122448979591839,1.989795918367347,1.8673469387755102,1.7448979591836733,1.6224489795918369,1.5000000000000002,1.3775510204081631,1.2551020408163265,1.1326530612244898,1.0102040816326534,0.88775510204081676,0.76530612244897966,0.64285714285714302,0.52040816326530637,0.39795918367346927,0.27551020408163263,0.15306122448979609,0.030612244897959551,-0.091836734693877098,-0.21428571428571419,-0.33673469387755084,-0.45918367346938749,-0.58163265306122458,-0.70408163265306123,-0.82653061224489788,-0.9489795918367343,-1.0714285714285712,-1.1938775510204076,-1.3163265306122454,-1.4387755102040818,-1.5612244897959187,-1.6836734693877551,-1.8061224489795915,-1.9285714285714284],[4.1734693877551017,4.0510204081632653,3.9285714285714288,3.8061224489795915,3.6836734693877551,3.5612244897959187,3.4387755102040818,3.3163265306122449,3.193877551020408,3.0714285714285716,2.9489795918367347,2.8265306122448979,2.704081632653061,2.5816326530612246,2.4591836734693877,2.3367346938775508,2.2142857142857144,2.0918367346938775,1.9693877551020407,1.8469387755102038,1.7244897959183674,1.6020408163265307,1.4795918367346936,1.357142857142857,1.2346938775510203,1.1122448979591839,0.98979591836734726,0.86734693877551017,0.74489795918367352,0.62244897959183687,0.49999999999999978,0.37755102040816313,0.25510204081632659,0.13265306122449005,0.010204081632653406,-0.11224489795918369,-0.23469387755102034,-0.35714285714285698,-0.47959183673469408,-0.60204081632653073,-0.72448979591836737,-0.8469387755102038,-0.96938775510204067,-1.0918367346938771,-1.2142857142857149,-1.3367346938775513,-1.4591836734693882,-1.5816326530612246,-1.704081632653061,-1.8265306122448979],[4.2755102040816322,4.1530612244897958,4.0306122448979593,3.908163265306122,3.7857142857142856,3.6632653061224492,3.5408163265306123,3.4183673469387754,3.2959183673469385,3.1734693877551021,3.0510204081632653,2.9285714285714284,2.8061224489795915,2.6836734693877551,2.5612244897959182,2.4387755102040813,2.3163265306122449,2.193877551020408,2.0714285714285712,1.9489795918367343,1.8265306122448979,1.7040816326530612,1.5816326530612241,1.4591836734693875,1.3367346938775508,1.2142857142857144,1.0918367346938778,0.96938775510204067,0.84693877551020402,0.72448979591836737,0.60204081632653028,0.47959183673469363,0.3571428571428571,0.23469387755102056,0.11224489795918391,-0.010204081632653184,-0.13265306122448983,-0.25510204081632648,-0.37755102040816357,-0.50000000000000022,-0.62244897959183687,-0.7448979591836733,-0.86734693877551017,-0.98979591836734659,-1.1122448979591844,-1.2346938775510208,-1.3571428571428577,-1.4795918367346941,-1.6020408163265305,-1.7244897959183674],[4.3775510204081636,4.2551020408163271,4.1326530612244898,4.0102040816326525,3.8877551020408165,3.7653061224489801,3.6428571428571432,3.5204081632653064,3.3979591836734695,3.2755102040816331,3.1530612244897962,3.0306122448979593,2.9081632653061229,2.785714285714286,2.6632653061224492,2.5408163265306123,2.4183673469387754,2.295918367346939,2.1734693877551021,2.0510204081632653,1.9285714285714288,1.8061224489795922,1.6836734693877551,1.5612244897959184,1.4387755102040818,1.3163265306122454,1.1938775510204087,1.0714285714285716,0.94897959183673497,0.82653061224489832,0.70408163265306123,0.58163265306122458,0.45918367346938804,0.33673469387755151,0.21428571428571486,0.091836734693877764,-0.030612244897958885,-0.15306122448979553,-0.27551020408163263,-0.39795918367346927,-0.52040816326530592,-0.64285714285714235,-0.76530612244897922,-0.88775510204081565,-1.0102040816326534,-1.1326530612244898,-1.2551020408163267,-1.3775510204081631,-1.4999999999999996,-1.6224489795918364],[4.4795918367346941,4.3571428571428577,4.2346938775510203,4.112244897959183,3.989795918367347,3.8673469387755106,3.7448979591836737,3.6224489795918369,3.5,3.3775510204081636,3.2551020408163267,3.1326530612244898,3.0102040816326534,2.8877551020408165,2.7653061224489797,2.6428571428571428,2.5204081632653059,2.3979591836734695,2.2755102040816326,2.1530612244897958,2.0306122448979593,1.9081632653061227,1.7857142857142856,1.6632653061224489,1.5408163265306123,1.4183673469387759,1.2959183673469392,1.1734693877551021,1.0510204081632655,0.92857142857142883,0.80612244897959173,0.68367346938775508,0.56122448979591855,0.43877551020408201,0.31632653061224536,0.19387755102040827,0.071428571428571619,-0.05102040816326503,-0.17346938775510212,-0.29591836734693877,-0.41836734693877542,-0.54081632653061185,-0.66326530612244872,-0.78571428571428514,-0.9081632653061229,-1.0306122448979593,-1.1530612244897962,-1.2755102040816326,-1.3979591836734691,-1.5204081632653059],[4.5816326530612246,4.4591836734693882,4.3367346938775508,4.2142857142857135,4.091836734693878,3.9693877551020411,3.8469387755102042,3.7244897959183674,3.6020408163265305,3.4795918367346941,3.3571428571428572,3.2346938775510203,3.1122448979591839,2.989795918367347,2.8673469387755102,2.7448979591836733,2.6224489795918364,2.5,2.3775510204081631,2.2551020408163263,2.1326530612244898,2.0102040816326534,1.8877551020408161,1.7653061224489794,1.6428571428571428,1.5204081632653064,1.3979591836734697,1.2755102040816326,1.153061224489796,1.0306122448979593,0.90816326530612224,0.78571428571428559,0.66326530612244905,0.54081632653061251,0.41836734693877586,0.29591836734693877,0.17346938775510212,0.051020408163265474,-0.071428571428571619,-0.19387755102040827,-0.31632653061224492,-0.43877551020408134,-0.56122448979591821,-0.68367346938775464,-0.8061224489795924,-0.92857142857142883,-1.0510204081632657,-1.1734693877551021,-1.2959183673469385,-1.4183673469387754],[4.6836734693877551,4.5612244897959187,4.4387755102040813,4.316326530612244,4.1938775510204085,4.0714285714285712,3.9489795918367347,3.8265306122448979,3.704081632653061,3.5816326530612246,3.4591836734693877,3.3367346938775508,3.2142857142857144,3.0918367346938775,2.9693877551020407,2.8469387755102038,2.7244897959183669,2.6020408163265305,2.4795918367346936,2.3571428571428568,2.2346938775510203,2.1122448979591839,1.9897959183673466,1.8673469387755099,1.7448979591836733,1.6224489795918369,1.5000000000000002,1.3775510204081631,1.2551020408163265,1.1326530612244898,1.0102040816326527,0.88775510204081609,0.76530612244897955,0.64285714285714302,0.52040816326530637,0.39795918367346927,0.27551020408163263,0.15306122448979598,0.030612244897958885,-0.091836734693877764,-0.21428571428571441,-0.33673469387755084,-0.45918367346938771,-0.58163265306122414,-0.7040816326530619,-0.82653061224489832,-0.94897959183673519,-1.0714285714285716,-1.193877551020408,-1.3163265306122449],[4.7857142857142856,4.6632653061224492,4.5408163265306118,4.4183673469387745,4.295918367346939,4.1734693877551017,4.0510204081632653,3.9285714285714284,3.8061224489795915,3.6836734693877551,3.5612244897959182,3.4387755102040813,3.3163265306122449,3.193877551020408,3.0714285714285712,2.9489795918367343,2.8265306122448974,2.704081632653061,2.5816326530612241,2.4591836734693873,2.3367346938775508,2.2142857142857144,2.0918367346938771,1.9693877551020404,1.8469387755102038,1.7244897959183674,1.6020408163265307,1.4795918367346936,1.357142857142857,1.2346938775510203,1.1122448979591832,0.98979591836734659,0.86734693877551006,0.74489795918367352,0.62244897959183687,0.49999999999999978,0.37755102040816313,0.25510204081632648,0.13265306122448939,0.010204081632652739,-0.11224489795918391,-0.23469387755102034,-0.35714285714285721,-0.47959183673469363,-0.60204081632653139,-0.72448979591836782,-0.84693877551020469,-0.96938775510204112,-1.0918367346938775,-1.2142857142857144],[4.8877551020408161,4.7653061224489797,4.6428571428571423,4.520408163265305,4.3979591836734695,4.2755102040816322,4.1530612244897958,4.0306122448979593,3.908163265306122,3.7857142857142856,3.6632653061224487,3.5408163265306118,3.4183673469387754,3.2959183673469385,3.1734693877551017,3.0510204081632648,2.9285714285714279,2.8061224489795915,2.6836734693877546,2.5612244897959178,2.4387755102040813,2.3163265306122449,2.1938775510204076,2.0714285714285712,1.9489795918367343,1.8265306122448979,1.7040816326530612,1.5816326530612241,1.4591836734693875,1.3367346938775508,1.2142857142857137,1.0918367346938771,0.96938775510204056,0.84693877551020402,0.72448979591836737,0.60204081632653028,0.47959183673469363,0.35714285714285698,0.23469387755101989,0.11224489795918324,-0.010204081632653406,-0.13265306122448983,-0.2551020408163267,-0.37755102040816313,-0.50000000000000089,-0.62244897959183731,-0.74489795918367419,-0.86734693877551061,-0.98979591836734704,-1.1122448979591839],[4.9897959183673475,4.8673469387755102,4.7448979591836746,4.6224489795918373,4.5,4.3775510204081645,4.2551020408163271,4.1326530612244898,4.0102040816326534,3.887755102040817,3.7653061224489801,3.6428571428571432,3.5204081632653068,3.3979591836734699,3.2755102040816331,3.1530612244897962,3.0306122448979593,2.9081632653061229,2.785714285714286,2.6632653061224492,2.5408163265306127,2.4183673469387763,2.295918367346939,2.1734693877551026,2.0510204081632657,1.9285714285714293,1.8061224489795926,1.6836734693877555,1.5612244897959189,1.4387755102040822,1.3163265306122451,1.1938775510204085,1.0714285714285721,0.94897959183673541,0.82653061224489877,0.70408163265306167,0.58163265306122502,0.45918367346938838,0.33673469387755128,0.21428571428571463,0.091836734693877986,-0.030612244897958441,-0.15306122448979531,-0.27551020408163174,-0.3979591836734695,-0.52040816326530592,-0.64285714285714279,-0.76530612244897922,-0.88775510204081565,-1.0102040816326525],[5.091836734693878,4.9693877551020407,4.8469387755102051,4.7244897959183678,4.6020408163265305,4.479591836734695,4.3571428571428577,4.2346938775510203,4.1122448979591839,3.9897959183673475,3.8673469387755106,3.7448979591836737,3.6224489795918373,3.5000000000000004,3.3775510204081636,3.2551020408163267,3.1326530612244898,3.0102040816326534,2.8877551020408165,2.7653061224489797,2.6428571428571432,2.5204081632653068,2.3979591836734695,2.2755102040816331,2.1530612244897962,2.0306122448979598,1.9081632653061231,1.785714285714286,1.6632653061224494,1.5408163265306127,1.4183673469387756,1.295918367346939,1.1734693877551026,1.0510204081632659,0.92857142857142927,0.80612244897959218,0.68367346938775553,0.56122448979591888,0.43877551020408179,0.31632653061224514,0.19387755102040849,0.071428571428572063,-0.051020408163264808,-0.17346938775510123,-0.29591836734693899,-0.41836734693877542,-0.54081632653061229,-0.66326530612244872,-0.78571428571428514,-0.90816326530612201],[5.1938775510204085,5.0714285714285712,4.9489795918367356,4.8265306122448983,4.704081632653061,4.5816326530612255,4.4591836734693882,4.3367346938775508,4.2142857142857144,4.091836734693878,3.9693877551020411,3.8469387755102042,3.7244897959183678,3.6020408163265309,3.4795918367346941,3.3571428571428572,3.2346938775510203,3.1122448979591839,2.989795918367347,2.8673469387755102,2.7448979591836737,2.6224489795918373,2.5,2.3775510204081636,2.2551020408163267,2.1326530612244903,2.0102040816326534,1.8877551020408165,1.7653061224489799,1.6428571428571432,1.5204081632653061,1.3979591836734695,1.2755102040816331,1.1530612244897964,1.0306122448979598,0.90816326530612268,0.78571428571428603,0.66326530612244938,0.54081632653061229,0.41836734693877564,0.29591836734693899,0.17346938775510257,0.051020408163265696,-0.071428571428570731,-0.19387755102040849,-0.31632653061224492,-0.43877551020408179,-0.56122448979591821,-0.68367346938775464,-0.80612244897959151],[5.295918367346939,5.1734693877551017,5.0510204081632661,4.9285714285714288,4.8061224489795915,4.683673469387756,4.5612244897959187,4.4387755102040813,4.3163265306122449,4.1938775510204085,4.0714285714285712,3.9489795918367347,3.8265306122448983,3.7040816326530615,3.5816326530612246,3.4591836734693877,3.3367346938775508,3.2142857142857144,3.0918367346938775,2.9693877551020407,2.8469387755102042,2.7244897959183678,2.6020408163265305,2.4795918367346941,2.3571428571428572,2.2346938775510208,2.1122448979591839,1.989795918367347,1.8673469387755104,1.7448979591836737,1.6224489795918366,1.5,1.3775510204081636,1.2551020408163269,1.1326530612244903,1.0102040816326532,0.88775510204081653,0.76530612244897989,0.64285714285714279,0.52040816326530615,0.3979591836734695,0.27551020408163307,0.1530612244897962,0.030612244897959773,-0.091836734693877986,-0.21428571428571441,-0.33673469387755128,-0.45918367346938771,-0.58163265306122414,-0.70408163265306101],[5.3979591836734695,5.2755102040816322,5.1530612244897966,5.0306122448979593,4.908163265306122,4.7857142857142865,4.6632653061224492,4.5408163265306118,4.4183673469387754,4.295918367346939,4.1734693877551017,4.0510204081632653,3.9285714285714288,3.806122448979592,3.6836734693877551,3.5612244897959182,3.4387755102040813,3.3163265306122449,3.193877551020408,3.0714285714285712,2.9489795918367347,2.8265306122448983,2.704081632653061,2.5816326530612246,2.4591836734693877,2.3367346938775513,2.2142857142857144,2.0918367346938775,1.9693877551020409,1.8469387755102042,1.7244897959183672,1.6020408163265305,1.4795918367346941,1.3571428571428574,1.2346938775510208,1.1122448979591837,0.98979591836734704,0.86734693877551039,0.7448979591836733,0.62244897959183665,0.5,0.37755102040816357,0.2551020408163267,0.13265306122449028,0.010204081632652517,-0.11224489795918391,-0.23469387755102078,-0.35714285714285721,-0.47959183673469363,-0.6020408163265305],[5.5,5.3775510204081627,5.2551020408163271,5.1326530612244898,5.0102040816326525,4.887755102040817,4.7653061224489797,4.6428571428571423,4.5204081632653059,4.3979591836734695,4.2755102040816322,4.1530612244897958,4.0306122448979593,3.9081632653061225,3.7857142857142856,3.6632653061224487,3.5408163265306118,3.4183673469387754,3.2959183673469385,3.1734693877551017,3.0510204081632653,2.9285714285714288,2.8061224489795915,2.6836734693877551,2.5612244897959182,2.4387755102040818,2.3163265306122449,2.193877551020408,2.0714285714285712,1.9489795918367347,1.8265306122448977,1.704081632653061,1.5816326530612246,1.4591836734693879,1.3367346938775513,1.2142857142857142,1.0918367346938775,0.96938775510204089,0.8469387755102038,0.72448979591836715,0.6020408163265305,0.47959183673469408,0.35714285714285721,0.23469387755102078,0.11224489795918302,-0.010204081632653406,-0.13265306122449028,-0.2551020408163267,-0.37755102040816313,-0.5]],"type":"surface","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>Let’s write the equation for the blood pressure data:</p>
<p><span class="math display">\[bp_i = \beta_0 + \beta_1 \cdot age_i + \beta_2 \cdot mins\_exercise_i + \epsilon_i\]</span></p>
<p>where:</p>
<ul>
<li><span class="math inline">\(bp_i\)</span> is the blood pressure for the <span class="math inline">\(i\)</span>th observation</li>
<li><span class="math inline">\(age_i\)</span> is the age for the <span class="math inline">\(i\)</span>th observation</li>
<li><span class="math inline">\(mins\_exercise_i\)</span> is the minutes of exercise for the <span class="math inline">\(i\)</span>th observation</li>
<li><span class="math inline">\(\beta_0\)</span> is the intercept</li>
<li><span class="math inline">\(\beta_1\)</span> is the slope for age</li>
<li><span class="math inline">\(\beta_2\)</span> is the slope for minutes of exercise</li>
<li><span class="math inline">\(\epsilon_i\)</span> is the error term</li>
</ul>
<p>and the error term is assumed to be normally distributed with mean 0 and constant variance, just as was the case for simple linear regression:</p>
<p><span class="math display">\[\epsilon_i \sim N(0, \sigma^2)\]</span></p>
<p><strong>Seventh</strong>, we know how to make predictions using the model, and to make a prediction band.</p>
<p><strong>What we don’t know</strong> is how to answer the four questions already mentioned above:</p>
<ul>
<li>Question 1: As an ensemble (i.e., all together), are the explanatory variables “useful”?</li>
<li>Question 2: Are each of the explanatory variables associated with the response?</li>
<li>Question 3: What proportion of variability is explained?</li>
<li>Question 4: Are some explanatory variables more important than others?</li>
</ul>
<p>Let’s answer these questions using the blood pressure example.</p>
</section>
<section id="fitting-the-model" class="level3">
<h3 class="anchored" data-anchor-id="fitting-the-model">Fitting the model</h3>
<p>We know how to estimate the parameters <span class="math inline">\(\beta_0, \beta_1, \ldots, \beta_p\)</span> using the method of least squares.</p>
<p>In R, we can fit a multiple linear regression model using the <code>lm()</code> function in a very similar way to the simple linear regression model. Here is the code for the blood pressure example. To fit two explanatory variables, we simply add the second variable to the formula using the <code>+</code> sign:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(bp <span class="sc">~</span> age <span class="sc">+</span> mins_exercise, <span class="at">data =</span> bp_data_multreg)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="checking-the-assumptions" class="level3">
<h3 class="anchored" data-anchor-id="checking-the-assumptions">Checking the assumptions</h3>
<p>Great news –&gt; the five assumptions of the multiple linear regression model are the same as for the simple linear regression model:</p>
<ol type="a">
<li>Normality of residuals.</li>
<li>Homoscedasticity = constant variance of residuals.</li>
<li>Independence of residuals.</li>
<li>Linearity.</li>
<li>No outliers.</li>
</ol>
<p><strong>Think-Pair-Share</strong> (#tps-assump-match) Review how we can check these assumptions in the simple linear regression model. Match the following to the assumptions above:</p>
<ol type="1">
<li>Graph of size of residuals vs.&nbsp;fitted values.</li>
<li>QQ-plot.</li>
<li>Graph of residuals vs.&nbsp;fitted values.</li>
<li>Graph of leverage vs.&nbsp;standardized residuals.</li>
</ol>
<p>And what is missing?</p>
<p>We can check the assumptions of the multiple linear regression model using the same methods as for the simple linear regression model. Here is the code for the blood pressure example:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check the assumptions</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(m1, <span class="at">which =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">5</span>), <span class="at">add.smooth =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="6.1-multiple-regression_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="432"></p>
</figure>
</div>
</div>
</div>
<p>We see that the assumptions are met for the blood pressure example:</p>
<ol type="a">
<li>Normality of residuals: The QQ-plot shows that the residuals are normally distributed.</li>
<li>Homoscedasticity: The scale-location plot shows that the residuals have constant variance.</li>
<li>Independence of residuals: No evidence of pattern or clustering. But also need to know about study design to properly assess independence.</li>
<li>Linearity: The residuals vs.&nbsp;fitted values plot shows no clear pattern in the residuals.</li>
<li>No outliers: No points with high leverage or high residuals.</li>
</ol>
</section>
</section>
<section id="question-1-as-an-ensemble-are-the-explanatory-variables-useful" class="level2">
<h2 class="anchored" data-anchor-id="question-1-as-an-ensemble-are-the-explanatory-variables-useful">Question 1: As an ensemble, are the explanatory variables useful?</h2>
<p>Recall that when we learned about ANOVA we saw that a single categorical explanatory variable with multiple levels can be represented as multiple binary (0/1) explanatory variables. In that case, we used the <span class="math inline">\(F\)</span>-test to test the null hypothesis of no effect / relationship for all binary variables together.</p>
<p>Likewise, when we have multiple continuous explanatory variables, we use the <span class="math inline">\(F\)</span>-test to test the null hypothesis that <strong>together</strong> the explanatory variables have no association with the response variable. That is, we use the <span class="math inline">\(F\)</span>-test to test the null hypothesis that the ensemble of explanatory variables is not associated with the response variable.</p>
<p>This corresponds to the same null hypothesis as we used in one-way ANOVA: The null hypothesis that the explained variance of the model is no greater than would be expected by chance. Here, “by chance” means that the slopes of the explanatory variables are zero:</p>
<p><span class="math display">\[H_0: \beta_1 = \beta_2 = \ldots = \beta_p = 0\]</span></p>
<p>And the alternative hypothesis (just as in one-way ANOVA) is that the explained variance of the model is greater than would be expected by chance. This would occur if the slopes of some or all of the explanatory variables are not zero:</p>
<p><span class="math display">\[H_1: \beta_1 \neq 0 \text{ or } \beta_2 \neq 0 \text{ or } \ldots \text{ or } \beta_p \neq 0\]</span></p>
<p>Recall that the <span class="math inline">\(F\)</span>-test compares the variance explained by the model to the variance not explained by the model (i.e., the variance of the residuals). If the variance explained by the model is significantly greater than the variance not explained by the model, then we can conclude that the explanatory variables are associated with the response variable.</p>
<p>If we reject the null hypothesis, we can conclude that some combination of the explanatory variables is associated with the response variable. However, we cannot conclude which specific explanatory variables are associated with the response variable. To determine which specific explanatory variables are associated with the response variable, we need to perform individual <span class="math inline">\(t\)</span>-tests for each explanatory variable. We will do this in the next section.</p>
<p>OK, back to the <span class="math inline">\(F\)</span>-test.</p>
<p>We know a lot already from the ANOVA chapter. Let’s review how we calculate the <span class="math inline">\(F\)</span>-statistic.</p>
<p>The <span class="math inline">\(F\)</span>-statistic is calculated as the ratio of two mean squares:</p>
<ol type="1">
<li>The mean square of the model (<span class="math inline">\(MSE_{model}\)</span>).</li>
<li>The mean square of the residuals (<span class="math inline">\(MSE_{residual}\)</span>).</li>
</ol>
<p>Recall that a mean square is a sum of squares divided by the associated degrees of freedom. The formulas for these are the same as for ANOVA.</p>
<p>So, to calculate these two mean squares, we need to calculate three sums of squares:</p>
<ol type="1">
<li>The total sum of squares (<span class="math inline">\(SST\)</span>).</li>
<li>The sum of squares of the model (<span class="math inline">\(SSM\)</span>).</li>
<li>The sum of squares of the residuals (<span class="math inline">\(SSE\)</span>).</li>
</ol>
<p>We also need to calculate the degrees of freedom associated with each sum of squares.</p>
<ol type="1">
<li>The total degrees of freedom is <span class="math inline">\(n-1\)</span>, where <span class="math inline">\(n\)</span> is the number of observations.</li>
<li>The model degrees of freedom is <span class="math inline">\(p\)</span>, where <span class="math inline">\(p\)</span> is the number of explanatory variables. This is because for each explanatory variable we estimate one parameter (the slope), and each estimated parameter uses up one degree of freedom.</li>
<li>The residual degrees of freedom is <span class="math inline">\(n-1-p\)</span>.</li>
</ol>
<section id="the-f-statistic-in-r" class="level3">
<h3 class="anchored" data-anchor-id="the-f-statistic-in-r">The F-statistic in R</h3>
<p>We could do all these calculations ourselves (and you might be asked to in the exam), but also we can just ask R! For question 1 we need to know the <span class="math inline">\(F\)</span>-statistic for the multiple linear regression model. We can easily get this from R using the <code>summary()</code> function, and by looking in the right place in the output:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = bp ~ age + mins_exercise, data = bp_data_multreg)

Residuals:
     Min       1Q   Median       3Q      Max 
-21.6681  -5.9165   0.3098   5.7818  23.5240 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   90.81311    3.98484  22.790  &lt; 2e-16 ***
age            0.53893    0.06102   8.832 4.45e-14 ***
mins_exercise -0.10387    0.01107  -9.380 2.93e-15 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 9.376 on 97 degrees of freedom
Multiple R-squared:   0.72, Adjusted R-squared:  0.7142 
F-statistic: 124.7 on 2 and 97 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>In the final line of output we see “F-statistic: 124.7 on 2 and 97 DF, p-value: 1.55^{-27}”.</p>
<p>The model degrees of freedom is 2 (because we have two explanatory variables), and the residual degrees of freedom is 97 (because we have 100 observations and 2 explanatory variables, so <span class="math inline">\(100 - 1 - 2 = 97\)</span>).</p>
<p>So the <code>summary()</code> function gives us everything we need to answer question 1. It even gives us the <span class="math inline">\(p\)</span>-value for the <span class="math inline">\(F\)</span>-test.</p>
<p><strong>How to report the result</strong>. We could write somthing like this: “The combination of age and minutes of exercise is significantly associated with blood pressure (F(2, 97) = 124.7, p = 1.55^{-27}).” Note that this is rather an undesirable statement, because it focuses too much on the statistics and not enough on the science. Indeed, perhaps we care more about the association of each explanatory variable with blood pressure, which we will look at next.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>If you want to review how to calculate a p-value from an F-statistic, see the corresponding section of the one-way ANOVA chapter.</p>
</div>
</div>
</section>
</section>
<section id="question-2-which-variables-are-associated-with-the-response" class="level2">
<h2 class="anchored" data-anchor-id="question-2-which-variables-are-associated-with-the-response">Question 2: Which variables are associated with the response?</h2>
<p>As we did for simple linear regression, we can perform a <span class="math inline">\(t\)</span>-test for one explanatory variable to determine if it is associated with the response. And we can do this for each of the explanatory variables. As before, the null hypothesis for each <span class="math inline">\(t\)</span>-test is that the slope of the explanatory variable is zero. The alternative hypothesis is that the slope of the explanatory variable is not zero.</p>
<p>Here is the coefficients table, which includes the results of the <span class="math inline">\(t\)</span>-tests for each explanatory variable:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m1)<span class="sc">$</span>coef</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                Estimate Std. Error   t value     Pr(&gt;|t|)
(Intercept)   90.8131109 3.98484209 22.789639 9.885524e-41
age            0.5389268 0.06102163  8.831733 4.454019e-14
mins_exercise -0.1038729 0.01107426 -9.379670 2.932092e-15</code></pre>
</div>
</div>
<p>And we can get the 95% CI for each slope estimate <span class="math inline">\(\hat\beta_j\)</span> as follows:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(m1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                   2.5 %     97.5 %
(Intercept)   82.9043024 98.7219194
age            0.4178157  0.6600378
mins_exercise -0.1258523 -0.0818936</code></pre>
</div>
</div>
<p>Reminder: The 95% confidence interval is <span class="math inline">\([\hat\beta - c \cdot \sigma^{(\beta)} ; \hat\beta + c \cdot \sigma^{(\beta)}]\)</span>, where <span class="math inline">\(c\)</span> is the 97.5% quantile of the <span class="math inline">\(t\)</span>-distribution with <span class="math inline">\(n-p\)</span> degrees of freedom).</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>However</strong> Please insert a note into your brain that we are dealing here with an ideal case of <strong>uncorrelated explanatory variables</strong>. You’ll learn later in the course about what happens when explanatory variables are correlated. Hint: interpretation is difficult and unstable!</p>
</div>
</div>
<p><strong>Think–Pair–Share (#a_partial_effects)</strong> What does “holding other variables constant” mean here? Is this always biologically plausible?</p>
</section>
<section id="question-3-what-proportion-of-variability-is-explained" class="level2">
<h2 class="anchored" data-anchor-id="question-3-what-proportion-of-variability-is-explained">Question 3: What proportion of variability is explained?</h2>
<section id="multiple-r2" class="level3">
<h3 class="anchored" data-anchor-id="multiple-r2">Multiple <span class="math inline">\(R^2\)</span></h3>
<p>We can calculate the <span class="math inline">\(R^2\)</span> value for the multiple linear regression model just like we already did for a simple linear regression model. The <span class="math inline">\(R^2\)</span> value is the proportion of variability in the response variable that is explained by the model. As before, the <span class="math inline">\(R^2\)</span> value ranges from 0 to 1, where 0 indicates that the model does not explain any variability in the response variable, and 1 indicates that the model explains all the variability in the response variable.</p>
<p>For multiple linear regression, we often use the term “multiple <span class="math inline">\(R^2\)</span>” to distinguish it from the <span class="math inline">\(R^2\)</span> value for simple linear regression. The multiple <span class="math inline">\(R^2\)</span> is the proportion of variability in the response variable that is explained by the model, taking into account all the explanatory variables in the model.</p>
<p>As before, for simple linear regression, the multiple <span class="math inline">\(R^2\)</span> value is calculated as the sum of squares explained by the model divided by the total sum of squares:</p>
<p><span class="math display">\[R^2 = \frac{SSM}{SST}\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>sss <span class="ot">&lt;-</span> <span class="fu">anova</span>(m1)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>SSM <span class="ot">&lt;-</span> sss<span class="sc">$</span><span class="st">`</span><span class="at">Sum Sq</span><span class="st">`</span>[<span class="dv">1</span>] <span class="sc">+</span> sss<span class="sc">$</span><span class="st">`</span><span class="at">Sum Sq</span><span class="st">`</span>[<span class="dv">2</span>]</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>SST <span class="ot">&lt;-</span> <span class="fu">sum</span>(sss<span class="sc">$</span><span class="st">`</span><span class="at">Sum Sq</span><span class="st">`</span>)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>R_squared <span class="ot">&lt;-</span> SSM <span class="sc">/</span> SST</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="co">#R_squared</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>where <span class="math inline">\(SSM\)</span> is the sum of squares explained by the model and <span class="math inline">\(SST\)</span> is the total sum of squares, and <span class="math inline">\(SSM = SST - SSE\)</span>.</p>
<p>For the blood pressure data:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m1)<span class="sc">$</span>r.squared</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.7199706</code></pre>
</div>
</div>
<p><span class="math inline">\(R^2\)</span> for multiple linear regression can also be calculated as the squared correlation between <span class="math inline">\((y_1,\ldots,y_n)\)</span> and <span class="math inline">\((\hat{y}_1,\ldots,\hat{y}_n)\)</span>, where the <span class="math inline">\(\hat y\)</span> are the fitted values from the model. The fitted values are calculated as:</p>
<p><span class="math display">\[\hat{y}_i = \hat\beta_0 + \hat\beta_1 x^{(1)} + \ldots + \hat\beta_m x^{(m)}\]</span></p>
<p>In R:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>r_squared <span class="ot">&lt;-</span> <span class="fu">cor</span>(m1<span class="sc">$</span>fitted.values, bp_data_multreg<span class="sc">$</span>bp)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>r_squared</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.7199706</code></pre>
</div>
</div>
<p>Or:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>sss <span class="ot">&lt;-</span> <span class="fu">anova</span>(m1)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>SSM <span class="ot">&lt;-</span> sss<span class="sc">$</span><span class="st">`</span><span class="at">Sum Sq</span><span class="st">`</span>[<span class="dv">1</span>] <span class="sc">+</span> sss<span class="sc">$</span><span class="st">`</span><span class="at">Sum Sq</span><span class="st">`</span>[<span class="dv">2</span>]</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>SST <span class="ot">&lt;-</span> <span class="fu">sum</span>(sss<span class="sc">$</span><span class="st">`</span><span class="at">Sum Sq</span><span class="st">`</span>)</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>R_squared <span class="ot">&lt;-</span> SSM <span class="sc">/</span> SST</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>R_squared</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.7199706</code></pre>
</div>
</div>
</section>
<section id="adjusted-r2" class="level3">
<h3 class="anchored" data-anchor-id="adjusted-r2">Adjusted <span class="math inline">\(R^2\)</span></h3>
<p>However, we have a little problem to address. The <span class="math inline">\(R^2\)</span> value increases as we add more explanatory variables to the model, even if the additional variables are not associated with the response. This is because the <span class="math inline">\(R^2\)</span> value is calculated as the proportion of variability in the response variable that is explained by the model. As we add more explanatory variables to the model, the model will always explain more variability in the response variable, even if the additional variables are not associated with the response. Some of the variance will be explained by chance.</p>
<p>Here is an example of this problem. First, here’s the explanatory power of the model with only age and minutes of exercise as the explanatory variables:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(bp <span class="sc">~</span> age <span class="sc">+</span> mins_exercise, <span class="at">data =</span> bp_data_multreg)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m1)<span class="sc">$</span>r.squared</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.7199706</code></pre>
</div>
</div>
<p>Now, we can add a new explanatory variable to the blood pressure model that is not associated with the response:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>bp_data_multreg<span class="sc">$</span>random_variable <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="fu">nrow</span>(bp_data_multreg))</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>m2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(bp <span class="sc">~</span> age <span class="sc">+</span> mins_exercise <span class="sc">+</span> random_variable, <span class="at">data =</span> bp_data_multreg)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m2)<span class="sc">$</span>r.squared</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.7272101</code></pre>
</div>
</div>
<p>The <span class="math inline">\(R^2\)</span> value for the model with the random variable is higher than the <span class="math inline">\(R^2\)</span> value for the model without the random variable. This is because the model with the random variable explains more variability in the response variable, even though the random variable is not associated with the response.</p>
<p>To address this problem, we can use the adjusted <span class="math inline">\(R^2\)</span> value. The adjusted <span class="math inline">\(R^2\)</span> value is calculated as:</p>
<p><span class="math display">\[R^2_{\text{adj}} = 1 - \frac{SSE / (n - p - 1)}{SST / (n - 1)}\]</span></p>
<p>where * <span class="math inline">\(SSE\)</span> is the sum of squared errors * <span class="math inline">\(SST\)</span> is the total sum of squares * <span class="math inline">\(n\)</span> is the number of observations * <span class="math inline">\(p\)</span> is the number of explanatory variables in the model.</p>
<p>Or put another way:</p>
<p><span class="math display">\[R^2_{adj} = 1-(1-R^2 )\frac{n-1}{n-p-1}\]</span> In this form, we can see that as <span class="math inline">\(p\)</span> increases (as we add explanatory variables) the term <span class="math inline">\((n-1)/(n-p-1)\)</span> increases, and the adjusted <span class="math inline">\(R^2\)</span> value will decrease if the additional variables are not associated with the response.</p>
<p>Take home: when we want to compare the explanatory power of models that differ in the number of explanatory variables, we should use the adjusted <span class="math inline">\(R^2\)</span> value.</p>
</section>
</section>
<section id="question-4-are-some-explanatory-variables-more-important-than-others" class="level2">
<h2 class="anchored" data-anchor-id="question-4-are-some-explanatory-variables-more-important-than-others">Question 4: Are some explanatory variables more important than others?</h2>
<p>We know how to test the significance of the parameters using the <span class="math inline">\(t\)</span>-test. We also know how to calculate the confidence intervals for the parameters, and to make a confidence band.</p>
<p>How important are the explanatory variables and how important are they relative to each other?</p>
<p><strong>Think-Pair-Share</strong> (#tps-variable-importance) How might we assess how important is each of the explanatory variables, and how important they are relative to each other?</p>
<p>The importance of an explanatory variable can be assessed by looking at the size of the coefficient for that variable. The larger the coefficient, the more important the variable is in explaining the response variable.</p>
<p>It is, however, important to remember that the size of the coefficient depends on the scale of the explanatory variable. If the explanatory variables are on different scales, then the coefficients will be on different scales and cannot be directly compared.</p>
<p>In our example, the age variable is measured in years, so the coefficient is in units mmHg (pressure) per year. The mins_exercise variable is measured in minutes, so the coefficient is in units mmHg per minute. The coefficients are on different scales and cannot be directly compared. Furthermore, the value of the coefficients would change if we measured age in months or minutes of exercise in hours.</p>
<p>There are other perspectives we can take when we’re assessing importance. For example, we cannot change our age, but we can change the number of minutes of exercise. So, the practical importance of the two variables is quite different in that sense also.</p>
<p>To compare the importance of the explanatory variables that are measured on different scales, we can standardize the variables before fitting the model. This means that we subtract the mean of the variable and divide by the standard deviation. This puts all the variables on the same scale, so the coefficients can be directly compared. The coefficients are then in units of the response variable per standard deviation of the explanatory variable.</p>
<p>However, the coefficients are then not in the original units of the explanatory variables, so it is not always easy to interpret the coefficients. So while we can compare the coefficients, they have lost a bit of their original meaning and are not so easy to interpret.</p>
<p>One way to relate the coefficients in this case is to realise that to compensate for the blood pressure increase associated with one year of age, one would need to exercise for a certain number of minutes more.</p>
<p><strong>Think-Pair-Share</strong> (#tps-exercise-age) How many minutes of exercise per week would we need to add to our fitness schedule to compensate for the blood pressure increase associated with one year of age?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>extra_mins_exercise <span class="ot">&lt;-</span> <span class="fu">coef</span>(m1)[<span class="st">"age"</span>] <span class="sc">/</span> <span class="sc">-</span><span class="fu">coef</span>(m1)[<span class="st">"mins_exercise"</span>]</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="co">#extra_mins_exercise</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="question-5-how-do-we-make-predictions" class="level2">
<h2 class="anchored" data-anchor-id="question-5-how-do-we-make-predictions">Question 5: How do we make predictions?</h2>
<p>We already made predictions from a simple linear regression model?</p>
<p>Recall that the equation for multiple linear regression is:</p>
<p><span class="math display">\[y_i = \beta_0 + \beta_1 x_i^{(1)} + \beta_2 x_i^{(2)} + \ldots + \beta_p x_i^{(p)} + \epsilon_i\]</span></p>
<p>Therefore to get a predicted value of <span class="math inline">\(y_i\)</span>, we can use the estimated parameters (<span class="math inline">\(\hat\beta_0, \hat\beta_1, \ldots, \hat\beta_p\)</span>) and the values of the explanatory variables (<span class="math inline">\(x_i^{(1)}, x_i^{(2)}, \ldots, x_i^{(p)}\)</span>):</p>
<p><span class="math display">\[\hat{y}_i = \hat\beta_0 + \hat\beta_1 x_i^{(1)} + \hat\beta_2 x_i^{(2)} + \ldots + \hat\beta_p x_i^{(p)}\]</span></p>
<p>In R, we can use the <code>predict()</code> function to make predictions from a multiple linear regression model. Here is an example of how to make predictions for the values of the explanatory variables in the original dataset:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(m1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Where <code>m1</code> is the multiple linear regression model fitted earlier. The <code>predict</code> function automatically uses the original data because we did not provide any new data.</p>
<p>We can also make predictions for new values of the explanatory variables by providing a new data frame to the <code>predict()</code> function. Here is an example of how to make predictions for new values of age and minutes of exercise:</p>
<p>First we need to make some new values of age and minutes of exercise:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>new_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">age =</span> <span class="fu">c</span>(<span class="dv">30</span>, <span class="dv">40</span>, <span class="dv">50</span>),</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>                       <span class="at">mins_exercise =</span> <span class="fu">c</span>(<span class="dv">50</span>, <span class="dv">100</span>, <span class="dv">150</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Then we can use the <code>predict()</code> function to make predictions for these new values:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>new_predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(m1, <span class="at">newdata =</span> new_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p>The new data frame must have the all the explanatory variables used in the model, and the variable names must match exactly those used in the model.</p>
</div>
</div>
<p>We can take this to the next level and make what is called a “conditional effects plot” or “effect plot”. This is a plot that shows the predicted values of the response variable for different values of one explanatory variable, while holding the other explanatory variables constant. Here is an example of how to make a conditional effects plot for age, while holding minutes of exercise constant at 100:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>new_data_effects <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">age =</span> <span class="fu">seq</span>(<span class="dv">20</span>, <span class="dv">80</span>, <span class="at">by =</span> <span class="dv">1</span>),</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>                                <span class="at">mins_exercise =</span> <span class="dv">100</span>)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>new_data_effects <span class="ot">&lt;-</span> new_data_effects <span class="sc">|&gt;</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">new_predictions_effects =</span> <span class="fu">predict</span>(m1, <span class="at">newdata =</span> new_data_effects))</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> new_data_effects, <span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">y =</span> new_predictions_effects)) <span class="sc">+</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Age"</span>, <span class="at">y =</span> <span class="st">"Predicted blood pressure"</span>) <span class="sc">+</span></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Conditional effects plot for</span><span class="sc">\n</span><span class="st">age (mins_exercise = 100)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="6.1-multiple-regression_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid figure-img" width="432"></p>
</figure>
</div>
</div>
</div>
<p>And lets take this to the next level again and make a conditional effects plot for three different levels of <code>mins_exercise</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>new_data_effects_3 <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">age =</span> <span class="fu">seq</span>(<span class="dv">20</span>, <span class="dv">80</span>, <span class="at">by =</span> <span class="dv">1</span>),</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">mins_exercise =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">150</span>, <span class="dv">300</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>A new function! And it’s one of Owen’s favourites: <code>expand.grid()</code>. This function creates a data frame from all combinations of the supplied vectors or factors. Here, we are creating a data frame with all combinations of age (from 20 to 80) and minutes of exercise (0, 150, and 300).</p>
<p>We then give the new data frame to the <code>predict()</code> function to get the predicted values for each combination of age and minutes of exercise:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>new_data_effects_3 <span class="ot">&lt;-</span> new_data_effects_3 <span class="sc">|&gt;</span> </span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">prediction =</span> <span class="fu">predict</span>(m1, <span class="at">newdata =</span> new_data_effects_3),</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">mins_exercise_fac =</span> <span class="fu">as.factor</span>(mins_exercise)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>(Note that we changed)</p>
<p>And make a graph:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> new_data_effects_3, <span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">y =</span> prediction,</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>                                             <span class="at">col =</span> mins_exercise_fac)) <span class="sc">+</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Age"</span>, <span class="at">y =</span> <span class="st">"Predicted blood pressure"</span>, <span class="at">color =</span> <span class="st">"Minutes</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a><span class="st"> of exercise"</span>) <span class="sc">+</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Conditional effects plot for age</span><span class="sc">\n</span><span class="st">at three levels of minutes of exercise"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="6.1-multiple-regression_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid figure-img" width="432"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="collinearity" class="level2">
<h2 class="anchored" data-anchor-id="collinearity">Collinearity</h2>
<p>In the blood pressure example data used previously in this chapter there is no evidence of correlation between the two explanatory variables. However, in practice, it is common for explanatory variables to be correlated with each other. This is known as collinearity. It can be quite problematic for us!</p>
<p><strong>Think-Pair-Share</strong> (#tps-collinearity1) Imagine if there was perfect correlation between age and minutes of exercise. This would mean that a graph of age vs minutes of exercise would show a perfect line. What would be the implications for the multiple linear regression model? For example, what would be the <span class="math inline">\(R^2\)</span> value for a model with one explanatory variable compared to a model with both explanatory variables?</p>
<p>Collinearity, specifically <em>harmful</em> collinearity, is extremely common in real dataset that result from observational studies. This is because in observational studies there are often numerous explanatory variables, and they are often correlated with each other. This is a situation that is ripe for collinearity problems. (Collinearity can also happen in data resulting from designed manipulative experiments, but is hopefully relatively rare there because a well-designed experiment will try to avoid collinearity by ensuring that the explanatory variables are independent.)</p>
<p>So what is collinearity, and why is it a problem?</p>
<p><strong><em>Put simply, collinearity is when one explanatory variable is predictable from a linear combination of others.</em></strong></p>
<p>This can happen due to strong correlation among pairs of explanatory variables, or due to more complex relationships involving three or more explanatory variables.</p>
<p>For example, if we have three explanatory variables, <span class="math inline">\(x_1, x_2,\)</span> and <span class="math inline">\(x_3\)</span>, and if <span class="math inline">\(x_3\)</span> can be predicted from a linear combination of <span class="math inline">\(x_1\)</span> and <span class="math inline">\(x_2\)</span>, then we have collinearity. For example, if:</p>
<p><span class="math display">\[x_3 = 2 \cdot x_1 + 3 \cdot x_2 + \text{small random noise}\]</span></p>
<p>In this case, variable <span class="math inline">\(x_3\)</span> is a linear combination of <span class="math inline">\(x_1\)</span> and <span class="math inline">\(x_2\)</span>, plus some small random noise. This means that if we know the values of <span class="math inline">\(x_1\)</span> and <span class="math inline">\(x_2\)</span>, we can predict the value of <span class="math inline">\(x_3\)</span> quite accurately. Also, in this case we might not have strong correlation between any pair of the explanatory variables, but there is still collinearity because <span class="math inline">\(x_3\)</span> is predictable from <span class="math inline">\(x_1\)</span> and <span class="math inline">\(x_2\)</span>. So lack of correlation between pairs of explanatory variables does not guarantee that there is no collinearity.</p>
<p><strong><em>It is a problem because it makes the slope estimates unstable and therefore difficult to interpret.</em></strong></p>
<p>Let us see this instability in practice. First let’s look at the really extreme example of perfect collinearity. Here’s a new version of the blood pressure data in which the minutes of exercise variable is perfectly predicted from age:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>age <span class="ot">&lt;-</span> <span class="fu">ceiling</span>(<span class="fu">runif</span>(n, <span class="dv">20</span>, <span class="dv">80</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Here is the line of code that makes the perfect correlation between age and minutes of exercise:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>mins_exercise <span class="ot">&lt;-</span> <span class="dv">100</span> <span class="sc">-</span> age</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now we generate the blood pressure variable as before:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>bp <span class="ot">&lt;-</span> <span class="dv">100</span> <span class="sc">+</span> <span class="fl">0.5</span> <span class="sc">*</span> age <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">15</span>)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>bp_data_perfect <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">age =</span> age,</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>                              <span class="at">mins_exercise =</span> mins_exercise,</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>                              <span class="at">bp =</span> bp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Read in the data:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>bp_data_perfect <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"datasets/bp_data_perfect.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 100 Columns: 3
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
dbl (3): age, mins_exercise, bp

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
</div>
<p>Now we fit a multiple linear regression model with only age:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>m1_age <span class="ot">&lt;-</span> <span class="fu">lm</span>(bp <span class="sc">~</span> age, <span class="at">data =</span> bp_data_perfect)</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m1_age)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = bp ~ age, data = bp_data_perfect)

Residuals:
    Min      1Q  Median      3Q     Max 
-33.546  -9.147  -0.327   8.938  33.213 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 100.43331    4.54751  22.085  &lt; 2e-16 ***
age           0.47541    0.08549   5.561 2.33e-07 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 14.54 on 98 degrees of freedom
Multiple R-squared:  0.2399,    Adjusted R-squared:  0.2321 
F-statistic: 30.92 on 1 and 98 DF,  p-value: 2.325e-07</code></pre>
</div>
</div>
<p>The estimated slope (coefficient) is 0.48, which is close to the true value of 0.5. The 95% confidence interval is 0.31 to 0.65, which includes the true value of 0.5. All good then.</p>
<p>Now we fit the multiple linear regression model with both age and minutes of exercise included:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>m1_both <span class="ot">&lt;-</span> <span class="fu">lm</span>(bp <span class="sc">~</span> mins_exercise <span class="sc">+</span> age, <span class="at">data =</span> bp_data_perfect)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m1_both)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = bp ~ mins_exercise + age, data = bp_data_perfect)

Residuals:
    Min      1Q  Median      3Q     Max 
-33.546  -9.147  -0.327   8.938  33.213 

Coefficients: (1 not defined because of singularities)
               Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   147.97398    4.48276  33.010  &lt; 2e-16 ***
mins_exercise  -0.47541    0.08549  -5.561 2.33e-07 ***
age                  NA         NA      NA       NA    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 14.54 on 98 degrees of freedom
Multiple R-squared:  0.2399,    Adjusted R-squared:  0.2321 
F-statistic: 30.92 on 1 and 98 DF,  p-value: 2.325e-07</code></pre>
</div>
</div>
<p>This output is a bit strange. The estimate for age is now <code>NA</code>. This is because the model cannot distinguish between the effects of age and minutes of exercise, since they are perfectly correlated. The model is unable to estimate the coefficient for age of exercise, so it returns <code>NA</code>.</p>
<p>This is an example of instability of coefficients due to collinearity. The coefficient for age is completely unstable, as it changes from a number to <code>NA</code> depending on whether minutes of exercise is included in the model or not.</p>
<p>Actually, you can see that the estimate for <code>mins_exercise</code> are the same (except the sign of the coefficient) as the estimate for age in the previous model. This is because minutes of exercise is perfectly correlated with age, so the model is essentially using minutes of exercise as a proxy for age. With perfect collinearity, the model cannot distinguish between the effects of the two variables… they are effectively identical.</p>
<p>You can also see that the <span class="math inline">\(R^2\)</span> value doesn’t change when the second variable is added. That is, the model with only age included is identical to the model with both age and minutes of exercise included. This is because minutes of exercise is perfectly correlated age, so including minutes of exercise in the model does not add any new information.</p>
<p>That is a pretty extreme example of perfect collinearity. In practice, collinearity is often not perfect, but still strong enough to cause problems.</p>
<p>Let’s look at the less extreme example of collinearity we had earlier, with three explanatory variables, <span class="math inline">\(x_1, x_2,\)</span> and <span class="math inline">\(x_3\)</span>, and where <span class="math inline">\(x_3\)</span> can be predicted from a linear combination of <span class="math inline">\(x_1\)</span> and <span class="math inline">\(x_2\)</span> plus some random noise:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>x3 <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> x1 <span class="sc">+</span> <span class="dv">3</span> <span class="sc">*</span> x2 <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">5</span>)</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="dv">5</span> <span class="sc">+</span> <span class="fl">1.5</span> <span class="sc">*</span> x1 <span class="sc">-</span> <span class="dv">2</span> <span class="sc">*</span> x2 <span class="sc">+</span> <span class="fl">0.5</span> <span class="sc">*</span> x3 <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>data_collinear <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x1 =</span> x1, <span class="at">x2 =</span> x2, <span class="at">x3 =</span> x3, <span class="at">y =</span> y)</span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(data_collinear)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            x1          x2        x3          y
x1  1.00000000 -0.04953215 0.1877534  0.6079515
x2 -0.04953215  1.00000000 0.5194100 -0.1488812
x3  0.18775342  0.51940999 1.0000000  0.6434430
y   0.60795153 -0.14888117 0.6434430  1.0000000</code></pre>
</div>
</div>
<p>We see that there is not strong correlation between any pair of the explanatory variables, but there is still collinearity because <span class="math inline">\(x_3\)</span> is predictable from <span class="math inline">\(x_1\)</span> and <span class="math inline">\(x_2\)</span>.</p>
<p>Let’s look for evidence of instability of the coefficients. First, we fit the multiple linear regression model with all three explanatory variables included:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>m_collinear_123 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x1 <span class="sc">+</span> x2 <span class="sc">+</span> x3, <span class="at">data =</span> data_collinear)</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m_collinear_123)<span class="sc">$</span>coefficients</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              Estimate Std. Error   t value     Pr(&gt;|t|)
(Intercept)  4.9806739 0.10734366  46.39933 1.490805e-67
x1           1.4675042 0.11972274  12.25752 2.384482e-21
x2          -1.9193496 0.12990373 -14.77517 1.832330e-26
x3           0.4885226 0.02244616  21.76419 6.723265e-39</code></pre>
</div>
</div>
<p>Do these change much if we fit the model with only <span class="math inline">\(x_1\)</span> and <span class="math inline">\(x_2\)</span> included?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>m_collinear_12 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x1 <span class="sc">+</span> x2, <span class="at">data =</span> data_collinear)</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m_collinear_12)<span class="sc">$</span>coefficients</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              Estimate Std. Error   t value     Pr(&gt;|t|)
(Intercept)  5.3105865  0.2575325 20.621034 3.113931e-37
x1           2.1192629  0.2809162  7.544111 2.464756e-11
x2          -0.3956201  0.2651792 -1.491897 1.389714e-01</code></pre>
</div>
</div>
<p>Yes, they do change quite a bit. The coefficients for <span class="math inline">\(x_1\)</span> and <span class="math inline">\(x_2\)</span> are quite different when <span class="math inline">\(x_3\)</span> is included in the model compared to when it is not included. This is because <span class="math inline">\(x_3\)</span> is predictable from <span class="math inline">\(x_1\)</span> and <span class="math inline">\(x_2\)</span>, so including <span class="math inline">\(x_3\)</span> in the model changes the interpretation of the coefficients for <span class="math inline">\(x_1\)</span> and <span class="math inline">\(x_2\)</span>.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>In a not so extreme case such as this one, the coefficients will not be completely unstable (i.e., they will not change from a number to NA) but they can still change quite a bit depending on which other collinear variables are included in the model.</p>
</div>
</div>
<p>The bottom line is that collinearity between explanatory variables complicates the interpretation of the model coefficients. If there is collinearity/correlation between the explanatory variables, then the model coefficients can be unstable and difficult to interpret.</p>
<p>Let’s have one more look at this instability that is caused by collinearity. And make this demonstration a bit more general. We’ll simulate data with two explanatory variables that are correlated with each other to varying degrees. We’ll then fit multiple linear regression models with both explanatory variables included, and see how the stability of the coefficients changes as we change the correlation between the explanatory variables.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="6.1-multiple-regression_files/figure-html/unnamed-chunk-40-1.png" class="img-fluid figure-img" width="432"></p>
</figure>
</div>
</div>
</div>
<p>In the left panel we see the slope estimates for <span class="math inline">\(x_1\)</span> from the multiple linear regression model with both <span class="math inline">\(x_1\)</span> and <span class="math inline">\(x_2\)</span> included, for different levels of correlation between <span class="math inline">\(x_1\)</span> and <span class="math inline">\(x_2\)</span>. When there is no correlation between <span class="math inline">\(x_1\)</span> and <span class="math inline">\(x_2\)</span> (i.e., no collinearity), the slope estimates are quite stable and close to the true value of 1.</p>
<p>As the correlation between <span class="math inline">\(x_1\)</span> and <span class="math inline">\(x_2\)</span> increases, the slope estimates become more variable (= less stable). At correlation of 0.9, the slope estimates are quite variable and can be very far from the true value of 1.</p>
<p>The right panel shows the variance of the slope estimates as a function of the correlation between <span class="math inline">\(x_1\)</span> and <span class="math inline">\(x_2\)</span>. Variance here is a measure of the amount of vertical spread in the left panel.</p>
<p>We see that the variance of the slope estimates increases as the correlation between <span class="math inline">\(x_1\)</span> and <span class="math inline">\(x_2\)</span> increases. This shows that greater collinearity between explanatory variables leads to greater instability (variance) of the slope estimates.</p>
<p>This increase in variance caused by collinearity is known as the <strong>variance inflation effect</strong>. The variance inflation effect makes it difficult to interpret the coefficients of the model, because the coefficients can be quite unstable and can change a lot depending on which other collinear variables are included in the model.</p>
<section id="collinearity-and-interpretation-of-r2" class="level3">
<h3 class="anchored" data-anchor-id="collinearity-and-interpretation-of-r2">Collinearity and interpretation of <span class="math inline">\(R^2\)</span></h3>
<p>Collinearity also affects the interpretation of the <span class="math inline">\(R^2\)</span> values. Collinearity will cause the collinear explanatory variables to share some of the explained variance. The <span class="math inline">\(R^2\)</span> value of the multiple regression will then be less than the sum of the <span class="math inline">\(R^2\)</span> values of the individual regressions of the response variable on each of the explanatory variables separately.</p>
<p><span class="math inline">\(R^2\)</span> of the age only model:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m2_age)<span class="sc">$</span>r.squared</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.4659862</code></pre>
</div>
</div>
<p><span class="math inline">\(R^2\)</span> of the mins_exercise only model:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m2_mins_exercise)<span class="sc">$</span>r.squared</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.4947937</code></pre>
</div>
</div>
<p><span class="math inline">\(R^2\)</span> of the model with both age and mins_exercise:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m2_both)<span class="sc">$</span>r.squared</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.7199706</code></pre>
</div>
</div>
<p>In this case the two explanatory variables are strongly correlated and so share a lot of the explained variance. The <span class="math inline">\(R^2\)</span> value of the model with both explanatory variables is much less than the sum of the <span class="math inline">\(R^2\)</span> values of the models with each explanatory variable separately. In fact, either of the models with only one explanatory variable is nearly as good as the model with both explanatory variables. We don’t gain much from including another explanatory variable in the model when we already include one explanatory variable that is strongly correlated with the other.</p>
<p><strong>Think–Pair–Share</strong> (#a_collinearity_intuition) Why can strong correlation among explanatory variables make estimates unstable even if the model fits the data well?</p>
</section>
<section id="do-i-have-a-problem-with-collinearity" class="level3">
<h3 class="anchored" data-anchor-id="do-i-have-a-problem-with-collinearity">Do I have a problem (with collinearity)?</h3>
<p>There are several ways to measuring collinearity between explanatory variables and to assess if it is a problematic. One way is to look at the correlation matrix of the explanatory variables. If there are strong correlations between any pair of explanatory variables, then there is likely to be collinearity.</p>
<p>But recall that collinearity can also occur without strong pairwise correlations. So another way to detect collinearity is to calculate the Variance Inflation Factor (VIF). This is so named because it measures how much the variance of the estimated regression coefficients is increased due to collinearity. (Recall that we saw the variance inflation effect in the simulation above.)</p>
<p>Recall the definition of collinearity: it is when an explanatory variable is predictable from a linear combination of others. To calculate the VIF for a specific explanatory variable, we fit a linear regression model with that explanatory variable as the response variable, and all the other explanatory variables as the explanatory variables. We then calculate the <span class="math inline">\(R^2\)</span> value for this model. The VIF is then calculated as:</p>
<p><span class="math display">\[VIF_j = \frac{1}{1 - R^2_j}\]</span></p>
<p>where <span class="math inline">\(R^2_j\)</span> is the <span class="math inline">\(R^2\)</span> value from the model with explanatory variable <span class="math inline">\(j\)</span> as the response variable, and all other explanatory variables as the explanatory variables.</p>
<p>In the case where the explanatory variable <span class="math inline">\(j\)</span> is not predictable from the other explanatory variables at all, then <span class="math inline">\(R^2_j = 0\)</span>, and the VIF is 1. This indicates that there is no collinearity.</p>
<p>In the case where the explanatory variable <span class="math inline">\(j\)</span> is perfectly predictable from the other explanatory variables, then <span class="math inline">\(R^2_j = 1\)</span>, and the VIF is infinite. This indicates that there is perfect collinearity.</p>
<p>To get the VIF for a multiple linear regression model with multiple explanatory variables, we calculate the VIF for each explanatory variable separately.</p>
<p>The VIF measures how much the variance of the estimated regression coefficients is increased due to collinearity.</p>
<p>In R, we can calculate the VIF using the <code>vif()</code> function from the <code>car</code> package. Here is the code to calculate the VIF for the blood pressure model:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">vif</span>(m1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          age mins_exercise 
     1.126219      1.126219 </code></pre>
</div>
</div>
<p>We see that the VIF values for both explanatory variables are close to 1, indicating that there is no collinearity between the explanatory variables.</p>
<p>For the previous example with collinearity among three explanatory variables, we can calculate the VIF as follows:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">vif</span>(m_collinear_123)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      x1       x2       x3 
1.069365 1.412832 1.460863 </code></pre>
</div>
</div>
<p>We see that the VIF values for all three explanatory variables are greater than 1, indicating that there is collinearity between the explanatory variables. The VIF for <span class="math inline">\(x_3\)</span> is highest, indicating that <span class="math inline">\(x_3\)</span> is predictable from <span class="math inline">\(x_1\)</span> and <span class="math inline">\(x_2\)</span>. But none of the VIF values are extremely high, indicating that the collinearity is not severe.</p>
<p>A VIF value greater than 5 or 10 is often used as a rule of thumb to indicate that there is collinearity between the explanatory variables.</p>
<p>Let’s make an example of three explanatory variables with more severe collinearity:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>x3 <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> x1 <span class="sc">+</span> <span class="dv">3</span> <span class="sc">*</span> x2 <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">1</span>)  <span class="co"># less noise, more collinearity</span></span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="dv">5</span> <span class="sc">+</span> <span class="fl">1.5</span> <span class="sc">*</span> x1 <span class="sc">-</span> <span class="dv">2</span> <span class="sc">*</span> x2 <span class="sc">+</span> <span class="fl">0.5</span> <span class="sc">*</span> x3 <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a>data_collinear_severe <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x1 =</span> x1, <span class="at">x2 =</span> x2, <span class="at">x3 =</span> x3, <span class="at">y =</span> y)</span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a>m_collinear_severe <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x1 <span class="sc">+</span> x2 <span class="sc">+</span> x3, data</span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a> <span class="ot">=</span> data_collinear_severe)</span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a><span class="fu">vif</span>(m_collinear_severe)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       x1        x2        x3 
 4.277416 10.644760 13.360572 </code></pre>
</div>
</div>
<p>We see that the VIF values of <span class="math inline">\(x_2\)</span> and <span class="math inline">\(x_3\)</span> are greater than 10, indicating that there is strong collinearity between the explanatory variables. The coefficients for <span class="math inline">\(x_2\)</span> and <span class="math inline">\(x_3\)</span> will be quite unstable and difficult to interpret.</p>
</section>
<section id="what-to-do-about-collinearity" class="level3">
<h3 class="anchored" data-anchor-id="what-to-do-about-collinearity">What to do about collinearity?</h3>
<p>Imagine we see high VIFs, we can conclud that there is collinearity between explanatory variables, and that the coefficients for those variables are likely to be unstable and difficult to interpret. What can we do???</p>
<p>The answer is we should <em>think</em>!</p>
<ul>
<li>Are explanatory variables measuring the same concept?</li>
<li>Is this collinearity expected from the study design?</li>
<li>Do I care about interpretation, or am I only interested in prediction?</li>
</ul>
<p>And then consider some possible remedies:</p>
<ul>
<li>Combine explanatory variables (index, PCA, biologically meaningful composite) (covered later in the course).</li>
<li>Look at the explanatory power of a variable once all other variables are accounted for (see below).</li>
<li>Remove one of a set of redundant explanatory variables (not covered in this course).</li>
<li>Use regularization if prediction is the goal (not covered in this course).</li>
</ul>
</section>
<section id="assessing-the-importance-of-an-explanatory-variables-in-the-presence-of-collinearity" class="level3">
<h3 class="anchored" data-anchor-id="assessing-the-importance-of-an-explanatory-variables-in-the-presence-of-collinearity">Assessing the importance of an explanatory variables in the presence of collinearity</h3>
<p>Imagine that we want to know the importance of an explanatory variable in the presence of collinearity. For example, we might want to know how important age is in explaining blood pressure. But we also know that we have collinearity with other explanatory variables, such as minutes of exercise. How can we assess the importance of a particular explanatory variable in the presence of collinearity? Let us call the explanatory variable of interest the “focal” explanatory variable.</p>
<p>One way to assess the importance of the focal explanatory variable is to compare two models. Both should have all other explanatory variables included, but one model should have the focal explanatory variable included, and the other model should have the focal explanatory variable removed. We can then make an <span class="math inline">\(F\)</span>-test to compare the two models. The null hypothesis is that the focal explanatory variable does not explain any additional variance in the response variable, once all other explanatory variables are accounted for. The alternative hypothesis is that the focal explanatory variable does explain additional variance in the response variable, once all other explanatory variables are accounted for.</p>
<p>The question is essentially: does including the focal explanatory variable improve the model fit, once all other explanatory variables are already accounted for?</p>
<p>Here is an example of how to do this in R. Lets use the data with three explanatory variables, <span class="math inline">\(x_1, x_2,\)</span> and <span class="math inline">\(x_3\)</span>, where <span class="math inline">\(x_3\)</span> is predictable from a linear combination of <span class="math inline">\(x_1\)</span> and <span class="math inline">\(x_2\)</span> plus some random noise. We will assess the importance of <span class="math inline">\(x_1\)</span> in explaining the response variable <span class="math inline">\(y\)</span>, once <span class="math inline">\(x_2\)</span> and <span class="math inline">\(x_3\)</span> are accounted for. First, we fit the full model with all three explanatory variables included:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>m_full <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x1 <span class="sc">+</span> x2 <span class="sc">+</span> x3, <span class="at">data =</span> data_collinear)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Then, we fit the reduced model with <span class="math inline">\(x_1\)</span> removed:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>m_reduced <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x2 <span class="sc">+</span> x3, <span class="at">data =</span> data_collinear)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now, we can use the <code>anova()</code> function to compare the two models:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(m_reduced, m_full)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Model 1: y ~ x2 + x3
Model 2: y ~ x1 + x2 + x3
  Res.Df    RSS Df Sum of Sq      F    Pr(&gt;F)    
1     97 272.27                                  
2     96 106.14  1    166.12 150.25 &lt; 2.2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>In the R output we see information about two models.</p>
<ul>
<li><strong>Model 1</strong> is the reduced model with <span class="math inline">\(x_1\)</span> removed.</li>
<li><strong>Model 2</strong> is the second model is the full model with all three explanatory variables included.</li>
</ul>
<p>Then we have a table that looks somewhat like an ANOVA table. The first column has no title and contain 1 and 2. This indicates the two models being compared.</p>
<p>The second column is <strong>Res.Df</strong>, which is the residual degrees of freedom for each model. We can see that the residual degrees of freedom for Model 2 is one less than that for Model 1, because Model 2 has one more explanatory variable (i.e., <span class="math inline">\(x_1\)</span>) than Model 1.</p>
<p>The third column is “RSS”, which is the Residual Sum of Squares for each model. The residual sum of squares for Model 2 is less than that for Model 1, because Model 2 has one more explanatory variable (i.e., <span class="math inline">\(x_1\)</span>) than Model 1, and because that explanatory variable helps to explain some of the variance in the response variable.</p>
<p>The fourth column is “Df”, which is the difference in degrees of freedom between the two models. This is one in this case, because Model 2 has one more explanatory variable than Model 1.</p>
<p>The fifth column is “Sum of Sq”, which is the difference in residual sum of squares between the two models. This the amount of variance in the response variable that is explained by the focal explanatory variable (i.e., <span class="math inline">\(x_1\)</span>) once all other explanatory variables are already accounted for.</p>
<p>The sixth column is “F value”, which is the F-statistic for the comparison of the two models. This is calculated as:</p>
<p><span class="math display">\[F = \frac{(RSS_1 - RSS_2) / (df_1-df_2)}{RSS_2 / df_2}\]</span></p>
<p>where <span class="math inline">\(RSS_1\)</span> and <span class="math inline">\(RSS_2\)</span> are the residual sum of squares for Model 1 and Model 2, respectively, and <span class="math inline">\(df_1\)</span> and <span class="math inline">\(df_2\)</span> are the residual degrees of freedom for Model 1 and Model 2, respectively.</p>
<p>Put another way, the numerator is the mean square difference between the two models, and the denominator is the mean square error for the full model.</p>
<p>In our example data, the numbers are: 272.3 - 106.1 = 166.1 divided by - 96 = 1 for the numerator.</p>
<p>And for the denominator: 106.1 divided by 96.</p>
<p>This gives an F value of 150.25. This is a very large F value, indicating that the focal explanatory variable (i.e., <span class="math inline">\(x_1\)</span>) explains a significant amount of variance in the response variable, even once all other explanatory variables are already accounted for. This means that even though there is collinearity between the explanatory variables, we can still find that <span class="math inline">\(x_1\)</span> is important in explaining the response variable.</p>
<p>We can also find the partial <span class="math inline">\(R^2\)</span> value for the focal explanatory variable (i.e., <span class="math inline">\(x_1\)</span>) from this analysis. The partial <span class="math inline">\(R^2\)</span> value is the proportion of variance in the response variable that is explained by the focal explanatory variable, as a fraction of the variance that is not explained by the other explanatory variables.</p>
<p>The partial <span class="math inline">\(R^2\)</span> is calculated as:</p>
<p><span class="math display">\[R^2_{partial} = \frac{RSS_1 - RSS_2}{RSS_1}\]</span></p>
<p>We can find this in R with:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>rss1 <span class="ot">&lt;-</span> <span class="fu">anova</span>(m_reduced, m_full)<span class="sc">$</span><span class="st">"RSS"</span>[<span class="dv">1</span>]</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>rss2 <span class="ot">&lt;-</span> <span class="fu">anova</span>(m_reduced, m_full)<span class="sc">$</span><span class="st">"RSS"</span>[<span class="dv">2</span>]</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>partial_r2 <span class="ot">&lt;-</span> (rss1 <span class="sc">-</span> rss2) <span class="sc">/</span> rss1</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>partial_r2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.6101473</code></pre>
</div>
</div>
<p>Don’t confuse this partial <span class="math inline">\(R^2\)</span> with what is sometimes known as the semi-partial <span class="math inline">\(R^2\)</span>. The semi-partial <span class="math inline">\(R^2\)</span> is the proportion of variance in the response variable that is explained by the focal explanatory variable, as a fraction of the total variance in the response variable. The semi-partial <span class="math inline">\(R^2\)</span> is calculated as:</p>
<p><span class="math display">\[R^2_{semi-partial} = \frac{RSS_1 - RSS_2}{TSS}\]</span></p>
<p>where <span class="math inline">\(TSS\)</span> is the total sum of squares of the response variable.</p>
<p>In R in our example this is:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>tss <span class="ot">&lt;-</span> <span class="fu">sum</span>((data_collinear<span class="sc">$</span>y <span class="sc">-</span> <span class="fu">mean</span>(data_collinear<span class="sc">$</span>y))<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>semi_partial_r2 <span class="ot">&lt;-</span> (rss1 <span class="sc">-</span> rss2) <span class="sc">/</span> tss</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>semi_partial_r2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1625303</code></pre>
</div>
</div>
<p>This means that about 16.25% of the total variance in the response variable is explained by the focal explanatory variable (i.e., <span class="math inline">\(x_1\)</span>), even once all other explanatory variables are already accounted for. This is explanatory power that is unique to the focal explanatory variable.</p>
<p><strong>Think–Pair–Share</strong> (#a_interpreting_coefficients_conditionally) How does the interpretation of a coefficient change when you add another explanatory variable to the model?</p>
</section>
</section>
<section id="review" class="level2">
<h2 class="anchored" data-anchor-id="review">Review</h2>
<p>Simple regression:</p>
<ul>
<li>How well does the model describe the data: Correlation and <span class="math inline">\(R^2\)</span></li>
<li>Are the parameter estimates compatible with some specific value (<span class="math inline">\(t\)</span>-test)?</li>
<li>What range of parameters values are compatible with the data (confidence intervals)?</li>
<li>What regression lines are compatible with the data (confidence band)?</li>
<li>What are plausible values of other data (prediction band)?</li>
</ul>
<p>Multiple regression:</p>
<ul>
<li>Multiple linear regression <span class="math inline">\(x_1\)</span>, <span class="math inline">\(x_2\)</span>, , <span class="math inline">\(x_m\)</span></li>
<li>Checking assumptions.</li>
<li>Question 1: As an ensemble, do the explanatory variables explain variation in the response variable? This is done with an overall <span class="math inline">\(F\)</span>-test.</li>
<li>Question 2: Which of the explanatory variables are important in explaining variation in the response variable? This is done by looking at the coefficients, t-tests, and confidence intervals for each explanatory variable.</li>
<li>Question 3: How well does the model describe the data? This is done with <span class="math inline">\(R^2\)</span> and adjusted <span class="math inline">\(R^2\)</span>.</li>
<li>Question 4: Are some explanatory variables more important than others in explaining variation in the response variable? This is done by looking at the sizes of the coefficients, and comparing those for different explanatory variables. But caution is required.</li>
<li>Question 5: How do we make predictions from the model? This is done with the <code>predict()</code> function, and often requires fixing the values of some explanatory variables to specific values.</li>
<li>Collinearity between explanatory variables can make the coefficients unstable and difficult to interpret. This can be assessed with the Variance Inflation Factor (VIF). Remedies include combining explanatory variables, removing redundant predictors, or using regularization if prediction is the goal. The importance of an explanatory variable in the presence of collinearity can be assessed by comparing models with and without that variable, using an F-test.</li>
</ul>
</section>
<section id="extras" class="level2">
<h2 class="anchored" data-anchor-id="extras">Extras</h2>
<section id="d-plot-of-multiple-linear-regression" class="level3">
<h3 class="anchored" data-anchor-id="d-plot-of-multiple-linear-regression">3D plot of multiple linear regression</h3>
<p>3D plots can help us to visualise multiple linear regression models with two explanatory variables. They are also kind of cool. They can also be difficult to interpret. So use with caution!</p>
<p>Here is the code to make a 3D plot of the blood pressure data. The y-axis is blood pressure, the x-axis is age, and the z-axis is minutes of exercise. Here is a 3d plot that we can interactive with and rotate (please note that this plot is best viewed in the HTML version of the book; in the PDF version, it will appear as a static image):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>plotly<span class="sc">::</span><span class="fu">plot_ly</span>(bp_data_multreg, <span class="at">x =</span> <span class="sc">~</span>age, <span class="at">y =</span> <span class="sc">~</span>mins_exercise, <span class="at">z =</span> <span class="sc">~</span>bp,</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">type =</span> <span class="st">"scatter3d"</span>, <span class="at">mode =</span> <span class="st">"markers"</span>, <span class="at">marker =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">5</span>),</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">width=</span><span class="dv">500</span>, <span class="at">height=</span><span class="dv">500</span>) <span class="sc">|&gt;</span> </span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>  plotly<span class="sc">::</span><span class="fu">layout</span>(<span class="at">scene =</span> <span class="fu">list</span>(<span class="at">xaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Age"</span>),</span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>                             <span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Minutes of exercise"</span>),</span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a>                             <span class="at">zaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Blood pressure"</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="htmlwidget-89f3f01a3ae87511683e" style="width:100%;height:650px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-89f3f01a3ae87511683e">{"x":{"visdat":{"a827b242deb":["function () ","plotlyVisDat"]},"cur_data":"a827b242deb","attrs":{"a827b242deb":{"x":{},"y":{},"z":{},"mode":"markers","marker":{"size":5},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter3d"}},"layout":{"width":500,"height":500,"margin":{"b":40,"l":60,"t":25,"r":10},"scene":{"xaxis":{"title":"Age"},"yaxis":{"title":"Minutes of exercise"},"zaxis":{"title":"Blood pressure"}},"hovermode":"closest","showlegend":false},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[45,49,78,60,39,40,27,47,30,47,35,64,43,72,64,47,47,33,44,59,36,75,62,65,74,55,44,35,32,61,48,61,43,35,42,65,54,40,55,75,22,29,39,46,34,57,77,46,65,39,54,22,78,55,47,58,44,42,22,78,23,64,52,40,49,69,35,24,29,22,38,62,33,67,67,71,63,30,70,66,32,50,30,78,38,67,80,79,61,54,45,44,60,40,32,45,36,24,22,72],"y":[248,61,21,37,125,55,162,256,270,204,297,209,240,49,35,279,156,272,221,99,25,11,3,185,138,73,257,250,7,9,156,236,127,290,109,50,137,45,153,90,102,186,267,235,62,137,201,107,30,107,30,220,108,271,70,69,172,67,252,183,251,230,95,295,55,225,104,266,271,263,68,97,127,76,235,169,81,214,54,285,255,185,48,1,251,235,21,66,275,160,153,97,60,7,73,66,80,262,224,128],"z":[80,119,109,112,86,117,79,94,76,88,70,95,88,124,118,94,98,72,99,113,98,114,125,103,122,108,91,84,102,119,98,97,107,69,110,125,106,108,106,122,87,80,85,87,98,91,120,105,126,98,122,86,130,96,111,118,98,109,85,118,81,121,98,81,125,118,96,88,91,76,91,128,113,132,100,107,122,96,131,78,76,100,93,145,106,97,133,137,96,83,85,89,105,130,124,112,94,67,79,107],"mode":"markers","marker":{"color":"rgba(31,119,180,1)","size":5,"line":{"color":"rgba(31,119,180,1)"}},"type":"scatter3d","error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="publication-ready-table-of-results" class="level3">
<h3 class="anchored" data-anchor-id="publication-ready-table-of-results">Publication ready table of results</h3>
<p>Sometimes we need to put a table of coefficients and confidence intervals into a report or publication. One option is to make a table in Word, and to manually enter the coefficients and confidence intervals. This is tedious and error prone. A much better option is to use R to make the table for us. One way to do this is to use the <code>broom</code> package to tidy up the model output into a data frame, and then use the <code>knitr</code> package to make a table from the data frame.</p>
<div class="cell" data-as.is="true">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>tidy_m1 <span class="ot">&lt;-</span> <span class="fu">tidy</span>(m1, <span class="at">conf.int =</span> <span class="cn">TRUE</span>)</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(tidy_m1, <span class="at">digits =</span> <span class="dv">3</span>, <span class="at">caption =</span> <span class="st">"Multiple linear regression results</span></span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a><span class="st">for blood pressure data"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Multiple linear regression results for blood pressure data</caption>
<colgroup>
<col style="width: 20%">
<col style="width: 12%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 11%">
<col style="width: 12%">
<col style="width: 14%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">term</th>
<th style="text-align: right;">estimate</th>
<th style="text-align: right;">std.error</th>
<th style="text-align: right;">statistic</th>
<th style="text-align: right;">p.value</th>
<th style="text-align: right;">conf.low</th>
<th style="text-align: right;">conf.high</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">90.813</td>
<td style="text-align: right;">3.985</td>
<td style="text-align: right;">22.790</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">82.904</td>
<td style="text-align: right;">98.722</td>
</tr>
<tr class="even">
<td style="text-align: left;">age</td>
<td style="text-align: right;">0.539</td>
<td style="text-align: right;">0.061</td>
<td style="text-align: right;">8.832</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.418</td>
<td style="text-align: right;">0.660</td>
</tr>
<tr class="odd">
<td style="text-align: left;">mins_exercise</td>
<td style="text-align: right;">-0.104</td>
<td style="text-align: right;">0.011</td>
<td style="text-align: right;">-9.380</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">-0.126</td>
<td style="text-align: right;">-0.082</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Another approach is to use <code>tbl_regression</code> function within the <code>gtsummary</code> package to get a publication ready table of the coefficients and confidence intervals:</p>
<div class="cell" data-as.is="true">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tbl_regression</span>(m1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="ilhgyosqkg" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#ilhgyosqkg table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#ilhgyosqkg thead, #ilhgyosqkg tbody, #ilhgyosqkg tfoot, #ilhgyosqkg tr, #ilhgyosqkg td, #ilhgyosqkg th {
  border-style: none;
}

#ilhgyosqkg p {
  margin: 0;
  padding: 0;
}

#ilhgyosqkg .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#ilhgyosqkg .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#ilhgyosqkg .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#ilhgyosqkg .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#ilhgyosqkg .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ilhgyosqkg .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ilhgyosqkg .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ilhgyosqkg .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#ilhgyosqkg .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#ilhgyosqkg .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#ilhgyosqkg .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#ilhgyosqkg .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#ilhgyosqkg .gt_spanner_row {
  border-bottom-style: hidden;
}

#ilhgyosqkg .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#ilhgyosqkg .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#ilhgyosqkg .gt_from_md > :first-child {
  margin-top: 0;
}

#ilhgyosqkg .gt_from_md > :last-child {
  margin-bottom: 0;
}

#ilhgyosqkg .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#ilhgyosqkg .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#ilhgyosqkg .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#ilhgyosqkg .gt_row_group_first td {
  border-top-width: 2px;
}

#ilhgyosqkg .gt_row_group_first th {
  border-top-width: 2px;
}

#ilhgyosqkg .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ilhgyosqkg .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#ilhgyosqkg .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#ilhgyosqkg .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ilhgyosqkg .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ilhgyosqkg .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#ilhgyosqkg .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#ilhgyosqkg .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#ilhgyosqkg .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ilhgyosqkg .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ilhgyosqkg .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ilhgyosqkg .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ilhgyosqkg .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ilhgyosqkg .gt_left {
  text-align: left;
}

#ilhgyosqkg .gt_center {
  text-align: center;
}

#ilhgyosqkg .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#ilhgyosqkg .gt_font_normal {
  font-weight: normal;
}

#ilhgyosqkg .gt_font_bold {
  font-weight: bold;
}

#ilhgyosqkg .gt_font_italic {
  font-style: italic;
}

#ilhgyosqkg .gt_super {
  font-size: 65%;
}

#ilhgyosqkg .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#ilhgyosqkg .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#ilhgyosqkg .gt_indent_1 {
  text-indent: 5px;
}

#ilhgyosqkg .gt_indent_2 {
  text-indent: 10px;
}

#ilhgyosqkg .gt_indent_3 {
  text-indent: 15px;
}

#ilhgyosqkg .gt_indent_4 {
  text-indent: 20px;
}

#ilhgyosqkg .gt_indent_5 {
  text-indent: 25px;
}

#ilhgyosqkg .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#ilhgyosqkg div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="gt_col_headings header">
<th id="label" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col"><strong>Characteristic</strong></th>
<th id="estimate" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>Beta</strong></th>
<th id="conf.low" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>95% CI</strong><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
<th id="p.value" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>p-value</strong></th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="label">age</td>
<td class="gt_row gt_center" headers="estimate">0.54</td>
<td class="gt_row gt_center" headers="conf.low">0.42, 0.66</td>
<td class="gt_row gt_center" headers="p.value">&lt;0.001</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">mins_exercise</td>
<td class="gt_row gt_center" headers="estimate">-0.10</td>
<td class="gt_row gt_center" headers="conf.low">-0.13, -0.08</td>
<td class="gt_row gt_center" headers="p.value">&lt;0.001</td>
</tr>
</tbody><tfoot class="gt_footnotes">
<tr class="odd">
<td colspan="4" class="gt_footnote"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span> CI = Confidence Interval</td>
</tr>
</tfoot>

</table>

</div>
</div>
</div>
<p>To use either approach most efficiently you will, however, need to write your report using R Markdown or Quarto so that the table is automatically created in your report document.</p>
</section>
<section id="a-figure-showing-the-coefficients-and-confidence-intervals" class="level3">
<h3 class="anchored" data-anchor-id="a-figure-showing-the-coefficients-and-confidence-intervals">A figure showing the coefficients and confidence intervals</h3>
<p>As well as or rather than a table of coefficients, we could make a figure showing the coefficients and confidence intervals for each explanatory variable. This can be a nice way to visualise the results of the multiple linear regression model.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>tidy_m1 <span class="ot">&lt;-</span> <span class="fu">tidy</span>(m1, <span class="at">conf.int =</span> <span class="cn">TRUE</span>)</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>tidy_m1 <span class="sc">|&gt;</span> </span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(term <span class="sc">!=</span> <span class="st">"(Intercept)"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> term, <span class="at">y =</span> estimate)) <span class="sc">+</span></span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> conf.low, <span class="at">ymax =</span> conf.high), <span class="at">width =</span></span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a>                <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Explanatory variable"</span>, <span class="at">y =</span> <span class="st">"Coefficient estimate"</span>) <span class="sc">+</span></span>
<span id="cb70-10"><a href="#cb70-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Multiple linear regression coefficients</span><span class="sc">\n</span><span class="st">and confidence intervals"</span>) <span class="sc">+</span></span>
<span id="cb70-11"><a href="#cb70-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="6.1-multiple-regression_files/figure-html/unnamed-chunk-56-1.png" class="img-fluid figure-img" width="432"></p>
</figure>
</div>
</div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/opetchey\.github\.io\/BIO144_Course_Book\/");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./5.1-anova.html" class="pagination-link" aria-label="Analysis of variance (L5)">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Analysis of variance (L5)</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./7.1-interactions.html" class="pagination-link" aria-label="Interactions (L7)">
        <span class="nav-page-text">Interactions (L7)</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>BIO144 Data Analysis for Biologists, Course Book written by Owen Petchey</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/opetchey/BIO144_Course_Book/edit/main/6.1-multiple-regression.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/opetchey/BIO144_Course_Book/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
<p>This book was built with <a href="https://quarto.org/">Quarto</a>.</p>
</div>
  </div>
</footer>




</body></html>