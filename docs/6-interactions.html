<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.433">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>BIO144 Course Book - Interactions (L5)</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./7-ANOVA.html" rel="next">
<link href="./5-categorical-explanatory-variables.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

<script src="site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./6-interactions.html">Interactions (L5)</a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">BIO144 Course Book</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1-intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction (L1)</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2-data-wrangling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data wrangling (L2)</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./3-regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Regression (L3&amp;4)</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./4-multiple-regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Multiple regression (L4)</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./5-categorical-explanatory-variables.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Categorical explanatory variables (L5)</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./6-interactions.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Interactions (L5)</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./7-ANOVA.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ANOVA (L6)</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./8-ANCOVA.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ANCOVA (L7)</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./9-linear-algebra.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Linear algebra (L7)</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10-variable-selection.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Variable selection (L8)</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11-interpretation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Intepretation, causality, and cautionary notes (L9)</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./12-count-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Count data (L10)</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./13-binary-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Binary data (L11)</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./14-measurement-error.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Measurement error (L12)</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./15-mixed-models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Mixed models (L12)</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./16-what-next.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">What next (L12)</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a>
  <ul class="collapse">
  <li><a href="#parallel-and-non-parallel-effects" id="toc-parallel-and-non-parallel-effects" class="nav-link" data-scroll-target="#parallel-and-non-parallel-effects">Parallel and non-parallel effects</a></li>
  <li><a href="#another-example-of-an-interaction" id="toc-another-example-of-an-interaction" class="nav-link" data-scroll-target="#another-example-of-an-interaction">Another example of an interaction</a></li>
  <li><a href="#and-another-example-of-an-interaction" id="toc-and-another-example-of-an-interaction" class="nav-link" data-scroll-target="#and-another-example-of-an-interaction">And another example of an interaction</a></li>
  <li><a href="#interactions-and-additivity-of-effects" id="toc-interactions-and-additivity-of-effects" class="nav-link" data-scroll-target="#interactions-and-additivity-of-effects">Interactions and additivity of effects</a></li>
  <li><a href="#drug-interactions" id="toc-drug-interactions" class="nav-link" data-scroll-target="#drug-interactions">Drug interactions</a></li>
  </ul></li>
  <li><a href="#the-maths-bit" id="toc-the-maths-bit" class="nav-link" data-scroll-target="#the-maths-bit">The maths bit</a></li>
  <li><a href="#hypothesis-testing" id="toc-hypothesis-testing" class="nav-link" data-scroll-target="#hypothesis-testing">Hypothesis testing</a></li>
  <li><a href="#doing-it-in-r" id="toc-doing-it-in-r" class="nav-link" data-scroll-target="#doing-it-in-r">Doing it in R</a></li>
  <li><a href="#reporting-our-findings" id="toc-reporting-our-findings" class="nav-link" data-scroll-target="#reporting-our-findings">Reporting our findings</a></li>
  <li><a href="#multiple-regression-vs.-many-single-regressions" id="toc-multiple-regression-vs.-many-single-regressions" class="nav-link" data-scroll-target="#multiple-regression-vs.-many-single-regressions">Multiple regression vs.&nbsp;many single regressions</a></li>
  <li><a href="#recap" id="toc-recap" class="nav-link" data-scroll-target="#recap">Recap</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Interactions (L5)</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>This chapter contains the content of the fifth lecture of the course BIO144 Data Analysis in Biology at the University of Zurich.</p>
<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>Interactions are some of the most interesting phenomena in science, including biology. We are not talking about interactions between species, like predation, though these are also very interesting. We are talking about effects of one thing, like diet, depending on another thing, like exercise. Lets break that down a bit…</p>
<p>Imagine we make a study of the effect of exercise (minutes per week) on blood pressure for people with a meat heavy diet.</p>
<p><a href="data/bp_diet_meatheavy.csv" download=""> Download the dataset. </a></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>bp_diet_meatheavy <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data"</span>, <span class="st">"bp_diet_meatheavy.csv"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 50 Columns: 3
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr (1): diet
dbl (2): bp, mins_per_week

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(bp_diet_meatheavy)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 3
     bp mins_per_week diet      
  &lt;dbl&gt;         &lt;dbl&gt; &lt;chr&gt;     
1  94.1          53.1 meat heavy
2  91.0          74.4 meat heavy
3  73.8         115.  meat heavy
4  77.1         182.  meat heavy
5 100.           40.3 meat heavy
6  95.6         180.  meat heavy</code></pre>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<p><img src="6-interactions_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="480"></p>
</div>
</div>
<p>We see that exercise seems to lower blood pressure. But what if we look at the effect of exercise on blood pressure for people with a vegetarian diet?</p>
<p><a href="data/bp_diet_vegetarian.csv" download=""> Download the dataset. </a></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>bp_diet_vegetarian <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data"</span>, <span class="st">"bp_diet_vegetarian.csv"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 50 Columns: 3
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr (1): diet
dbl (2): bp, mins_per_week

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(bp_diet_vegetarian)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 3
     bp mins_per_week diet      
  &lt;dbl&gt;         &lt;dbl&gt; &lt;chr&gt;     
1  77.6         123.  vegetarian
2  84.3         111.  vegetarian
3  75.2          65.8 vegetarian
4  85.7          90.6 vegetarian
5  77.5         100.  vegetarian
6 102.           36.2 vegetarian</code></pre>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<p><img src="6-interactions_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="480"></p>
</div>
</div>
<p>We see that exercise seems to lower blood pressure for vegetarians too, but the effect seems to be weaker.</p>
<p>To summarise this finding, we can say that the effect of exercise on blood pressure is stronger for people with a meat heavy diet than for people with a vegetarian diet. This means that the effect of exercise on blood pressure depends on diet.</p>
<p>This is very clear when we look at the both diets in the same graph:</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="6-interactions_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="480"></p>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Think, Pair, Share (#general-diet)
</div>
</div>
<div class="callout-body-container callout-body">
<p>Can we say anything general about the effect of diet on blood pressure?</p>
</div>
</div>
<p>No, we can’t. For example, we can’t state that a vegetarian diet lowers blood pressure. We can say, however, that a vegatarian diet lowers blood pressure of people that do little exercise.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Think, Pair, Share (#general-exercise)
</div>
</div>
<div class="callout-body-container callout-body">
<p>Can we say anything general about the effect of exercise on blood pressure?</p>
</div>
</div>
<p>Well, not really. I would not be confident stating that diet reduces blood pressure. There is only rather weak evidence for an effect of exercise on blood pressure of vegetarians. (But there is strong evidence that exercise lowers blood pressure of people with a meat heavy diet.)</p>
<p>I think it is clear that the interaction was easier to see when we plotted all the data in one graph… it is much easier to visually compare the slopes of the two regression lines when they are on the same graph.</p>
<p>As we will see later in this chapter, the same holds true for statistical tests of interactions: it is much easier to make a statistical test of the interaction when we have all the data in one data frame. It is harder and is not recommended to make a separate regression for each level of the second variable (diet) and then compare the slopes of the regression lines (it is possible, just not at all efficient).</p>
<section id="parallel-and-non-parallel-effects" class="level3">
<h3 class="anchored" data-anchor-id="parallel-and-non-parallel-effects">Parallel and non-parallel effects</h3>
<p>In the example above, the effect of exercise on blood pressure was stronger for people with a meat heavy diet than for people with a vegetarian diet. That is, the slope of the regression line was steeper for the meat heavy diet than for the vegetarian diet. Put another way, the regression lines are not parallel.</p>
<p>Parallel regression lines are evidence of no interaction. This means that the effect of one variable (exercise) is the same for all levels of another variable (diet).</p>
<p>When the regression lines are not parallel, there is evidence of an interaction. This means that the effect of one variable (exercise) depends on the level of another variable (diet).</p>
</section>
<section id="another-example-of-an-interaction" class="level3">
<h3 class="anchored" data-anchor-id="another-example-of-an-interaction">Another example of an interaction</h3>
<p>Two categorical variables: diet and exercise</p>
<p><a href="data/bp_data_2cat.csv" download=""> Download the dataset. </a></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>bp_data_2cat <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data"</span>, <span class="st">"bp_data_2cat.csv"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 40 Columns: 5
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr (2): diet, exercise
dbl (3): reps, bp, error

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(bp_data_2cat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 5
  diet       exercise  reps    bp error
  &lt;chr&gt;      &lt;chr&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1 meat heavy high         1  83.7 -6.26
2 meat heavy low          1 115.  15.1 
3 vegetarian high         1  84.2  9.19
4 vegetarian low          1 109.  13.6 
5 meat heavy high         2  91.8  1.84
6 meat heavy low          2 104.   3.90</code></pre>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<p><img src="6-interactions_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="480"></p>
</div>
</div>
</section>
<section id="and-another-example-of-an-interaction" class="level3">
<h3 class="anchored" data-anchor-id="and-another-example-of-an-interaction">And another example of an interaction</h3>
<p>Two continuous explanatory variables (age and exercise minutes) and one continuous response variable (blood pressure)</p>
<p><a href="data/bp_data_cont.csv" download=""> Download the dataset. </a></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>bp_data_cont <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data"</span>, <span class="st">"bp_data_cont.csv"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 100 Columns: 3
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
dbl (3): bp, age, mins_per_week

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(bp_data_cont)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 3
     bp   age mins_per_week
  &lt;dbl&gt; &lt;dbl&gt;         &lt;dbl&gt;
1  61.6  35.9         131. 
2  83.9  42.3          70.6
3  93.0  54.4          54.1
4  82.1  74.5         199. 
5  60.1  32.1         127. 
6 102.   73.9          42.6</code></pre>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<p><img src="6-interactions_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid" width="480"></p>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<p><img src="6-interactions_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid" width="480"></p>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<p><img src="6-interactions_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid" width="480"></p>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<p><img src="6-interactions_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid" width="480"></p>
</div>
</div>
</section>
<section id="interactions-and-additivity-of-effects" class="level3">
<h3 class="anchored" data-anchor-id="interactions-and-additivity-of-effects">Interactions and additivity of effects</h3>
<p>Another way of thinking about this is that the effects of diet and exercise on blood pressure are not additive. If in one study we estimated the effect of diet on blood pressure we might find an effect size of 10. If in another study we estimated the effect of exercise on blood pressure we might find an effect size of 5.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Think, Pair, Share (#adding-effects)
</div>
</div>
<div class="callout-body-container callout-body">
<p>If the effects of diet and exercise were additive, what would we expect the effect size to be if we estimated the effect of diet and exercise on blood pressure in the same study?</p>
</div>
</div>
<p>If the effects are non-additive, we would expect the effect size to be different from additive. For example, if we found the combined effect of diet and exercise on blood pressure to be 30, we would say that the effects are non-additive. Their combined effect is more than the sum of their individual effects. This example is of a synergistic interaction because the combined effect (30) is greater than the sum of the individual effects (15).</p>
</section>
<section id="drug-interactions" class="level3">
<h3 class="anchored" data-anchor-id="drug-interactions">Drug interactions</h3>
<p>When we are prescribed a medication, we are often asked if we are taking any other medications. This is because the effects of drugs can interact. For example, if we take two drugs that both lower blood pressure and they interfere with each other, the combined effect might be less than the sum of their individual effects. This is an antagonistic interaction. It could be worse than that though, the interaction might actually be harmful, which is why doctors are so careful about known and potential drug interactions.</p>
</section>
</section>
<section id="the-maths-bit" class="level2">
<h2 class="anchored" data-anchor-id="the-maths-bit">The maths bit</h2>
<p>Let us return to the example of the effects of number of minutes of exercise and diet on blood pressure:</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="6-interactions_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid" width="480"></p>
</div>
</div>
<p>We have one continuous explanatory variable (minutes of exercise) and one binary explanatory variable (diet) and one continuous response variable (blood pressure).</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Think, Pair, Share (#without-interaction)
</div>
</div>
<div class="callout-body-container callout-body">
<p>What would a linear model without an interaction term be?</p>
</div>
</div>
<p><span class="math display">\[y_i = \beta_0 + \beta_1 x_{i}^{(1)} + \beta_2 x_{i}^{(2)} + \epsilon_i\]</span></p>
<p>where:</p>
<ul>
<li><span class="math inline">\(y_i\)</span> is the blood pressure of the <span class="math inline">\(i\)</span>th participant</li>
<li>$x_1^{(i)} is the number of minutes of exercise of the <span class="math inline">\(i\)</span>th participant</li>
<li><span class="math inline">\(x_2^{(i)}\)</span> is the diet of the <span class="math inline">\(i\)</span>th participant</li>
<li><span class="math inline">\(\beta_0\)</span> is the intercept</li>
<li><span class="math inline">\(\beta_1\)</span> is the effect of exercise on blood pressure</li>
<li><span class="math inline">\(\beta_2\)</span> is the effect of diet on blood pressure</li>
<li><span class="math inline">\(\epsilon_i\)</span> is the error term for the <span class="math inline">\(i\)</span>th participant.</li>
</ul>
<p>This model is a multiple regression model in which one of the explanatory variables is binary.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Think, Pair, Share (#with-interaction)
</div>
</div>
<div class="callout-body-container callout-body">
<p>What might the model look like if we wanted to include an interaction between diet and exercise?</p>
</div>
</div>
<p><span class="math display">\[y_i = \beta_0 + \beta_1 x_{i}^{(1)} + \beta_2 x_{i}^{(2)} + \beta_3 (x_{i}^{(1)} x_{i}^{(2)}) + \epsilon_i\]</span></p>
<p>where:</p>
<ul>
<li><span class="math inline">\(x_{i}^{(1)}x_{i}^{(2)}\)</span> is the product of the number of minutes of exercise and the diet of the <span class="math inline">\(i\)</span>th participant.</li>
<li><span class="math inline">\(\beta_3\)</span> is the coefficient of the interaction term between diet and exercise.</li>
</ul>
<p>We could also write this model as:</p>
<p><span class="math display">\[y_i = \beta_0 + \beta_1 x_{i}^{(1)} + \beta_2 x_{i}^{(2)} + \beta_3 x_{i}^{(3)} + \epsilon_i\]</span></p>
<p>where:</p>
<ul>
<li><span class="math inline">\(x_{i}^{(3)} = x_{i}^{(1)} x_{i}^{(2)}\)</span></li>
</ul>
<p>This is again a multiple regression model, but now with three explanatory variables.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Think, Pair, Share (#sketch-interaction)
</div>
</div>
<div class="callout-body-container callout-body">
<p>Make sketches of the possible relationships between diet, exercise and blood pressure. Make a sketch compatible with <span class="math inline">\(\beta_3 = 0\)</span>. Make a sketch compatible with <span class="math inline">\(\beta_3 \neq 0\)</span>.</p>
</div>
</div>
</section>
<section id="hypothesis-testing" class="level2">
<h2 class="anchored" data-anchor-id="hypothesis-testing">Hypothesis testing</h2>
<p>If we want to test whether the effect of minutes of exercise on blood pressure is different for people with different diets, we need a null hypothesis to test.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Think, Pair, Share (#interaction-null)
</div>
</div>
<div class="callout-body-container callout-body">
<p>What is the null hypothesis in this case, verbally, and in terms of the coefficients of the model?</p>
</div>
</div>
<p>The null hypothesis is that the effect of minutes of exercise on blood pressure is the same for people with different diets. This is a null hypothesis of no interaction between diet and exercise. In terms of the coefficients of the model, the null hypothesis is that <span class="math inline">\(\beta_3 = 0\)</span>.</p>
<p>If we reject the null hypothesis, we conclude that the effect of minutes of exercise on blood pressure is different for people with different diets. This is a non-additive effect.</p>
</section>
<section id="doing-it-in-r" class="level2">
<h2 class="anchored" data-anchor-id="doing-it-in-r">Doing it in R</h2>
<p>Let us fit the model with the interaction term in R. There are two methods to do this and they are equivalent:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>mod1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(bp <span class="sc">~</span> mins_per_week <span class="sc">+</span> diet <span class="sc">+</span> mins_per_week<span class="sc">:</span>diet, <span class="at">data=</span>bp_diet)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>mod2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(bp <span class="sc">~</span> mins_per_week <span class="sc">*</span> diet, <span class="at">data=</span>bp_diet)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The second is a shorthand for the first. The <code>*</code> operator includes the main effects (main effects are terms in the model that don’t include interactions) and the interaction term. The <code>:</code> operator includes only the interaction term.</p>
<p>Of course, we check the model diagnostics before we interpret the results:</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="6-interactions_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid" width="480"></p>
</div>
</div>
<p>All of the plots look good.</p>
<p>Now, let us look at the coefficients of the model:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>                                 Estimate Std. Error   t value     Pr(&gt;|t|)
(Intercept)                  100.62716134 2.87228930 35.033783 1.714199e-56
mins_per_week                 -0.09661054 0.02406014 -4.015376 1.177969e-04
dietvegetarian               -15.27591304 4.09882726 -3.726898 3.275630e-04
mins_per_week:dietvegetarian   0.06907583 0.03433487  2.011828 4.704076e-02</code></pre>
</div>
</div>
<p>As expected, there are four coefficients.</p>
<p>The first is <code>(Intercept)</code>, which is the expected blood pressure for a person who does 0 minutes of exercise and is on diet “meat heavy”.</p>
<p>The second is <code>mins_per_week</code>, which is the effect (slope) of minutes of exercise on blood pressure for a person on diet “meat heavy”.</p>
<p>The third is <code>dietvegetarian</code>, which is the effect of being on a vegetarian diet on blood pressure for a person who does 0 minutes of exercise. This can be thought of as the change in the intercept for a person on a vegetarian diet compared to a person on a “meat heavy” diet.</p>
<p>The fourth is the interaction term <code>mins_per_week:dietvegetarian</code>, which is the difference in the effect (slope) of minutes of exercise on blood pressure for a person on a vegetarian diet compared to a person on a “meat heavy” diet.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Think, Pair, Share (#two-equations)
</div>
</div>
<div class="callout-body-container callout-body">
<p>Write two equations, one for each of the two diets. They would look something like this: <span class="math inline">\(y_i = 0.1 - 0.1 x_{i}^{(1)}\)</span>, but will have other numbers.</p>
</div>
</div>
</section>
<section id="reporting-our-findings" class="level2">
<h2 class="anchored" data-anchor-id="reporting-our-findings">Reporting our findings</h2>
<p>Of course a nice graph is always helpful. We already have quite a nice one:</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="6-interactions_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid" width="480"></p>
</div>
</div>
<p>We also might want some tables summarizing the model results. Here is a table of the coefficients:</p>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Estimate</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Std. Error</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">t value</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Pr(&gt;|t|)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">100.6271613</td>
<td style="text-align: right;">2.8722893</td>
<td style="text-align: right;">35.033783</td>
<td style="text-align: right;">0.0000000</td>
</tr>
<tr class="even">
<td style="text-align: left;">mins_per_week</td>
<td style="text-align: right;">-0.0966105</td>
<td style="text-align: right;">0.0240601</td>
<td style="text-align: right;">-4.015377</td>
<td style="text-align: right;">0.0001178</td>
</tr>
<tr class="odd">
<td style="text-align: left;">dietvegetarian</td>
<td style="text-align: right;">-15.2759130</td>
<td style="text-align: right;">4.0988273</td>
<td style="text-align: right;">-3.726898</td>
<td style="text-align: right;">0.0003276</td>
</tr>
<tr class="even">
<td style="text-align: left;">mins_per_week:dietvegetarian</td>
<td style="text-align: right;">0.0690758</td>
<td style="text-align: right;">0.0343349</td>
<td style="text-align: right;">2.011828</td>
<td style="text-align: right;">0.0470408</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>We could also report the <span class="math inline">\(R^2\)</span> of the model:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2732093</code></pre>
</div>
</div>
<p>And also a table of the variances of the terms in the model:</p>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Df</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Sum Sq</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Mean Sq</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">F value</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Pr(&gt;F)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">mins_per_week</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1133.554</td>
<td style="text-align: right;">1133.55446</td>
<td style="text-align: right;">13.47998</td>
<td style="text-align: right;">0.0003964</td>
</tr>
<tr class="even">
<td style="text-align: left;">diet</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1560.753</td>
<td style="text-align: right;">1560.75255</td>
<td style="text-align: right;">18.56012</td>
<td style="text-align: right;">0.0000398</td>
</tr>
<tr class="odd">
<td style="text-align: left;">mins_per_week:diet</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">340.357</td>
<td style="text-align: right;">340.35702</td>
<td style="text-align: right;">4.04745</td>
<td style="text-align: right;">0.0470408</td>
</tr>
<tr class="even">
<td style="text-align: left;">Residuals</td>
<td style="text-align: right;">96</td>
<td style="text-align: right;">8072.804</td>
<td style="text-align: right;">84.09171</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>We also might use a sentence like this to report the results: “The effect of minutes of exercise is generally negative, but the effect is stronger for people on a meat heavy diet than for people on a vegetarian diet (<span class="math inline">\(t\)</span>-statistics of interaction term = 2.01, degree of freedom = 96, p = 0.05). The greater beneficial effect of exercise on blood pressure for people on a meat heavy diet is largely caused by the high blood pressure of people on a meat heavy diet that do not exercise.”</p>
</section>
<section id="multiple-regression-vs.-many-single-regressions" class="level2">
<h2 class="anchored" data-anchor-id="multiple-regression-vs.-many-single-regressions">Multiple regression vs.&nbsp;many single regressions</h2>
<p>Question: Why not just fit a separate simple regression model and then compare the two separately estimated slopes? That is, why not fit the two models:</p>
<p><span class="math display">\[y_i = \beta_{0,veg} + \beta_{1,veg} x_i^{(1)} + \epsilon_i\]</span></p>
<p><span class="math display">\[y_i = \beta_{0,meat} + \beta_{1,meat} x_i^{(2)} + \epsilon_i\]</span></p>
<p>and compare the estimate of <span class="math inline">\(\beta_{1,veg}\)</span> to the estimate of <span class="math inline">\(\beta_{1,meat}\)</span>?</p>
<p>Well, you could do that, and could probably find a way to test for whether the difference in the slopes is different from 0. This would be a test of the null hypothesis that the effect of minutes of exercise on blood pressure is the same for people with different diets. But, this would be a more complicated way to do it, and would not be as general as the model with the interaction term. The model with the interaction term is more general, more flexible, and more elegant.</p>
</section>
<section id="recap" class="level2">
<h2 class="anchored" data-anchor-id="recap">Recap</h2>
<ul>
<li>Binary and categorical explanatory variables.</li>
<li>Interactions: a categorical explanatory variables allows for group-specific intercepts and slopes.</li>
<li>The <span class="math inline">\(F\)</span>-test is used to test if <span class="math inline">\(\beta_1=\beta_2=...=\beta_k=0\)</span> at the same time for a categorical explanatory variable with <span class="math inline">\(k\)</span> levels. Use the <code>anova</code> function in R to carry out this test.</li>
<li>The <span class="math inline">\(F\)</span>-test is a generalization of the <span class="math inline">\(t\)</span>-test, because the latter is used to test <span class="math inline">\(\beta_j = 0\)</span> for one single variable <span class="math inline">\(x^{(j)}\)</span>.<br>
</li>
<li>Test for a single <span class="math inline">\(\beta_j=0\)</span> <span class="math inline">\(\rightarrow\)</span> <span class="math inline">\(t\)</span>-test.</li>
<li>Test for several <span class="math inline">\(\beta_2 = ... = \beta_{k}=0\)</span> simultaneously <span class="math inline">\(\rightarrow\)</span> <span class="math inline">\(F\)</span>-test.</li>
</ul>
<p>Thus you will <em>always</em> need the <span class="math inline">\(F\)</span>-test <code>anova()</code> to obtain a <span class="math inline">\(p\)</span>-value for a categorial explanatory variable with more than 2 levels. This is because such a variable is represented by more than one coefficient in the model (remember the dummy variables).</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./5-categorical-explanatory-variables.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Categorical explanatory variables (L5)</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./7-ANOVA.html" class="pagination-link">
        <span class="nav-page-text">ANOVA (L6)</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>