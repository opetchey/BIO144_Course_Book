{
  "hash": "6dd8be3c4dfe103abe5acfef54a70a6d",
  "result": {
    "markdown": "::: {.cell}\n\n:::\n\n\n\n# Interactions (L5) {.unnumbered}\n\nThis chapter contains the content of the fifth lecture of the course BIO144 Data Analysis in Biology at the University of Zurich.\n\n\n## Introduction\n\nInteractions are some of the most interesting phenomena in science, including biology. We are not talking about interactions between species, like predation, though these are also very interesting. We are talking about effects of one thing, like diet, depending on another thing, like exercise. Lets break that down a bit...\n\nImagine we make a study of the effect of exercise (minutes per week) on blood pressure for people with a meat heavy diet.\n\n\n::: {.cell}\n\n:::\n\n\n\n<a href=\"data/bp_diet_meatheavy.csv\" download>\n  Download the dataset.\n</a>\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbp_diet_meatheavy <- read_csv(here::here(\"data\", \"bp_diet_meatheavy.csv\"))\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nRows: 50 Columns: 3\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (1): diet\ndbl (2): bp, mins_per_week\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n:::\n\n```{.r .cell-code}\nhead(bp_diet_meatheavy)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 3\n     bp mins_per_week diet      \n  <dbl>         <dbl> <chr>     \n1  94.1          53.1 meat heavy\n2  91.0          74.4 meat heavy\n3  73.8         115.  meat heavy\n4  77.1         182.  meat heavy\n5 100.           40.3 meat heavy\n6  95.6         180.  meat heavy\n```\n:::\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n![](6-interactions_files/figure-html/unnamed-chunk-4-1.png){width=480}\n:::\n:::\n\n\nWe see that exercise seems to lower blood pressure. But what if we look at the effect of exercise on blood pressure for people with a vegetarian diet?\n\n\n::: {.cell}\n\n:::\n\n\n\n<a href=\"data/bp_diet_vegetarian.csv\" download>\n  Download the dataset.\n</a>\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbp_diet_vegetarian <- read_csv(here::here(\"data\", \"bp_diet_vegetarian.csv\"))\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nRows: 50 Columns: 3\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (1): diet\ndbl (2): bp, mins_per_week\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n:::\n\n```{.r .cell-code}\nhead(bp_diet_vegetarian)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 3\n     bp mins_per_week diet      \n  <dbl>         <dbl> <chr>     \n1  77.6         123.  vegetarian\n2  84.3         111.  vegetarian\n3  75.2          65.8 vegetarian\n4  85.7          90.6 vegetarian\n5  77.5         100.  vegetarian\n6 102.           36.2 vegetarian\n```\n:::\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n![](6-interactions_files/figure-html/unnamed-chunk-7-1.png){width=480}\n:::\n:::\n\n\nWe see that exercise seems to lower blood pressure for vegetarians too, but the effect seems to be weaker.\n\nTo summarise this finding, we can say that the effect of exercise on blood pressure is stronger for people with a meat heavy diet than for people with a vegetarian diet. This means that the effect of exercise on blood pressure depends on diet.\n\nThis is very clear when we look at the both diets in the same graph:\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](6-interactions_files/figure-html/unnamed-chunk-8-1.png){width=480}\n:::\n:::\n\n\n\n::: {.callout-tip}\n## Think, Pair, Share (#general-diet)\n\nCan we say anything general about the effect of diet on blood pressure?\n:::\n\nNo, we can't. We cannot, for example, state that a vegetarian diet lowers blood pressure. We can say, however, that a vegatarian diet lowers blood pressure of people that do little exercise.\n\n::: {.callout-tip}\n## Think, Pair, Share (#general-exercise)\n\nCan we say anything general about the effect of exercise on blood pressure?\n:::\n\nWell, we can say that exercise lowers blood pressure, but we have to be careful. We have to say that exercise lowers blood pressure of people with a vegetarian diet more than of people with a meat heavy diet.\n\n\nI think it is clear that the interaction was easier to see when we plotted all the data in one graph... it is much easier to visually compare the slopes of the two regression lines when they are on the same graph.\n\nAs we will see later in this chapter, the same holds true for statistical tests of interactions: it is much easier to make a statistical test of the interaction when we have all the data in one data frame. It is harder and is not recommended to make a separate regression for each level of the second variable (diet) and then compare the slopes of the regression lines (it is possible, just not at all efficient).\n\n\n### Parallel and non-parallel effects\n\nIn the example above, the effect of exercise on blood pressure was stronger for people with a meat heavy diet than for people with a vegetarian diet. That is, the slope of the regression line was steeper for the meat heavy diet than for the vegetarian diet. Put another way, the regression lines are not parallel.\n\nParallel regression lines are evidence of no interaction. This means that the effect of one variable (exercise) is the same for all levels of another variable (diet).\n\nWhen the regression lines are not parallel, there is evidence of an interaction. This means that the effect of one variable (exercise)  depends on the level of another variable (diet).\n\n\n\n\n\n### Another example of an interaction\n\nTwo categorical variables: diet and exercise\n\n\n::: {.cell}\n\n:::\n\n\n<a href=\"data/bp_data_2cat.csv\" download>\n  Download the dataset.\n</a>\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbp_data_2cat <- read_csv(here::here(\"data\", \"bp_data_2cat.csv\"))\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nRows: 40 Columns: 5\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (2): diet, exercise\ndbl (3): reps, bp, error\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n:::\n\n```{.r .cell-code}\nhead(bp_data_2cat)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 5\n  diet       exercise  reps    bp error\n  <chr>      <chr>    <dbl> <dbl> <dbl>\n1 meat heavy high         1  83.7 -6.26\n2 meat heavy low          1 115.  15.1 \n3 vegetarian high         1  84.2  9.19\n4 vegetarian low          1 109.  13.6 \n5 meat heavy high         2  91.8  1.84\n6 meat heavy low          2 104.   3.90\n```\n:::\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n![](6-interactions_files/figure-html/unnamed-chunk-11-1.png){width=480}\n:::\n:::\n\n\n### And another example of an interaction\n\nTwo continuous explanatory variables (age and exercise minutes) and one continuous response variable (blood pressure)\n\n\n::: {.cell}\n\n:::\n\n\n<a href=\"data/bp_data_cont.csv\" download>\n  Download the dataset.\n</a>\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbp_data_cont <- read_csv(here::here(\"data\", \"bp_data_cont.csv\"))\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nRows: 100 Columns: 3\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\ndbl (3): bp, age, mins_per_week\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n:::\n\n```{.r .cell-code}\nhead(bp_data_cont)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 3\n     bp   age mins_per_week\n  <dbl> <dbl>         <dbl>\n1  61.6  35.9         131. \n2  83.9  42.3          70.6\n3  93.0  54.4          54.1\n4  82.1  74.5         199. \n5  60.1  32.1         127. \n6 102.   73.9          42.6\n```\n:::\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n![](6-interactions_files/figure-html/unnamed-chunk-14-1.png){width=480}\n:::\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n![](6-interactions_files/figure-html/unnamed-chunk-15-1.png){width=480}\n:::\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n![](6-interactions_files/figure-html/unnamed-chunk-18-1.png){width=480}\n:::\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n![](6-interactions_files/figure-html/unnamed-chunk-19-1.png){width=480}\n:::\n:::\n\n\n\n\n\n### Interactions and additivity of effects\n\nAnother way of thinking about this is that the effects of diet and exercise on blood pressure are not additive. If in one study we estimated the effect of diet on blood pressure we might find an effect size of 10. If in another study we estimated the effect of exercise on blood pressure we might find an effect size of 5.\n\n::: {.callout-tip}\n## Think, Pair, Share (#adding-effects)\n\nIf the effects of diet and exercise were additive, what would we expect the effect size to be if we estimated the effect of diet and exercise on blood pressure in the same study?\n:::\n\n\n\nIf the effects are non-additive, we would expect the effect size to be different from additive. For example, if we found the combined effect of diet and exercise on blood pressure to be 30, we would say that the effects are non-additive. Their combined effect is more than the sum of their individual effects. This example is of a synergistic interaction because the combined effect (30) is greater than the sum of the individual effects (15).\n\n### Drug interactions\n\nWhen we are prescribed a medication, we are often asked if we are taking any other medications. This is because the effects of drugs can interact. For example, if we take two drugs that both lower blood pressure and they interfere with each other, the combined effect might be less than the sum of their individual effects. This is an antagonistic interaction. It could be worse than that though, the interaction might actually be harmful, which is why doctors are so careful about known and potential drug interactions.\n\n\n\n\n\n\n\n## The maths bit\n\nLet us return to the example of the effects of number of minutes of exercise and diet on blood pressure:\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](6-interactions_files/figure-html/unnamed-chunk-20-1.png){width=480}\n:::\n:::\n\n\nWe have one continuous explanatory variable (minutes of exercise) and one binary explanatory variable (diet) and one continuous response variable (blood pressure).\n\n\n::: {.callout-tip}\n## Think, Pair, Share (#without-interaction)\n\nWhat would a linear model without an interaction term be?\n:::\n\n\n$$y_i = \\beta_0 + \\beta_1 x_{i}^{(1)} + \\beta_2 x_{i}^{(2)} + \\epsilon_i$$\n\nwhere:\n\n* $y_i$ is the blood pressure of the $i$th participant\n* $x_1^{(i)} is the number of minutes of exercise of the $i$th participant\n* $x_2^{(i)}$ is the diet of the $i$th participant\n* $\\beta_0$ is the intercept\n* $\\beta_1$ is the effect of exercise on blood pressure\n* $\\beta_2$ is the effect of diet on blood pressure\n* $\\epsilon_i$ is the error term for the $i$th participant.\n\nThis model is a multiple regression model in which one of the explanatory variables is binary.\n\n\n::: {.callout-tip}\n## Think, Pair, Share (#with-interaction)\n\nWhat might the model look like if we wanted to include an interaction between diet and exercise?\n:::\n\n\n\n$$y_i = \\beta_0 + \\beta_1 x_{i}^{(1)} + \\beta_2 x_{i}^{(2)} + \\beta_3 (x_{i}^{(1)} x_{i}^{(2)}) + \\epsilon_i$$\n\nwhere:\n\n* $x_{i}^{(1)}x_{i}^{(2)}$ is the product of the number of minutes of exercise and the diet of the $i$th participant.\n* $\\beta_3$ is the coefficient of the interaction term between diet and exercise.\n\nWe could also write this model as:\n\n$$y_i = \\beta_0 + \\beta_1 x_{i}^{(1)} + \\beta_2 x_{i}^{(2)} + \\beta_3 x_{i}^{(3)} + \\epsilon_i$$\n\nwhere:\n\n* $x_{i}^{(3)} = x_{i}^{(1)} x_{i}^{(2)}$\n\nThis is again a multiple regression model, but now with three explanatory variables.\n\n::: {.callout-tip}\n## Think, Pair, Share (#sketch-interaction)\n\nMake sketches of the possible relationships between diet, exercise and blood pressure. Make a sketch compatible with $\\beta_3 = 0$. Make a sketch compatible with $\\beta_3 \\neq 0$.\n:::\n\n## Hypothesis testing\n\nIf we want to test whether the effect of minutes of exercise on blood pressure is different for people with different diets, we need a null hypothesis to test.\n\n::: {.callout-tip}\n## Think, Pair, Share (#interaction-null)\n\nWhat is the null hypothesis in this case, verbally, and in terms of the coefficients of the model?\n:::\n\nThe null hypothesis is that the effect of minutes of exercise on blood pressure is the same for people with different diets. This is a null hypothesis of no interaction between diet and exercise. In terms of the coefficients of the model, the null hypothesis is that $\\beta_3 = 0$.\n\nIf we reject the null hypothesis, we conclude that the effect of minutes of exercise on blood pressure is different for people with different diets. This is a non-additive effect.\n\n\n## Doing it in R\n\nLet us fit the model with the interaction term in R. There are two methods to do this and they are equivalent:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmod1 <- lm(bp ~ mins_per_week + diet + mins_per_week:diet, data=bp_diet)\nmod2 <- lm(bp ~ mins_per_week * diet, data=bp_diet)\n```\n:::\n\n\nThe second is a shorthand for the first. The `*` operator includes the main effects (main effects are terms in the model that don't include interactions) and the interaction term. The `:` operator includes only the interaction term.\n\nOf course, we check the model diagnostics before we interpret the results:\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](6-interactions_files/figure-html/unnamed-chunk-22-1.png){width=480}\n:::\n:::\n\n\nAll of the plots look good.\n\nNow, let us look at the coefficients of the model:\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n```\n                                 Estimate Std. Error   t value     Pr(>|t|)\n(Intercept)                  100.62716134 2.87228930 35.033783 1.714199e-56\nmins_per_week                 -0.09661054 0.02406014 -4.015376 1.177969e-04\ndietvegetarian               -15.27591304 4.09882726 -3.726898 3.275630e-04\nmins_per_week:dietvegetarian   0.06907583 0.03433487  2.011828 4.704076e-02\n```\n:::\n:::\n\n\nAs expected, there are four coefficients.\n\nThe first is `(Intercept)`, which is the expected blood pressure for a person who does 0 minutes of exercise and is on diet \"meat heavy\".\n\nThe second is `mins_per_week`, which is the effect (slope) of minutes of exercise on blood pressure for a person on diet \"meat heavy\".\n\nThe third is `dietvegetarian`, which is the effect of being on a vegetarian diet on blood pressure for a person who does 0 minutes of exercise. This can be thought of as the change in the intercept for a person on a vegetarian diet compared to a person on a \"meat heavy\" diet.\n\nThe fourth is the interaction term `mins_per_week:dietvegetarian`, which is the difference in the effect (slope) of minutes of exercise on blood pressure for a person on a vegetarian diet compared to a person on a \"meat heavy\" diet.\n\n\n::: {.callout-tip}\n## Think, Pair, Share (#two-equations)\n\nWrite two equations, one for each of the two diets. They would look something like this: $y_i = 0.1 - 0.1 x_{i}^{(1)}$, but will have other numbers.\n:::\n\n## Reporting our findings\n\nOf course a nice graph is always helpful. We already have quite a nice one:\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](6-interactions_files/figure-html/unnamed-chunk-24-1.png){width=480}\n:::\n:::\n\n\nWe also might want some tables summarizing the model results. Here is a table of the coefficients:\n\n\n::: {.cell}\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table\" style=\"margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:left;\">   </th>\n   <th style=\"text-align:right;\"> Estimate </th>\n   <th style=\"text-align:right;\"> Std. Error </th>\n   <th style=\"text-align:right;\"> t value </th>\n   <th style=\"text-align:right;\"> Pr(&gt;|t|) </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> (Intercept) </td>\n   <td style=\"text-align:right;\"> 100.6271613 </td>\n   <td style=\"text-align:right;\"> 2.8722893 </td>\n   <td style=\"text-align:right;\"> 35.033783 </td>\n   <td style=\"text-align:right;\"> 0.0000000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> mins_per_week </td>\n   <td style=\"text-align:right;\"> -0.0966105 </td>\n   <td style=\"text-align:right;\"> 0.0240601 </td>\n   <td style=\"text-align:right;\"> -4.015377 </td>\n   <td style=\"text-align:right;\"> 0.0001178 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> dietvegetarian </td>\n   <td style=\"text-align:right;\"> -15.2759130 </td>\n   <td style=\"text-align:right;\"> 4.0988273 </td>\n   <td style=\"text-align:right;\"> -3.726898 </td>\n   <td style=\"text-align:right;\"> 0.0003276 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> mins_per_week:dietvegetarian </td>\n   <td style=\"text-align:right;\"> 0.0690758 </td>\n   <td style=\"text-align:right;\"> 0.0343349 </td>\n   <td style=\"text-align:right;\"> 2.011828 </td>\n   <td style=\"text-align:right;\"> 0.0470408 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\nWe could also report the $R^2$ of the model:\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.2732093\n```\n:::\n:::\n\n\nAnd also a table of the variances of the terms in the model:\n\n\n::: {.cell}\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table\" style=\"margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:left;\">   </th>\n   <th style=\"text-align:right;\"> Df </th>\n   <th style=\"text-align:right;\"> Sum Sq </th>\n   <th style=\"text-align:right;\"> Mean Sq </th>\n   <th style=\"text-align:right;\"> F value </th>\n   <th style=\"text-align:right;\"> Pr(&gt;F) </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> mins_per_week </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 1133.554 </td>\n   <td style=\"text-align:right;\"> 1133.55446 </td>\n   <td style=\"text-align:right;\"> 13.47998 </td>\n   <td style=\"text-align:right;\"> 0.0003964 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> diet </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 1560.753 </td>\n   <td style=\"text-align:right;\"> 1560.75255 </td>\n   <td style=\"text-align:right;\"> 18.56012 </td>\n   <td style=\"text-align:right;\"> 0.0000398 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> mins_per_week:diet </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 340.357 </td>\n   <td style=\"text-align:right;\"> 340.35702 </td>\n   <td style=\"text-align:right;\"> 4.04745 </td>\n   <td style=\"text-align:right;\"> 0.0470408 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Residuals </td>\n   <td style=\"text-align:right;\"> 96 </td>\n   <td style=\"text-align:right;\"> 8072.804 </td>\n   <td style=\"text-align:right;\"> 84.09171 </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\nWe also might use a sentence like this to report the results: \"The effect of minutes of exercise is generally negative, but the effect is stronger for people on a meat heavy diet than for people on a vegetarian diet ($t$-statistics of interaction term = 2.01, degree of freedom = 2, p = 0.05). The greater beneficial effect of exercise on blood pressure for people on a meat heavy diet is largely caused by the high blood pressure of people on a meat heavy diet that do not exercise.\"\n\n\n## Multiple regression vs. many single regressions\n\nQuestion: Why not just fit a separate simple regression model and then compare the two separately estimated slopes? That is, why not fit the two models:\n\n$$y_i = \\beta_{0,veg} + \\beta_{1,veg} x_i^{(1)} + \\epsilon_i$$ \n\n$$y_i = \\beta_{0,meat} + \\beta_{1,meat} x_i^{(2)} + \\epsilon_i$$\n\nand compare the estimate of $\\beta_{1,veg}$ to the estimate of $\\beta_{1,meat}$?\n\nWell, you could do that, and could probably find a way to test for whether the difference in the slopes is different from 0. This would be a test of the null hypothesis that the effect of minutes of exercise on blood pressure is the same for people with different diets. But, this would be a more complicated way to do it, and would not be as general as the model with the interaction term. The model with the interaction term is more general, more flexible, and more elegant.\n\n\n## Recap\n\n* Binary and categorical explanatory variables.\n* Interactions: a categorical explanatory variables allows for group-specific intercepts and slopes.\n* The $F$-test is used to test if $\\beta_1=\\beta_2=...=\\beta_k=0$ at the same time for a categorical explanatory variable with $k$ levels. Use the `anova` function in R to carry out this test.\n* The $F$-test is a generalization of the $t$-test, because the latter is used to test $\\beta_j = 0$ for one single variable $x^{(j)}$.  \n* Test for a single $\\beta_j=0$ $\\rightarrow$ $t$-test.\n* Test for several $\\beta_2 = ... = \\beta_{k}=0$ simultaneously $\\rightarrow$ $F$-test.\n\nThus you will *always* need the $F$-test `anova()` to obtain a $p$-value for a categorial explanatory variable with more than 2 levels. This is because such a variable is represented by more than one coefficient in the model (remember the dummy variables).\n\n\n\n\n\n",
    "supporting": [
      "6-interactions_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"site_libs/kePrint-0.0.1/kePrint.js\"></script>\n<link href=\"site_libs/lightable-0.0.1/lightable.css\" rel=\"stylesheet\" />\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}