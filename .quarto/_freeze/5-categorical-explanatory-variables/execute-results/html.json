{
  "hash": "f4a4ca91d4dacd9ec4487574180faa2e",
  "result": {
    "markdown": "::: {.cell}\n\n:::\n\n\n\n\n\n# Categorical explanatory variables (L5) {.unnumbered}\n\nThis chapter contains the content of the fifth lecture of the course BIO144 Data Analysis in Biology at the University of Zurich.\n\n## Introduction\n\nWe so far only considered continuous explanatory variables. Today we will look at the following topics:\n\n* Binary explanatory variables.\n* Categorical explanatory variables.\n\n\n\n### The good news\n\nThe good news is that the mathematical model of a linear regression does not change when we include binary or categorical explanatory variables. The model is still:\n\n$$y_i = \\beta_0 + \\beta_1 x^{(1)}_i + \\beta_2 x^{(2)}_i + \\ldots + \\epsilon_i$$\n\nThis means that things like the $R^2$, $F$-test, $t$-test, confidence intervals, etc. are still applicable. We also carry out model diagnostics mostly in the same way. So a lot of what you already learned is useful here. I suppose this is a good thing, since you don't have to learn it again. But it also means that you have to have learned and understood it by now. If you haven't, please reach out for assistance.\n\n### The bad news\n\nThere isn't any.\n\n## Binary explanatory variables\n\nImagine the question \"do people who smoke have higher blood pressure?\" Though we could quantify the amount of smoking, we could also just ask if someone smokes or not. This is a binary variable. We can put that information into a variable $x$ where values $x_i$ can take on the values 0 or 1, where 0 denotes non-smoker and 1 denotes smoker. The linear model is then:\n\n$$y_i = \\beta_0 + \\beta_1 x_i + \\epsilon_i$$\nHuh? This is exactly the same model as when the explanatory variable $x$ is continuous. The only difference is that $x_i$ can only be a zero or a one. The interpretation of the $\\beta_1$ is also the same: it is the change in the response variable $y$ when $x$ changes by one unit. In this case, the change is from non-smoker to smoker.\n\n::: {.callout-tip}\n## Think, Pair, Share (#bp-nonsmoker)\n\nWhat is the predicted value of $y$ for a non-smoker? And for a smoker?\n:::\n\n\nThe $\\beta_1$ can be thought of as the effect on blood pressure of smoking. If $\\beta_1$ is positive, smoking increases blood pressure. If $\\beta_1$ is negative, smoking decreases blood pressure.\n\nFor the question of whether smoking influences blood pressure we can formulate a null and an alternative hypothesis.\n\n* Null hypothesis: $\\beta_1 = 0$. That is, smoking has no effect on blood pressure.\n* Alternative hypothesis: $\\beta_1 \\neq 0$. That is, smoking has an effect on blood pressure.\n\n\n::: {.callout-tip}\n## Think, Pair, Share (#null-test)\n\nWhat statistical test can we use to test the null hypothesis here?\n:::\n\n\nLet's take a graphical view of the case of a binary response variable.\n\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n![](5-categorical-explanatory-variables_files/figure-html/unnamed-chunk-3-1.png){width=480}\n:::\n:::\n\n\n\n::: {.callout-tip}\n## Think, Pair, Share (#draw-coefficients)\n\nDraw on the graph a representation of the model $\\beta_0$, $\\beta_1$, and $\\beta_0 + \\beta_1$.\n:::\n\n\nHere is a graph showing the mean of the two groups (non-smoker and smoker) and a vertical line for the difference between the two means:\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](5-categorical-explanatory-variables_files/figure-html/unnamed-chunk-4-1.png){width=480}\n:::\n:::\n\n\n\n### Example: Smoking and blood pressure\n\nLet's do a real example. We have data on blood pressure and smoking status. We want to know if smoking has an effect on blood pressure.\n\nTo fit the linear model in R, we use the `lm` function as before. The only difference is that the explanatory variable is binary. But we do not need to tell this to R. It can handle things just fine. So, the code to fit the model is:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmod_smoking <- lm(bp ~ smoke_01, data = bp_data_smoking)\n```\n:::\n\n\nOf course, we next look at the model diagnostic plots to see if the model assumptions are met.\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](5-categorical-explanatory-variables_files/figure-html/unnamed-chunk-6-1.png){width=480}\n:::\n:::\n\n\nThe QQ-plot shows that the residuals are close enough to the normal distribution.\n\nThe other plots are a little different from before, because we have only two fitted, one for non-smokers and one for smokers. But we can still see that the residuals show no clear difference between the two groups. Also there is no leverage plot, due to all leverages being equal (all data points are equal distance from $\\hat{x}$)\n\nHere is how it could have looked if smoking also increased the variability in the blood pressure among individuals:\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](5-categorical-explanatory-variables_files/figure-html/unnamed-chunk-7-1.png){width=480}\n:::\n:::\n\n\nIt is clear that not only does smoking increase the mean blood pressure, but it also increases the inter-individuals (between individual) variability in blood pressure.\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](5-categorical-explanatory-variables_files/figure-html/unnamed-chunk-8-1.png){width=480}\n:::\n:::\n\n\nWe can see in the residuals vs. fitted plot that the residuals of the non-smokers are less spread out than the residuals of the smokers. This is a sign of heteroscedasticity (difference in variance among groups).\n\n### Does smoking have an effect on blood pressure?\n\nWe address this question by testing the null hypothesis of no effect of smoking on blood pressure? This null hypothesis corresponds to $\\beta_1 = 0$. This is the same as testing if the slope of the line is different from zero, for which we use a $t$-test.\n\nHere is the table of estimates and the $t$-test:\n\n\n::: {.cell}\n::: {.cell-output-display}\n```{=html}\n<div id=\"zeznzkjobv\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#zeznzkjobv table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#zeznzkjobv thead, #zeznzkjobv tbody, #zeznzkjobv tfoot, #zeznzkjobv tr, #zeznzkjobv td, #zeznzkjobv th {\n  border-style: none;\n}\n\n#zeznzkjobv p {\n  margin: 0;\n  padding: 0;\n}\n\n#zeznzkjobv .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#zeznzkjobv .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#zeznzkjobv .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#zeznzkjobv .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#zeznzkjobv .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#zeznzkjobv .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#zeznzkjobv .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#zeznzkjobv .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#zeznzkjobv .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#zeznzkjobv .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#zeznzkjobv .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#zeznzkjobv .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#zeznzkjobv .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#zeznzkjobv .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#zeznzkjobv .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#zeznzkjobv .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#zeznzkjobv .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#zeznzkjobv .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#zeznzkjobv .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#zeznzkjobv .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#zeznzkjobv .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#zeznzkjobv .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#zeznzkjobv .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#zeznzkjobv .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#zeznzkjobv .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#zeznzkjobv .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#zeznzkjobv .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#zeznzkjobv .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#zeznzkjobv .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#zeznzkjobv .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#zeznzkjobv .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#zeznzkjobv .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#zeznzkjobv .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#zeznzkjobv .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#zeznzkjobv .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#zeznzkjobv .gt_left {\n  text-align: left;\n}\n\n#zeznzkjobv .gt_center {\n  text-align: center;\n}\n\n#zeznzkjobv .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#zeznzkjobv .gt_font_normal {\n  font-weight: normal;\n}\n\n#zeznzkjobv .gt_font_bold {\n  font-weight: bold;\n}\n\n#zeznzkjobv .gt_font_italic {\n  font-style: italic;\n}\n\n#zeznzkjobv .gt_super {\n  font-size: 65%;\n}\n\n#zeznzkjobv .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#zeznzkjobv .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#zeznzkjobv .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#zeznzkjobv .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#zeznzkjobv .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#zeznzkjobv .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#zeznzkjobv .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#zeznzkjobv .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#zeznzkjobv div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"label\"><span data-qmd-base64=\"PHN0cm9uZz5DaGFyYWN0ZXJpc3RpYzwvc3Ryb25nPg==\"><span class='gt_from_md'><strong>Characteristic</strong></span></span></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"estimate\"><span data-qmd-base64=\"PHN0cm9uZz5CZXRhPC9zdHJvbmc+\"><span class='gt_from_md'><strong>Beta</strong></span></span></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"conf.low\"><span data-qmd-base64=\"PHN0cm9uZz45NSUgQ0k8L3N0cm9uZz4=\"><span class='gt_from_md'><strong>95% CI</strong></span></span><span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;\"><sup>1</sup></span></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"p.value\"><span data-qmd-base64=\"PHN0cm9uZz5wLXZhbHVlPC9zdHJvbmc+\"><span class='gt_from_md'><strong>p-value</strong></span></span></th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">smoke_01</td>\n<td headers=\"estimate\" class=\"gt_row gt_center\">15</td>\n<td headers=\"conf.low\" class=\"gt_row gt_center\">14, 16</td>\n<td headers=\"p.value\" class=\"gt_row gt_center\"><0.001</td></tr>\n  </tbody>\n  \n  <tfoot class=\"gt_footnotes\">\n    <tr>\n      <td class=\"gt_footnote\" colspan=\"4\"><span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;\"><sup>1</sup></span> <span data-qmd-base64=\"Q0kgPSBDb25maWRlbmNlIEludGVydmFs\"><span class='gt_from_md'>CI = Confidence Interval</span></span></td>\n    </tr>\n  </tfoot>\n</table>\n</div>\n```\n:::\n:::\n\n\nOr for more information:\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n```\n            Estimate Std. Error   t value     Pr(>|t|)\n(Intercept) 80.05943  0.5555174 144.11687 5.847322e-65\nsmoke_01    14.87147  0.6457759  23.02884 1.363653e-27\n```\n:::\n:::\n\n\nThere is very clear evidence that smoking increases blood pressure. The $p$-value is very small.\n\n### Reporting our findings\n\nAn appropriate graph would be a scatter plot of blood pressure against smoking status, just like we made above. You may see graphs of such data that are bar graphs with error bars. This is not a good way to present the data, because it hides the individual data points and their distribution. It is better to show the individual data points. If there are very many data points, however, a box and whisker plot may be more informative.\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](5-categorical-explanatory-variables_files/figure-html/unnamed-chunk-11-1.png){width=480}\n:::\n:::\n\n\n\nAn appropriate sentence to write about our results would be. \"We found that smoking increases blood pressure by 15 units (95% CI: 14 to 17 units, $t = 25.8$, $p < 0.001$, $df = 48$).\" This sentence gives the effect size, the confidence interval, and the $t$-test results. **It is a sentence about the the effect of smoking.**\n\nNot so good would be to write: \"There was a statistically significant effect of smoking on blood pressure ($t = 25.8$, $p < 0.001$, $df = 48$).\" -- This is not informative; it does not even give the direction of the effect. **It is a sentence about statistical significance.**.\n\n**Generally speaking, put the focus on the effect/relationship, not on the statistical significance.**\n\n\n### Words instead of 0/1\n\nIn the smoking explanatory variable we denoted a non-smoker with a 0 and a smoker with a 1. Could we instead have denoted a non-smoker with the word \"non-smoker\" and a smoker with the word \"smoker\"? Lets see how the `lm` function feels about that.\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n```\n        bp     status\n1 97.98418     smoker\n2 94.61055     smoker\n3 79.31794 non-smoker\n4 95.37587     smoker\n5 93.19786     smoker\n6 97.08017     smoker\n```\n:::\n:::\n\n\nThe data now has the variable that describes smoker status as a word. Here's a graph of that data:\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](5-categorical-explanatory-variables_files/figure-html/unnamed-chunk-13-1.png){width=480}\n:::\n:::\n\n\nVery nice. Now we can fit the model:\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n```\n             Estimate Std. Error   t value     Pr(>|t|)\n(Intercept)  80.05943  0.5555174 144.11687 5.847322e-65\nstatussmoker 14.87147  0.6457759  23.02884 1.363653e-27\n```\n:::\n:::\n\n\nThe numbers in this table are exactly the same as before, when we used the 0/1 coding. The `lm` function is pretty smart. It recodes the two levels (non-smoker and smoker) in the status variable to be a binary variable. The `summary` function then gives the estimates for the two levels.\n\n\n::: {.cell}\n\n:::\n\n\nWe can also get the $R^2$ value, and it has the same meaning and is calculated in the same way.\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.9170021\n```\n:::\n:::\n\n\nSo, a linear model with a binary explanatory variable very similiar to a linear model with a continuous explanatory variable. A difference is that the estimates are not slopes, but differences in means between the two groups.\n\n::: {.callout-note}\nA linear model with a binary explanatory variable is the same as a two-sample $t$-test:\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n```\n\n\tTwo Sample t-test\n\ndata:  bp by status\nt = -23.029, df = 48, p-value < 2.2e-16\nalternative hypothesis: true difference in means between group non-smoker and group smoker is not equal to 0\n95 percent confidence interval:\n -16.16989 -13.57305\nsample estimates:\nmean in group non-smoker     mean in group smoker \n                80.05943                 94.93091 \n```\n:::\n:::\n\n\nThe value of $t$-statistic is the same as exactly the value of the $t$-statistic in the linear output. It is exactly the same test.\n:::\n\n\n::: {.callout-note}\nYou may hear the term \"binary regression\" or \"logistic regression\" in the future. This is a different type of regression model that is used when the response variable is binary. The model we are talking about here is called \"linear regression with binary explanatory variables\".\n:::\n\n\n::: {.callout-note}\nIn all that went above, we assumed that observations were independent. I.e., we assumed there were 50 truly independent observation. This is a very strong assumption. In reality, we might have made more than one measure of blood pressure from one individual. This is called \"clustering\" or \"repeated measures\". A consequence would be that we not then have 50 truly independent observation, we would have fewer than 50, and so we would have fewer than 48 degrees of freedom for error. We will talk about this again later in the course.\n:::\n\n## Categorical explanatory variables\n\nImage we have a new question: \"Is a person's blood pressure related to their diet?\" We have data on the diet of 50 people and we have coded their diets as: \"meat heavy\", \"Mediterranean\", \"vegetarian\", and \"vegan\".\n\nHere is an example dataset:\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 3\n  diet             bp person_ID\n  <chr>         <dbl> <chr>    \n1 meat heavy      120 person_1 \n2 vegan            89 person_2 \n3 vegetarian       86 person_3 \n4 meat heavy      116 person_4 \n5 Mediterranean   115 person_5 \n6 meat heavy      134 person_6 \n```\n:::\n:::\n\n\nAnd here's a graph of the dataset:\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](5-categorical-explanatory-variables_files/figure-html/unnamed-chunk-19-1.png){width=480}\n:::\n:::\n\n\nWe can see quite a lot from this, for example that the \"meat heavy\" diet is associated with higher blood pressure.\n\nBut how can a linear model be used with such an explanatory variable?\n\n### Dummy variables\n\nThe trick is to convert the categorical variable into a set of binary variables. For a categorical variable with $k$ levels, we create $k - 1$ binary variables $x_i^{(j)}$.\n\nWe already did this with the smoking status variable. It contained two levels, \"non-smoker\" and \"smoker\". We created a binary variable $x_i^{(1)}$ that was 1 if the $i$-th person was a smoker and 0 if they were a non-smoker. That is, the categorical variable *smoking status* had $k = 2$ levels which were recoded into $k - 1 = 1$ binary variables.\n\nFor the diet variable, we have $k = 4$ levels. So we should create $k - 1 = 3$ binary variables. We create one less than the number of levels because the last level is the \"baseline\" level. The baseline level is the level that the other levels are compared to. In this case, the baseline level is \"meat heavy\". The other levels are compared to \"meat heavy\".\n\nAnother way to think about why we need one less binary variable than the number of levels is that when meat_heavy = 0 & Mediterranean = 0 & vegetarian = 0, we there is no other possibility than the person has a vegan diet. We infer the vegan diet from a process of elimination of the other possibilities. This is why we only need three binary variables, and more generally only need $k - 1$ binary variables for a categorical variable with $k$ levels.\n\nHere is the dataset with four binary variables:\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 7\n  diet             bp person_ID meat_heavy Mediterranean vegetarian vegan\n  <chr>         <dbl> <chr>          <dbl>         <dbl>      <dbl> <dbl>\n1 meat heavy      120 person_1           1             0          0     0\n2 vegan            89 person_2           0             0          0     1\n3 vegetarian       86 person_3           0             0          1     0\n4 meat heavy      116 person_4           1             0          0     0\n5 Mediterranean   115 person_5           0             1          0     0\n6 meat heavy      134 person_6           1             0          0     0\n```\n:::\n:::\n\n\nAnd here it is with three:\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 6\n  diet             bp person_ID Mediterranean vegetarian vegan\n  <chr>         <dbl> <chr>             <dbl>      <dbl> <dbl>\n1 meat heavy      120 person_1              0          0     0\n2 vegan            89 person_2              0          0     1\n3 vegetarian       86 person_3              0          1     0\n4 meat heavy      116 person_4              0          0     0\n5 Mediterranean   115 person_5              1          0     0\n6 meat heavy      134 person_6              0          0     0\n```\n:::\n:::\n\n\nThe point is that the second table with one less binary variable has exactly the same information as the first table with four binary variables. It has the same information because we know that there are only four possible diets in the dataset.\n\nNow we can use the following linear model, which has three binary explanatory variables:\n\n$$y_i = \\beta_0 + \\beta_1 x_i^{(1)} + \\beta_2 x_i^{(2)} + \\beta_3 x_i^{(3)} + \\epsilon_i$$\n\nwhere $x_i^{(1)}$ is the binary variable for the Mediterranean diet, $x_i^{(2)}$ is the binary variable for the vegetarian diet, and $x_i^{(3)}$ is the binary variable for the vegan diet.\n\n\n::: {.callout-tip}\n## Think, Pair, Share (#beta0-meaning)\n\nQuestion: What is the interpretation of $\\beta_0$ in this model?\n:::\n\n\nIt is the expected value of the response variable when all the explanatory variables are zero. I.e., it is the intercept. In this case, it is the expected blood pressure of a person on a meat heavy diet because the meat heavy diet is the baseline diet.\n\nMathematically, $\\hat{y} = \\beta_0$ when $x_i^{(1)} = x_i^{(2)} = x_i^{(3)} = 0$. This is the case when the person is on a meat heavy diet, because $x_i^{(1)} = 0$ means not on a Mediterranean diet, $x_i^{(2)} = 0$ means not on a vegetarian diet, and $x_i^{(3)} = 0$ means not on a vegan diet.\n\n::: {.callout-tip}\n## Think, Pair, Share (#beta1-meaning)\n\nWhat is the interpretation of $\\beta_1$ in this model?\n:::\n\nRecall the meaning of the $\\beta_j$ coefficients in the model of smoking effects on blood pressure. It was the expected difference in blood pressure between a smoker and a non-smoker. In this model, $\\beta_1$ is the expected difference in blood pressure between a person on a Mediterranean diet and a person on a meat heavy diet.\n\n**Question:** What is the interpretation of $\\beta_2$ in this model?\n\n**Answer:** $\\beta_2$ is the expected difference in blood pressure between a person on a vegetarian diet and a person on a meat heavy diet.\n\n**Question:** What is the interpretation of $\\beta_3$ in this model?\n\n**Answer:** $\\beta_3$ is the expected difference in blood pressure between a person on a vegan diet and a person on a meat heavy diet.\n\nSo, each of the three coefficients $\\beta_1$, $\\beta_2$, and $\\beta_3$ is the expected difference in blood pressure between a person on a particular diet and a person on the meat heavy diet. Meat heavy is the reference / intercept diet.\n\n### In a visualisation\n\nHere is a visualisation of the model:\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stderr}\n```\n`summarise()` has grouped output by 'diet'. You can override using the\n`.groups` argument.\n```\n:::\n\n::: {.cell-output-display}\n![](5-categorical-explanatory-variables_files/figure-html/unnamed-chunk-22-1.png){width=480}\n:::\n:::\n\n\n### Degrees of freedom of a categorical variable\n\nWhen we fit a single categorical variable to the data we are fitting a model with $k$ levels. However, the degrees of freedom of a categorical variable with $k$ levels is $k-1$. This is because one degree of freedom corresponds to the intercept, and the remaining $k-1$ degrees of freedom correspond to the $k-1$ coefficients of the $k-1$ dummy variables.\n\nSo, generally speaking, the degrees of freedom used up a categorical variable with $k$ levels is $k-1$.\n\n### Doing it in R\n\nIn R, we can fit a linear model with a categorical variable using the `lm()` function. And we don't need to make the dummy binary variables. That is all very conveniently done in the inner workings of the `lm()` function. Here we go:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbp_model_diet <- lm(bp ~ diet, data = bp_data_diet)\n```\n:::\n\n\nNo news is good news!\n\nCheck the diagnostic plots to assess if the model assumptions are met.\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](5-categorical-explanatory-variables_files/figure-html/unnamed-chunk-24-1.png){width=480}\n:::\n:::\n\n\nNo patterns in the residuals, QQ-plot data close to the line, and the residuals are homoscedastic. No evidence of outliers. The model assumptions are met.\n\n\n\nLet's look at the estimates of the coefficients and their $t$-statistics and $p$-values.\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n```\n                   Estimate Std. Error   t value     Pr(>|t|)\n(Intercept)       122.62500   2.302393 53.259813 5.494274e-43\ndietMediterranean -12.68750   3.256075 -3.896563 3.144677e-04\ndietvegan         -26.76786   4.173441 -6.413858 6.922791e-08\ndietvegetarian    -23.62500   3.607156 -6.549481 4.328870e-08\n```\n:::\n:::\n\n\n\n\n::: {.callout-tip}\n## Think, Pair, Share (#beta-conclusions)\n\nWhat can we conclude from the values of the three $\\beta$ coefficients?\n:::\n\nThe three non-intercept coefficients are the $\\beta_1$, $\\beta_2$, and $\\beta_3$ coefficients. The value of each is negative, which means that the blood pressure is lower on the Mediterranean, vegetarian, and vegan diets compared to the meat heavy diet.\n\nThe $t$-statistics and $p$-values are also given. The $p$-values are all less than 0.05, so we can reject the null hypothesis that the coefficients are zero. This means that the blood pressure is significantly lower on the Mediterranean, vegetarian, and vegan diets compared to the meat heavy diet.\n\nJust for fun, let's fit the model using the three binary dummy variables:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbp_model_diet_bin <- lm(bp ~ Mediterranean + vegetarian + vegan, data = bp_data_diet)\nsummary(bp_model_diet_bin)$coefficients\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n               Estimate Std. Error   t value     Pr(>|t|)\n(Intercept)   122.62500   2.302393 53.259813 5.494274e-43\nMediterranean -12.68750   3.256075 -3.896563 3.144677e-04\nvegetarian    -23.62500   3.607156 -6.549481 4.328870e-08\nvegan         -26.76786   4.173441 -6.413858 6.922791e-08\n```\n:::\n:::\n\n\nExactly the same :)\n\nAnd for even more fun, lets see what happens if we fit a model with four binary variables, one for each diet.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbp_data_diet_bin <- bp_data_diet %>%\n  select(bp, meat_heavy, Mediterranean, vegetarian, vegan)\nbp_model_diet_bin_all <- lm(bp ~ - Mediterranean + vegetarian + vegan + meat_heavy,\n                            data = bp_data_diet_bin)\nsummary(bp_model_diet_bin_all)$coefficients\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n             Estimate Std. Error   t value     Pr(>|t|)\n(Intercept) 109.93750   2.302393 47.749241 7.652542e-41\nvegetarian  -10.93750   3.607156 -3.032167 3.980698e-03\nvegan       -14.08036   4.173441 -3.373800 1.513076e-03\nmeat_heavy   12.68750   3.256075  3.896563 3.144677e-04\n```\n:::\n:::\n\n\nThe `lm` function has dropped the `meat_heavy` variable because it is perfectly collinear with the other three variables. This is because the sum of the four binary variables is always 1. This is called the dummy variable trap. The `lm` function is smart enough to drop one of the variables to avoid the trap.\n\n### Is diet important for blood pressure?\n\nWhen we want to answer the question \"is diet important for blood pressure\" we likely want to understand if there are *any* differences between diets. This is very similar to when we asked in multiple regression if *any* of the slopes are different from zero. Recall that then we used an $F$-test. We can do the same here.\n\nThe null hypothesis is that all the coefficients are zero, which means that the diet has no effect on blood pressure. The alternative hypothesis is that at least one of the coefficients is different from zero, which means that at least one diet has an effect on blood pressure.\n\nAnother way to express the null hypothesis is that diet does not explain a significant amount of the variance in blood pressure. The alternative hypothesis is that diet explains a significant amount of the variance in blood pressure.\n\nVariance explained by diet is quantified by the sum of squares associated with the diet variable. This is the model sum of squares, SSM.\n\nAs before, the $F$-statistic is the ratio the mean square of the model to the mean square of the residuals:\n\n$$F = \\frac{MSE_{model}}{MSE_{residual}} = \\frac{SSM/(k-1)}{SSE/(n -1 - (k -1))}$$\n\nwhere $k$ is the number of levels of the categorical variable and $n$ is the number of observations.\n\n::: {.callout-note}\n$(n - 1)$ is the total number of degrees of freedom in the model. $(k - 1)$ is the number of degrees of freedom used up by the categorical variable. $(n - 1 - (k - 1))$ is the number of degrees of freedom left over for the residuals. This simplifies to $n - k$.\n:::\n\n\nThe $F$-statistic is compared to the $F$-distribution with $k-1$ and $(n -1 - (k -1)) = n-k$) degrees of freedom.\n\nLet's do the $F$-test for the diet variable:\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n```\nAnalysis of Variance Table\n\nResponse: bp\n          Df Sum Sq Mean Sq F value    Pr(>F)    \ndiet       3 5274.2 1758.08  20.728 1.214e-08 ***\nResiduals 46 3901.5   84.82                      \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n:::\n\n\nThe $p$-value is less than 0.05, so we can reject the null hypothesis that diet has no effect on blood pressure.\n\n::: {.callout-tip}\n## Think, Pair, Share (#table-rsquared)\n\nCalculate the $R^2$ for the model from the ANOVA table.\n:::\n\n\n::: {.callout-tip}\n\nLet's use the lovely `gtsummary` package to summarize the model.\n\n\n::: {.cell}\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-hover table-condensed table-responsive\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n<caption>ANOVA Table: Linear Model Analysis</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;font-weight: bold;color: white !important;background-color: gray !important;\"> Term </th>\n   <th style=\"text-align:right;font-weight: bold;color: white !important;background-color: gray !important;\"> DF </th>\n   <th style=\"text-align:right;font-weight: bold;color: white !important;background-color: gray !important;\"> Sum of Squares </th>\n   <th style=\"text-align:right;font-weight: bold;color: white !important;background-color: gray !important;\"> Mean Square </th>\n   <th style=\"text-align:right;font-weight: bold;color: white !important;background-color: gray !important;\"> F Statistic </th>\n   <th style=\"text-align:right;font-weight: bold;color: white !important;background-color: gray !important;\"> P Value </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> diet </td>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:right;\"> 5274.235 </td>\n   <td style=\"text-align:right;\"> 1758.078 </td>\n   <td style=\"text-align:right;\"> 20.728 </td>\n   <td style=\"text-align:right;font-weight: bold;color: black !important;\"> 0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Residuals </td>\n   <td style=\"text-align:right;\"> 46 </td>\n   <td style=\"text-align:right;\"> 3901.545 </td>\n   <td style=\"text-align:right;\"> 84.816 </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;font-weight: bold;color: black !important;\"> NA </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n:::\n\n\n\n## Additional reading\n\nIf you'd like to read another perspective please feel free to take a look at Chapters 3.2u-x, 3.3, 4.1-4.5 in *Lineare Regression*.\n",
    "supporting": [
      "5-categorical-explanatory-variables_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"site_libs/kePrint-0.0.1/kePrint.js\"></script>\n<link href=\"site_libs/lightable-0.0.1/lightable.css\" rel=\"stylesheet\" />\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}