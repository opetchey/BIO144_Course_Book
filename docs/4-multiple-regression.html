<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.433">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>BIO144 Course Book - Multiple regression (L4)</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./5-categorical-explanatory-variables.html" rel="next">
<link href="./3-regression.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<link href="site_libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">
<script src="site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<script src="site_libs/plotly-binding-4.10.4/plotly.js"></script>
<script src="site_libs/typedarray-0.1/typedarray.min.js"></script>
<script src="site_libs/jquery-3.5.1/jquery.min.js"></script>
<link href="site_libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">
<script src="site_libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>
<link href="site_libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="site_libs/plotly-main-2.11.1/plotly-latest.min.js"></script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./4-multiple-regression.html">Multiple regression (L4)</a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">BIO144 Course Book</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1-intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction (L1)</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2-data-wrangling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data wrangling (L2)</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./3-regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Regression (L3&amp;4)</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./4-multiple-regression.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Multiple regression (L4)</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./5-categorical-explanatory-variables.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Categorical explanatory variables (L5)</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./6-interactions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Interactions (L5)</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./7-ANOVA.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ANOVA (L6)</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./8-ANCOVA.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ANCOVA (L7)</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./9-linear-algebra.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Linear algebra (L7)</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10-variable-selection.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Variable selection (L8)</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11-interpretation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Intepretation, causality, and cautionary notes (L9)</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./12-count-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Count data (L10)</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./13-binary-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Binary data (L11)</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./14-measurement-error.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Measurement error (L12)</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./15-mixed-models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Mixed models (L12)</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./16-what-next.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">What next (L12)</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a></li>
  <li><a href="#the-multiple-linear-regression-model" id="toc-the-multiple-linear-regression-model" class="nav-link" data-scroll-target="#the-multiple-linear-regression-model">The multiple linear regression model</a>
  <ul class="collapse">
  <li><a href="#the-model" id="toc-the-model" class="nav-link" data-scroll-target="#the-model">The model</a></li>
  <li><a href="#the-blood-pressure-example" id="toc-the-blood-pressure-example" class="nav-link" data-scroll-target="#the-blood-pressure-example">The blood pressure example</a></li>
  <li><a href="#we-already-know-a-lot" id="toc-we-already-know-a-lot" class="nav-link" data-scroll-target="#we-already-know-a-lot">We already know a lot!</a></li>
  <li><a href="#fitting-the-model" id="toc-fitting-the-model" class="nav-link" data-scroll-target="#fitting-the-model">Fitting the model</a></li>
  <li><a href="#checking-the-assumptions" id="toc-checking-the-assumptions" class="nav-link" data-scroll-target="#checking-the-assumptions">Checking the assumptions</a></li>
  </ul></li>
  <li><a href="#question-1-as-an-ensemble-are-the-explanatory-variables-associated-with-the-response" id="toc-question-1-as-an-ensemble-are-the-explanatory-variables-associated-with-the-response" class="nav-link" data-scroll-target="#question-1-as-an-ensemble-are-the-explanatory-variables-associated-with-the-response">Question 1: As an ensemble, are the explanatory variables associated with the response?</a>
  <ul class="collapse">
  <li><a href="#but-what-is-the-f-statistic" id="toc-but-what-is-the-f-statistic" class="nav-link" data-scroll-target="#but-what-is-the-f-statistic">But what is the <span class="math inline">\(F\)</span>-statistic?</a></li>
  <li><a href="#calculating-the-f-statistic" id="toc-calculating-the-f-statistic" class="nav-link" data-scroll-target="#calculating-the-f-statistic">Calculating the F-statistic</a></li>
  <li><a href="#sst-ssm-sse-and-degrees-of-freedom" id="toc-sst-ssm-sse-and-degrees-of-freedom" class="nav-link" data-scroll-target="#sst-ssm-sse-and-degrees-of-freedom"><span class="math inline">\(SST\)</span>, <span class="math inline">\(SSM\)</span>, <span class="math inline">\(SSE\)</span>, and degrees of freedom</a></li>
  <li><a href="#is-my-f-statistic-large-or-small" id="toc-is-my-f-statistic-large-or-small" class="nav-link" data-scroll-target="#is-my-f-statistic-large-or-small">Is my <span class="math inline">\(F\)</span>-statistic large or small?</a></li>
  <li><a href="#source-of-variance-table" id="toc-source-of-variance-table" class="nav-link" data-scroll-target="#source-of-variance-table">Source of variance table</a></li>
  <li><a href="#the-blood-pressure-example-1" id="toc-the-blood-pressure-example-1" class="nav-link" data-scroll-target="#the-blood-pressure-example-1">The blood pressure example</a></li>
  </ul></li>
  <li><a href="#question-2-which-variables-are-associated-with-the-response" id="toc-question-2-which-variables-are-associated-with-the-response" class="nav-link" data-scroll-target="#question-2-which-variables-are-associated-with-the-response">Question 2: Which variables are associated with the response?</a></li>
  <li><a href="#question-3-what-proportion-of-variability-is-explained" id="toc-question-3-what-proportion-of-variability-is-explained" class="nav-link" data-scroll-target="#question-3-what-proportion-of-variability-is-explained">Question 3: What proportion of variability is explained?</a>
  <ul class="collapse">
  <li><a href="#multiple-r2" id="toc-multiple-r2" class="nav-link" data-scroll-target="#multiple-r2">Multiple <span class="math inline">\(R^2\)</span></a></li>
  <li><a href="#adjusted-r2" id="toc-adjusted-r2" class="nav-link" data-scroll-target="#adjusted-r2">Adjusted <span class="math inline">\(R^2\)</span></a></li>
  </ul></li>
  <li><a href="#question-4-are-some-explanatory-variables-more-important-than-others" id="toc-question-4-are-some-explanatory-variables-more-important-than-others" class="nav-link" data-scroll-target="#question-4-are-some-explanatory-variables-more-important-than-others">Question 4: Are some explanatory variables more important than others?</a></li>
  <li><a href="#an-elephant-in-the-room-collinearity" id="toc-an-elephant-in-the-room-collinearity" class="nav-link" data-scroll-target="#an-elephant-in-the-room-collinearity">An elephant in the room: collinearity</a></li>
  <li><a href="#recap" id="toc-recap" class="nav-link" data-scroll-target="#recap">Recap</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Multiple regression (L4)</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>This chapter contains the content of the fourth lecture of the course BIO144 Data Analysis in Biology at the University of Zurich.</p>
<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>We previously looked at whether blood pressure is associated with age. This is an important question, because blood pressure has many health implications. However, blood pressure is not only associated with age, but also with other factors, such as weight, height, and lifestyle. In this chapter, we will look at how to investigate the association between blood pressure and multiple explanatory variables.</p>
<p>When we have multiple explanatory variables, we are often interested in questions such as:</p>
<ul>
<li>Question 1: As an ensemble, are the explanatory variables associated with the response?</li>
<li>Question 2: Are each of the explanatory variables associated with the response?</li>
<li>Question 3: What proportion of variability is explained?</li>
<li>Question 4: Are some explanatory variables more important than others?</li>
</ul>
<p>Lets get an example of blood pressure data, with age and lifestyle as two explanatory variables. Lifestyle will be a continuous variable that is the number of minutes of exercise per week.</p>
<p><a href="data/bp_age_exercise.csv" download=""> Download the dataset. </a></p>
<p>Here is a look at the dataset:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>  X age mins_exercise  bp
1 1  38           180  84
2 2  68           100 117
3 3  45           147  96
4 4  73           287  95
5 5  77           145 105
6 6  23           268  75</code></pre>
</div>
</div>
<p>We can get insights by visualising the data by looking at three graphs:</p>
<ol type="1">
<li>Age vs blood pressure. This is the graph of the response variable (blood pressure) against one of the explanatory variables (age). It looks like there is evidence of a positive relationship.</li>
</ol>
<div class="cell">
<div class="cell-output-display">
<p><img src="4-multiple-regression_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="480"></p>
</div>
</div>
<ol start="2" type="1">
<li>Minutes of exercise vs blood pressure. This is a graph of the response variable (blood pressure) against the other explanatory variable (minutes of exercise). It looks like there is evidence of a negative relationship.</li>
</ol>
<div class="cell">
<div class="cell-output-display">
<p><img src="4-multiple-regression_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="480"></p>
</div>
</div>
<ol start="3" type="1">
<li>Age vs minutes of exercise. This is a graph of the two explanatory variables against each other. It looks like there is no relationship.</li>
</ol>
<div class="cell">
<div class="cell-output-display">
<p><img src="4-multiple-regression_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="480"></p>
</div>
</div>
<p>We can also look at this in a plot with three axes. The y-axis is blood pressure, the x-axis is age, and the z-axis is minutes of exercise. Here is a 3d plot that we can interactive with and rotate:</p>
<div class="cell">
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-d58fa413d9f6f471c03e" style="width:100%;height:650px;"></div>
<script type="application/json" data-for="htmlwidget-d58fa413d9f6f471c03e">{"x":{"visdat":{"52764fcea08b":["function () ","plotlyVisDat"]},"cur_data":"52764fcea08b","attrs":{"52764fcea08b":{"x":{},"y":{},"z":{},"mode":"markers","marker":{"size":5},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter3d"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"scene":{"xaxis":{"title":"age"},"yaxis":{"title":"mins_exercise"},"zaxis":{"title":"bp"}},"hovermode":"closest","showlegend":false},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[38,68,45,73,77,23,52,74,54,48,78,48,61,55,27,74,35,23,40,78,74,62,59,80,60,63,53,56,38,29,78,75,62,68,22,49,66,33,40,34,29,45,45,43,30,29,34,48,36,72,23,47,68,28,54,33,28,66,74,43,60,26,44,37,69,47,69,69,68,47,66,58,63,21,49,34,43,57,42,27,35,61,46,68,27,47,80,74,74,31,28,60,41,60,40,32,67,26,49,51],"y":[180,100,147,287,145,268,275,183,124,45,281,91,19,285,217,43,165,287,176,122,195,96,93,66,111,296,47,28,43,208,186,268,202,222,157,198,247,236,294,132,94,123,4,56,253,70,72,24,74,220,255,150,117,74,34,117,172,66,134,66,151,107,195,113,107,161,223,67,124,80,189,56,260,224,201,186,112,159,263,175,252,94,213,80,179,145,80,170,274,271,83,97,296,186,282,140,123,198,46,172],"z":[84,117,96,95,105,75,81,93,101,119,96,111,103,89,87,126,93,67,84,107,109,102,106,121,128,86,115,116,96,83,125,106,102,98,65,107,84,91,100,80,103,98,97,91,64,93,86,119,122,92,84,107,116,87,113,92,93,113,124,102,116,82,80,130,110,101,109,113,117,110,102,115,96,100,87,78,101,106,90,82,72,124,89,108,84,98,134,111,108,74,98,108,82,93,69,112,118,71,104,87],"mode":"markers","marker":{"color":"rgba(31,119,180,1)","size":5,"line":{"color":"rgba(31,119,180,1)"}},"type":"scatter3d","error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>All very good, and this makes sense. We can see that blood pressure is positively associated with age and negatively associated with minutes of exercise. But we need to be more quantitative about this. We need to build a model that relates blood pressure to age and minutes of exercise.</p>
</section>
<section id="the-multiple-linear-regression-model" class="level2">
<h2 class="anchored" data-anchor-id="the-multiple-linear-regression-model">The multiple linear regression model</h2>
<section id="the-model" class="level3">
<h3 class="anchored" data-anchor-id="the-model">The model</h3>
<p>The multiple linear regression model is an extension of the simple linear regression model. Recall the simple linear regression model is:</p>
<p><span class="math display">\[y_i = \beta_0 + \beta_1 x_i + \epsilon_i\]</span></p>
<p>where:</p>
<ul>
<li><span class="math inline">\(y_i\)</span> is the response variable</li>
<li><span class="math inline">\(x_i\)</span> is the explanatory variable</li>
<li><span class="math inline">\(\beta_0\)</span> is the intercept</li>
<li><span class="math inline">\(\beta_1\)</span> is the slope</li>
<li><span class="math inline">\(\epsilon_i\)</span> is the error term.</li>
</ul>
<p>The multiple linear regression model with two explanatory variables is:</p>
<p><span class="math display">\[y_i = \beta_0 + \beta_1 x_i^{(1)} + \beta_2 x_i^{(2)} + \epsilon_i\]</span></p>
<p>where:</p>
<ul>
<li><span class="math inline">\(x_i^{(1)}\)</span> and <span class="math inline">\(x_i^{(2)}\)</span> are the two explanatory variables</li>
<li><span class="math inline">\(\beta_0\)</span> is the intercept</li>
<li><span class="math inline">\(\beta_1\)</span> is the slope for the first explanatory variable</li>
<li><span class="math inline">\(\beta_2\)</span> is the slope for the second explanatory variable</li>
</ul>
<p>Note that the intercept <span class="math inline">\(\beta_0\)</span> is the value of the response variable when all explanatory variables are zero. In this example, it would be the blood pressure for someone that is 0 years old and does 0 minutes of exercise per week. This is not a particularly useful scenario, but it is a necessary mathematical construct that helps us to build the model.</p>
<p>We can extend the multiple regression model to have an arbitrary number of explanatory variables:</p>
<p><span class="math display">\[y_i = \beta_0 + \beta_1 x_i^{(1)} + \beta_2 x_i^{(2)} + \ldots + \beta_p x_i^{(p)} + \epsilon_i\]</span></p>
<p>Where:</p>
<p><span class="math inline">\(x_i^{(1)}, x_i^{(2)}, \ldots, x_i^{(p)}\)</span> are the <span class="math inline">\(p\)</span> explanatory variables and all else is as before.</p>
<p>or with summation notation:</p>
<p><span class="math display">\[y_i = \beta_0 + \sum_{j=1}^p \beta_j x_i^{(j)} + \epsilon_i\]</span></p>
<p>Just like in simple linear regression, we can estimate the parameters <span class="math inline">\(\beta_0, \beta_1, \ldots, \beta_p\)</span> using the method of least squares. The least squares method minimizes the sum of the squared residuals:</p>
<p><span class="math display">\[\sum_{i=1}^n \epsilon_i^2 = \sum_{i=1}^n (y_i - \hat{y}_i)^2\]</span></p>
<p>where <span class="math inline">\(\hat{y}_i\)</span> is the predicted value of the response variable for the <span class="math inline">\(i\)</span>th observation:</p>
<p><span class="math display">\[\hat{y}_i = \hat{\beta}_0 + \sum_{j=1}^p \hat{\beta}_j x_i^{(j)}\]</span> where:</p>
<p><span class="math inline">\(\hat{\beta}_0, \hat{\beta}_1, \ldots, \hat{\beta}_p\)</span> are the estimated parameters.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Think, Pair, Share (#two-shape)
</div>
</div>
<div class="callout-body-container callout-body">
<p>Graphically, a linear regression with one explanatory variable is a line. What is a geometric representation of linear regression with two explanatory variables?</p>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-5a7607273d18eca8d3b6" style="width:100%;height:650px;"></div>
<script type="application/json" data-for="htmlwidget-5a7607273d18eca8d3b6">{"x":{"visdat":{"527660960720":["function () ","plotlyVisDat"]},"cur_data":"527660960720","attrs":{"527660960720":{"x":{},"y":{},"z":{},"colorscale":"Viridis","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"surface"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"scene":{"xaxis":{"title":"x"},"yaxis":{"title":"y"},"zaxis":{"title":"z_matrix"}},"hovermode":"closest","showlegend":false,"legend":{"yanchor":"top","y":0.5}},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"colorbar":{"title":"z_matrix","ticklen":2,"len":0.5,"lenmode":"fraction","y":1,"yanchor":"top"},"colorscale":"Viridis","showscale":true,"x":[-5,-4.795918367346939,-4.591836734693878,-4.3877551020408161,-4.1836734693877551,-3.9795918367346941,-3.7755102040816326,-3.5714285714285712,-3.3673469387755102,-3.1632653061224492,-2.9591836734693877,-2.7551020408163263,-2.5510204081632653,-2.3469387755102042,-2.1428571428571428,-1.9387755102040813,-1.7346938775510203,-1.5306122448979593,-1.3265306122448979,-1.1224489795918364,-0.91836734693877542,-0.71428571428571441,-0.51020408163265252,-0.30612244897959151,-0.1020408163265305,0.1020408163265305,0.30612244897959151,0.51020408163265341,0.71428571428571441,0.91836734693877542,1.1224489795918373,1.3265306122448983,1.5306122448979593,1.7346938775510203,1.9387755102040813,2.1428571428571432,2.3469387755102042,2.5510204081632653,2.7551020408163271,2.9591836734693882,3.1632653061224492,3.3673469387755102,3.5714285714285712,3.7755102040816322,3.979591836734695,4.183673469387756,4.387755102040817,4.591836734693878,4.795918367346939,5],"y":[-5,-4.795918367346939,-4.591836734693878,-4.3877551020408161,-4.1836734693877551,-3.9795918367346941,-3.7755102040816326,-3.5714285714285712,-3.3673469387755102,-3.1632653061224492,-2.9591836734693877,-2.7551020408163263,-2.5510204081632653,-2.3469387755102042,-2.1428571428571428,-1.9387755102040813,-1.7346938775510203,-1.5306122448979593,-1.3265306122448979,-1.1224489795918364,-0.91836734693877542,-0.71428571428571441,-0.51020408163265252,-0.30612244897959151,-0.1020408163265305,0.1020408163265305,0.30612244897959151,0.51020408163265341,0.71428571428571441,0.91836734693877542,1.1224489795918373,1.3265306122448983,1.5306122448979593,1.7346938775510203,1.9387755102040813,2.1428571428571432,2.3469387755102042,2.5510204081632653,2.7551020408163271,2.9591836734693882,3.1632653061224492,3.3673469387755102,3.5714285714285712,3.7755102040816322,3.979591836734695,4.183673469387756,4.387755102040817,4.591836734693878,4.795918367346939,5],"z":[[0.5,0.37755102040816313,0.2551020408163267,0.13265306122448939,0.010204081632652962,-0.11224489795918347,-0.23469387755102034,-0.35714285714285721,-0.47959183673469408,-0.6020408163265305,-0.72448979591836737,-0.84693877551020424,-0.96938775510204089,-1.0918367346938775,-1.2142857142857144,-1.3367346938775513,-1.4591836734693879,-1.5816326530612246,-1.7040816326530615,-1.8265306122448983,-1.9489795918367347,-2.0714285714285712,-2.1938775510204085,-2.3163265306122449,-2.4387755102040818,-2.5612244897959182,-2.6836734693877551,-2.806122448979592,-2.9285714285714288,-3.0510204081632653,-3.1734693877551026,-3.295918367346939,-3.4183673469387754,-3.5408163265306118,-3.6632653061224487,-3.7857142857142856,-3.9081632653061225,-4.0306122448979593,-4.1530612244897966,-4.2755102040816331,-4.3979591836734695,-4.5204081632653059,-4.6428571428571423,-4.7653061224489797,-4.887755102040817,-5.0102040816326534,-5.1326530612244898,-5.2551020408163271,-5.3775510204081627,-5.5],[0.6020408163265305,0.47959183673469363,0.35714285714285721,0.23469387755101989,0.11224489795918347,-0.010204081632652962,-0.13265306122448983,-0.2551020408163267,-0.37755102040816357,-0.5,-0.62244897959183687,-0.74489795918367374,-0.86734693877551039,-0.98979591836734704,-1.1122448979591839,-1.2346938775510208,-1.3571428571428574,-1.4795918367346941,-1.6020408163265309,-1.7244897959183678,-1.8469387755102042,-1.9693877551020409,-2.091836734693878,-2.2142857142857144,-2.3367346938775513,-2.4591836734693877,-2.5816326530612246,-2.7040816326530615,-2.8265306122448983,-2.9489795918367347,-3.0714285714285721,-3.1938775510204085,-3.3163265306122449,-3.4387755102040813,-3.5612244897959182,-3.6836734693877551,-3.806122448979592,-3.9285714285714288,-4.0510204081632661,-4.1734693877551026,-4.295918367346939,-4.4183673469387754,-4.5408163265306118,-4.6632653061224492,-4.7857142857142865,-4.9081632653061229,-5.0306122448979593,-5.1530612244897966,-5.2755102040816322,-5.3979591836734695],[0.70408163265306101,0.58163265306122414,0.45918367346938771,0.3367346938775504,0.21428571428571397,0.091836734693877542,-0.030612244897959329,-0.1530612244897962,-0.27551020408163307,-0.3979591836734695,-0.52040816326530637,-0.64285714285714324,-0.76530612244897989,-0.88775510204081653,-1.0102040816326534,-1.1326530612244903,-1.2551020408163269,-1.3775510204081636,-1.5000000000000004,-1.6224489795918373,-1.7448979591836737,-1.8673469387755104,-1.9897959183673475,-2.1122448979591839,-2.2346938775510208,-2.3571428571428572,-2.4795918367346941,-2.6020408163265309,-2.7244897959183678,-2.8469387755102042,-2.9693877551020416,-3.091836734693878,-3.2142857142857144,-3.3367346938775508,-3.4591836734693877,-3.5816326530612246,-3.7040816326530615,-3.8265306122448983,-3.9489795918367352,-4.0714285714285721,-4.1938775510204085,-4.3163265306122449,-4.4387755102040813,-4.5612244897959187,-4.683673469387756,-4.8061224489795924,-4.9285714285714288,-5.0510204081632661,-5.1734693877551017,-5.295918367346939],[0.80612244897959195,0.68367346938775508,0.56122448979591866,0.43877551020408134,0.31632653061224492,0.19387755102040849,0.071428571428571619,-0.051020408163265252,-0.17346938775510212,-0.29591836734693855,-0.41836734693877542,-0.54081632653061229,-0.66326530612244894,-0.78571428571428559,-0.90816326530612246,-1.0306122448979593,-1.153061224489796,-1.2755102040816326,-1.3979591836734695,-1.5204081632653064,-1.6428571428571428,-1.7653061224489794,-1.8877551020408165,-2.010204081632653,-2.1326530612244898,-2.2551020408163263,-2.3775510204081631,-2.5,-2.6224489795918369,-2.7448979591836733,-2.8673469387755102,-2.989795918367347,-3.1122448979591835,-3.2346938775510203,-3.3571428571428568,-3.4795918367346941,-3.6020408163265305,-3.7244897959183669,-3.8469387755102042,-3.9693877551020407,-4.091836734693878,-4.2142857142857135,-4.3367346938775508,-4.4591836734693873,-4.5816326530612255,-4.704081632653061,-4.8265306122448983,-4.9489795918367347,-5.0714285714285712,-5.1938775510204085],[0.90816326530612246,0.78571428571428559,0.66326530612244916,0.54081632653061185,0.41836734693877542,0.29591836734693899,0.17346938775510212,0.051020408163265252,-0.071428571428571619,-0.19387755102040805,-0.31632653061224492,-0.43877551020408179,-0.56122448979591844,-0.68367346938775508,-0.80612244897959195,-0.92857142857142883,-1.0510204081632655,-1.1734693877551021,-1.295918367346939,-1.4183673469387759,-1.5408163265306123,-1.6632653061224489,-1.785714285714286,-1.9081632653061227,-2.0306122448979593,-2.1530612244897958,-2.2755102040816326,-2.3979591836734695,-2.5204081632653064,-2.6428571428571428,-2.7653061224489797,-2.8877551020408165,-3.010204081632653,-3.1326530612244898,-3.2551020408163263,-3.3775510204081636,-3.5,-3.6224489795918364,-3.7448979591836737,-3.8673469387755102,-3.989795918367347,-4.112244897959183,-4.2346938775510203,-4.3571428571428568,-4.479591836734695,-4.6020408163265305,-4.7244897959183678,-4.8469387755102042,-4.9693877551020407,-5.091836734693878],[1.010204081632653,0.88775510204081609,0.76530612244897966,0.64285714285714235,0.52040816326530592,0.3979591836734695,0.27551020408163263,0.15306122448979576,0.030612244897958885,-0.091836734693877542,-0.21428571428571441,-0.33673469387755128,-0.45918367346938793,-0.58163265306122458,-0.70408163265306145,-0.82653061224489832,-0.94897959183673497,-1.0714285714285716,-1.1938775510204085,-1.3163265306122454,-1.4387755102040818,-1.5612244897959184,-1.6836734693877555,-1.8061224489795922,-1.9285714285714288,-2.0510204081632653,-2.1734693877551021,-2.295918367346939,-2.4183673469387759,-2.5408163265306123,-2.6632653061224492,-2.785714285714286,-2.9081632653061225,-3.0306122448979593,-3.1530612244897958,-3.2755102040816331,-3.3979591836734695,-3.5204081632653059,-3.6428571428571432,-3.7653061224489797,-3.8877551020408165,-4.0102040816326525,-4.1326530612244898,-4.2551020408163263,-4.3775510204081645,-4.5,-4.6224489795918373,-4.7448979591836737,-4.8673469387755102,-4.9897959183673475],[1.1122448979591837,0.98979591836734682,0.86734693877551039,0.74489795918367308,0.62244897959183665,0.50000000000000022,0.37755102040816335,0.25510204081632648,0.13265306122448961,0.010204081632653184,-0.11224489795918369,-0.23469387755102056,-0.35714285714285721,-0.47959183673469385,-0.60204081632653073,-0.7244897959183676,-0.84693877551020424,-0.96938775510204078,-1.0918367346938775,-1.2142857142857144,-1.3367346938775511,-1.4591836734693877,-1.5816326530612248,-1.7040816326530615,-1.8265306122448981,-1.9489795918367345,-2.0714285714285712,-2.1938775510204085,-2.3163265306122449,-2.4387755102040813,-2.5612244897959187,-2.6836734693877551,-2.806122448979592,-2.9285714285714284,-3.0510204081632653,-3.1734693877551021,-3.295918367346939,-3.4183673469387754,-3.5408163265306127,-3.6632653061224492,-3.7857142857142856,-3.908163265306122,-4.0306122448979593,-4.1530612244897958,-4.2755102040816331,-4.3979591836734695,-4.5204081632653068,-4.6428571428571432,-4.7653061224489797,-4.8877551020408161],[1.2142857142857144,1.0918367346938775,0.96938775510204112,0.8469387755102038,0.72448979591836737,0.60204081632653095,0.47959183673469408,0.35714285714285721,0.23469387755102034,0.11224489795918391,-0.010204081632652962,-0.13265306122448983,-0.25510204081632648,-0.37755102040816313,-0.5,-0.62244897959183687,-0.74489795918367352,-0.86734693877551006,-0.98979591836734693,-1.1122448979591839,-1.2346938775510203,-1.357142857142857,-1.4795918367346941,-1.6020408163265307,-1.7244897959183674,-1.8469387755102038,-1.9693877551020404,-2.0918367346938775,-2.2142857142857144,-2.3367346938775508,-2.4591836734693882,-2.5816326530612246,-2.704081632653061,-2.8265306122448974,-2.9489795918367343,-3.0714285714285712,-3.193877551020408,-3.3163265306122449,-3.4387755102040818,-3.5612244897959187,-3.6836734693877551,-3.8061224489795915,-3.9285714285714284,-4.0510204081632644,-4.1734693877551026,-4.295918367346939,-4.4183673469387763,-4.5408163265306118,-4.6632653061224492,-4.7857142857142856],[1.3163265306122449,1.193877551020408,1.0714285714285716,0.9489795918367343,0.82653061224489788,0.70408163265306145,0.58163265306122458,0.45918367346938771,0.33673469387755084,0.21428571428571441,0.091836734693877542,-0.030612244897959329,-0.15306122448979598,-0.27551020408163263,-0.3979591836734695,-0.52040816326530637,-0.64285714285714302,-0.76530612244897955,-0.88775510204081642,-1.0102040816326534,-1.1326530612244898,-1.2551020408163265,-1.3775510204081636,-1.5000000000000002,-1.6224489795918369,-1.7448979591836733,-1.8673469387755099,-1.989795918367347,-2.1122448979591839,-2.2346938775510203,-2.3571428571428577,-2.4795918367346941,-2.6020408163265305,-2.7244897959183669,-2.8469387755102038,-2.9693877551020407,-3.0918367346938775,-3.2142857142857144,-3.3367346938775513,-3.4591836734693882,-3.5816326530612246,-3.704081632653061,-3.8265306122448979,-3.9489795918367343,-4.0714285714285721,-4.1938775510204085,-4.3163265306122458,-4.4387755102040813,-4.5612244897959187,-4.6836734693877551],[1.4183673469387754,1.2959183673469385,1.1734693877551021,1.0510204081632648,0.92857142857142838,0.80612244897959195,0.68367346938775508,0.56122448979591821,0.43877551020408134,0.31632653061224492,0.19387755102040805,0.071428571428571175,-0.051020408163265474,-0.17346938775510212,-0.29591836734693899,-0.41836734693877586,-0.54081632653061251,-0.66326530612244905,-0.78571428571428592,-0.90816326530612279,-1.0306122448979593,-1.153061224489796,-1.2755102040816331,-1.3979591836734697,-1.5204081632653064,-1.6428571428571428,-1.7653061224489794,-1.8877551020408165,-2.0102040816326534,-2.1326530612244898,-2.2551020408163271,-2.3775510204081636,-2.5,-2.6224489795918364,-2.7448979591836733,-2.8673469387755102,-2.989795918367347,-3.1122448979591839,-3.2346938775510208,-3.3571428571428577,-3.4795918367346941,-3.6020408163265305,-3.7244897959183674,-3.8469387755102038,-3.9693877551020416,-4.091836734693878,-4.2142857142857153,-4.3367346938775508,-4.4591836734693882,-4.5816326530612246],[1.5204081632653061,1.3979591836734693,1.2755102040816328,1.1530612244897955,1.0306122448979591,0.90816326530612268,0.78571428571428581,0.66326530612244894,0.54081632653061207,0.41836734693877564,0.29591836734693877,0.1734693877551019,0.051020408163265252,-0.071428571428571397,-0.19387755102040827,-0.31632653061224514,-0.43877551020408179,-0.56122448979591832,-0.68367346938775519,-0.80612244897959207,-0.9285714285714286,-1.0510204081632653,-1.1734693877551023,-1.295918367346939,-1.4183673469387756,-1.5408163265306121,-1.6632653061224487,-1.7857142857142858,-1.9081632653061225,-2.0306122448979593,-2.1530612244897962,-2.2755102040816331,-2.3979591836734695,-2.5204081632653059,-2.6428571428571423,-2.7653061224489797,-2.8877551020408161,-3.010204081632653,-3.1326530612244898,-3.2551020408163267,-3.3775510204081636,-3.5,-3.6224489795918364,-3.7448979591836729,-3.8673469387755111,-3.9897959183673475,-4.1122448979591839,-4.2346938775510203,-4.3571428571428568,-4.4795918367346941],[1.6224489795918369,1.5,1.3775510204081636,1.2551020408163263,1.1326530612244898,1.0102040816326534,0.88775510204081653,0.76530612244897966,0.64285714285714279,0.52040816326530637,0.3979591836734695,0.27551020408163263,0.15306122448979598,0.030612244897959329,-0.091836734693877542,-0.21428571428571441,-0.33673469387755106,-0.4591836734693876,-0.58163265306122447,-0.70408163265306134,-0.82653061224489788,-0.94897959183673453,-1.0714285714285716,-1.1938775510204083,-1.3163265306122449,-1.4387755102040813,-1.561224489795918,-1.6836734693877551,-1.8061224489795917,-1.9285714285714284,-2.0510204081632653,-2.1734693877551021,-2.2959183673469385,-2.4183673469387754,-2.5408163265306118,-2.6632653061224492,-2.7857142857142856,-2.908163265306122,-3.0306122448979593,-3.1530612244897958,-3.2755102040816326,-3.3979591836734691,-3.5204081632653059,-3.6428571428571423,-3.7653061224489801,-3.8877551020408165,-4.0102040816326534,-4.1326530612244898,-4.2551020408163263,-4.3775510204081627],[1.7244897959183674,1.6020408163265305,1.4795918367346941,1.3571428571428568,1.2346938775510203,1.1122448979591839,0.98979591836734704,0.86734693877551017,0.7448979591836733,0.62244897959183687,0.5,0.37755102040816313,0.25510204081632648,0.13265306122448983,0.010204081632652962,-0.11224489795918391,-0.23469387755102056,-0.3571428571428571,-0.47959183673469397,-0.60204081632653084,-0.72448979591836737,-0.84693877551020402,-0.96938775510204112,-1.0918367346938778,-1.2142857142857144,-1.3367346938775508,-1.4591836734693875,-1.5816326530612246,-1.7040816326530612,-1.8265306122448979,-1.948979591836735,-2.0714285714285716,-2.193877551020408,-2.3163265306122449,-2.4387755102040813,-2.5612244897959187,-2.6836734693877551,-2.8061224489795915,-2.9285714285714288,-3.0510204081632653,-3.1734693877551021,-3.2959183673469385,-3.4183673469387754,-3.5408163265306118,-3.6632653061224496,-3.785714285714286,-3.9081632653061229,-4.0306122448979593,-4.1530612244897958,-4.2755102040816322],[1.8265306122448979,1.704081632653061,1.5816326530612246,1.4591836734693873,1.3367346938775508,1.2142857142857144,1.0918367346938775,0.96938775510204067,0.8469387755102038,0.72448979591836737,0.6020408163265305,0.47959183673469363,0.35714285714285698,0.23469387755102034,0.11224489795918347,-0.010204081632653406,-0.13265306122449005,-0.25510204081632659,-0.37755102040816346,-0.50000000000000033,-0.62244897959183687,-0.74489795918367352,-0.86734693877551061,-0.98979591836734726,-1.1122448979591839,-1.2346938775510203,-1.357142857142857,-1.4795918367346941,-1.6020408163265307,-1.7244897959183674,-1.8469387755102045,-1.9693877551020411,-2.0918367346938775,-2.2142857142857144,-2.3367346938775508,-2.4591836734693882,-2.5816326530612246,-2.704081632653061,-2.8265306122448983,-2.9489795918367347,-3.0714285714285716,-3.193877551020408,-3.3163265306122449,-3.4387755102040813,-3.5612244897959191,-3.6836734693877555,-3.8061224489795924,-3.9285714285714288,-4.0510204081632653,-4.1734693877551017],[1.9285714285714286,1.8061224489795917,1.6836734693877553,1.561224489795918,1.4387755102040816,1.3163265306122451,1.1938775510204083,1.0714285714285714,0.94897959183673453,0.8265306122448981,0.70408163265306123,0.58163265306122436,0.45918367346938771,0.33673469387755106,0.21428571428571419,0.09183673469387732,-0.030612244897959329,-0.15306122448979587,-0.27551020408163274,-0.39795918367346961,-0.52040816326530615,-0.64285714285714279,-0.76530612244897989,-0.88775510204081653,-1.0102040816326532,-1.1326530612244896,-1.2551020408163263,-1.3775510204081634,-1.5,-1.6224489795918366,-1.7448979591836737,-1.8673469387755104,-1.989795918367347,-2.1122448979591835,-2.2346938775510203,-2.3571428571428572,-2.4795918367346941,-2.6020408163265305,-2.7244897959183678,-2.8469387755102042,-2.9693877551020407,-3.0918367346938771,-3.2142857142857144,-3.3367346938775508,-3.4591836734693882,-3.5816326530612246,-3.7040816326530619,-3.8265306122448983,-3.9489795918367347,-4.0714285714285712],[2.0306122448979593,1.9081632653061225,1.785714285714286,1.6632653061224487,1.5408163265306123,1.4183673469387759,1.295918367346939,1.1734693877551021,1.0510204081632653,0.92857142857142883,0.80612244897959195,0.68367346938775508,0.56122448979591844,0.43877551020408179,0.31632653061224492,0.19387755102040805,0.071428571428571397,-0.051020408163265141,-0.17346938775510201,-0.29591836734693888,-0.41836734693877542,-0.54081632653061207,-0.66326530612244916,-0.78571428571428581,-0.90816326530612235,-1.0306122448979589,-1.1530612244897955,-1.2755102040816326,-1.3979591836734693,-1.5204081632653059,-1.642857142857143,-1.7653061224489797,-1.8877551020408161,-2.0102040816326525,-2.1326530612244894,-2.2551020408163263,-2.3775510204081631,-2.5,-2.6224489795918369,-2.7448979591836737,-2.8673469387755102,-2.9897959183673466,-3.1122448979591835,-3.2346938775510199,-3.3571428571428577,-3.4795918367346941,-3.6020408163265309,-3.7244897959183674,-3.8469387755102038,-3.9693877551020407],[2.1326530612244898,2.010204081632653,1.8877551020408165,1.7653061224489792,1.6428571428571428,1.5204081632653064,1.3979591836734695,1.2755102040816326,1.1530612244897958,1.0306122448979593,0.90816326530612246,0.78571428571428559,0.66326530612244894,0.54081632653061229,0.41836734693877542,0.29591836734693855,0.1734693877551019,0.051020408163265363,-0.071428571428571508,-0.19387755102040838,-0.31632653061224492,-0.43877551020408151,-0.56122448979591866,-0.68367346938775531,-0.80612244897959184,-0.92857142857142849,-1.051020408163265,-1.1734693877551021,-1.2959183673469388,-1.4183673469387754,-1.5408163265306125,-1.6632653061224492,-1.7857142857142856,-1.9081632653061222,-2.0306122448979589,-2.1530612244897958,-2.2755102040816326,-2.3979591836734695,-2.5204081632653064,-2.6428571428571432,-2.7653061224489797,-2.8877551020408161,-3.010204081632653,-3.1326530612244894,-3.2551020408163271,-3.3775510204081636,-3.5000000000000004,-3.6224489795918369,-3.7448979591836733,-3.8673469387755102],[2.2346938775510203,2.1122448979591835,1.989795918367347,1.8673469387755097,1.7448979591836733,1.6224489795918369,1.5,1.3775510204081631,1.2551020408163263,1.1326530612244898,1.010204081632653,0.88775510204081609,0.76530612244897944,0.64285714285714279,0.52040816326530592,0.39795918367346905,0.2755102040816324,0.15306122448979587,0.030612244897958996,-0.091836734693877875,-0.21428571428571441,-0.33673469387755101,-0.45918367346938815,-0.5816326530612248,-0.70408163265306134,-0.82653061224489799,-0.94897959183673453,-1.0714285714285716,-1.1938775510204083,-1.3163265306122449,-1.438775510204082,-1.5612244897959187,-1.6836734693877551,-1.8061224489795917,-1.9285714285714284,-2.0510204081632653,-2.1734693877551021,-2.295918367346939,-2.4183673469387759,-2.5408163265306127,-2.6632653061224492,-2.7857142857142856,-2.9081632653061225,-3.0306122448979589,-3.1530612244897966,-3.2755102040816331,-3.3979591836734699,-3.5204081632653064,-3.6428571428571428,-3.7653061224489797],[2.3367346938775508,2.2142857142857144,2.091836734693878,1.9693877551020404,1.846938775510204,1.7244897959183676,1.6020408163265307,1.4795918367346939,1.357142857142857,1.2346938775510206,1.1122448979591837,0.98979591836734682,0.86734693877551017,0.74489795918367352,0.62244897959183665,0.49999999999999978,0.37755102040816313,0.25510204081632659,0.13265306122448972,0.010204081632652851,-0.11224489795918369,-0.23469387755102028,-0.35714285714285743,-0.47959183673469408,-0.60204081632653061,-0.72448979591836726,-0.8469387755102038,-0.96938775510204089,-1.0918367346938775,-1.2142857142857142,-1.3367346938775513,-1.4591836734693879,-1.5816326530612246,-1.704081632653061,-1.8265306122448977,-1.9489795918367347,-2.0714285714285712,-2.193877551020408,-2.3163265306122449,-2.4387755102040818,-2.5612244897959187,-2.6836734693877551,-2.8061224489795915,-2.9285714285714279,-3.0510204081632661,-3.1734693877551026,-3.295918367346939,-3.4183673469387754,-3.5408163265306118,-3.6632653061224492],[2.4387755102040818,2.3163265306122449,2.1938775510204085,2.0714285714285712,1.9489795918367347,1.8265306122448983,1.7040816326530615,1.5816326530612246,1.4591836734693877,1.3367346938775513,1.2142857142857144,1.0918367346938775,0.96938775510204089,0.84693877551020424,0.72448979591836737,0.6020408163265305,0.47959183673469385,0.35714285714285732,0.23469387755102045,0.11224489795918358,-0.010204081632652962,-0.13265306122448955,-0.2551020408163267,-0.37755102040816335,-0.49999999999999989,-0.62244897959183654,-0.74489795918367308,-0.86734693877551017,-0.98979591836734682,-1.1122448979591835,-1.2346938775510206,-1.3571428571428572,-1.4795918367346936,-1.6020408163265303,-1.7244897959183669,-1.846938775510204,-1.9693877551020407,-2.0918367346938771,-2.2142857142857144,-2.3367346938775508,-2.4591836734693877,-2.5816326530612241,-2.704081632653061,-2.8265306122448974,-2.9489795918367352,-3.0714285714285716,-3.1938775510204085,-3.3163265306122449,-3.4387755102040813,-3.5612244897959182],[2.5408163265306123,2.4183673469387754,2.295918367346939,2.1734693877551017,2.0510204081632653,1.9285714285714288,1.806122448979592,1.6836734693877551,1.5612244897959182,1.4387755102040818,1.3163265306122449,1.193877551020408,1.0714285714285714,0.94897959183673475,0.82653061224489788,0.70408163265306101,0.58163265306122436,0.45918367346938782,0.33673469387755095,0.21428571428571408,0.091836734693877542,-0.030612244897959051,-0.1530612244897962,-0.27551020408163285,-0.39795918367346939,-0.52040816326530603,-0.64285714285714257,-0.76530612244897966,-0.88775510204081631,-1.010204081632653,-1.1326530612244901,-1.2551020408163267,-1.3775510204081631,-1.4999999999999998,-1.6224489795918364,-1.7448979591836735,-1.8673469387755102,-1.9897959183673468,-2.1122448979591839,-2.2346938775510203,-2.3571428571428572,-2.4795918367346936,-2.6020408163265305,-2.7244897959183669,-2.8469387755102047,-2.9693877551020411,-3.091836734693878,-3.2142857142857144,-3.3367346938775508,-3.4591836734693877],[2.6428571428571428,2.5204081632653059,2.3979591836734695,2.2755102040816322,2.1530612244897958,2.0306122448979593,1.9081632653061225,1.7857142857142856,1.6632653061224487,1.5408163265306123,1.4183673469387754,1.2959183673469385,1.1734693877551019,1.0510204081632653,0.92857142857142838,0.80612244897959151,0.68367346938775486,0.56122448979591832,0.43877551020408145,0.31632653061224458,0.19387755102040805,0.071428571428571452,-0.051020408163265696,-0.17346938775510232,-0.29591836734693888,-0.41836734693877553,-0.54081632653061207,-0.66326530612244916,-0.78571428571428581,-0.90816326530612246,-1.0306122448979596,-1.1530612244897962,-1.2755102040816326,-1.3979591836734693,-1.5204081632653059,-1.642857142857143,-1.7653061224489797,-1.8877551020408163,-2.0102040816326534,-2.1326530612244898,-2.2551020408163267,-2.3775510204081631,-2.5,-2.6224489795918364,-2.7448979591836742,-2.8673469387755106,-2.9897959183673475,-3.1122448979591839,-3.2346938775510203,-3.3571428571428572],[2.7448979591836737,2.6224489795918369,2.5000000000000004,2.3775510204081631,2.2551020408163267,2.1326530612244903,2.0102040816326534,1.8877551020408165,1.7653061224489797,1.6428571428571432,1.5204081632653064,1.3979591836734695,1.2755102040816328,1.1530612244897962,1.0306122448979593,0.90816326530612246,0.78571428571428581,0.66326530612244927,0.5408163265306124,0.41836734693877553,0.29591836734693899,0.1734693877551024,0.051020408163265252,-0.071428571428571369,-0.19387755102040796,-0.31632653061224458,-0.43877551020408112,-0.56122448979591821,-0.68367346938775486,-0.80612244897959151,-0.9285714285714286,-1.0510204081632653,-1.1734693877551017,-1.2959183673469383,-1.418367346938775,-1.5408163265306121,-1.6632653061224487,-1.7857142857142854,-1.9081632653061225,-2.0306122448979593,-2.1530612244897958,-2.2755102040816322,-2.3979591836734691,-2.5204081632653055,-2.6428571428571432,-2.7653061224489797,-2.8877551020408165,-3.010204081632653,-3.1326530612244894,-3.2551020408163263],[2.8469387755102042,2.7244897959183674,2.6020408163265309,2.4795918367346936,2.3571428571428572,2.2346938775510208,2.1122448979591839,1.989795918367347,1.8673469387755102,1.7448979591836737,1.6224489795918369,1.5,1.3775510204081634,1.2551020408163267,1.1326530612244898,1.010204081632653,0.88775510204081631,0.76530612244897978,0.6428571428571429,0.52040816326530603,0.3979591836734695,0.2755102040816329,0.15306122448979576,0.030612244897959134,-0.091836734693877459,-0.21428571428571405,-0.33673469387755062,-0.45918367346938777,-0.58163265306122436,-0.70408163265306101,-0.8265306122448981,-0.94897959183673475,-1.0714285714285712,-1.1938775510204078,-1.3163265306122445,-1.4387755102040816,-1.5612244897959182,-1.6836734693877549,-1.806122448979592,-1.9285714285714286,-2.0510204081632653,-2.1734693877551017,-2.2959183673469385,-2.418367346938775,-2.5408163265306127,-2.6632653061224492,-2.785714285714286,-2.9081632653061225,-3.0306122448979589,-3.1530612244897958],[2.9489795918367347,2.8265306122448979,2.7040816326530615,2.5816326530612241,2.4591836734693877,2.3367346938775513,2.2142857142857144,2.0918367346938775,1.9693877551020407,1.8469387755102042,1.7244897959183674,1.6020408163265305,1.4795918367346939,1.3571428571428572,1.2346938775510203,1.1122448979591835,0.98979591836734682,0.86734693877551028,0.74489795918367341,0.62244897959183654,0.5,0.37755102040816341,0.25510204081632626,0.13265306122448964,0.010204081632653045,-0.11224489795918355,-0.23469387755102014,-0.35714285714285726,-0.47959183673469391,-0.6020408163265305,-0.7244897959183676,-0.84693877551020424,-0.96938775510204078,-1.0918367346938773,-1.214285714285714,-1.3367346938775511,-1.4591836734693877,-1.5816326530612244,-1.7040816326530615,-1.8265306122448981,-1.9489795918367347,-2.0714285714285712,-2.193877551020408,-2.3163265306122445,-2.4387755102040822,-2.5612244897959187,-2.6836734693877555,-2.806122448979592,-2.9285714285714284,-3.0510204081632653],[3.0510204081632653,2.9285714285714284,2.806122448979592,2.6836734693877546,2.5612244897959182,2.4387755102040818,2.3163265306122449,2.193877551020408,2.0714285714285712,1.9489795918367347,1.8265306122448979,1.704081632653061,1.5816326530612244,1.4591836734693877,1.3367346938775508,1.214285714285714,1.0918367346938773,0.96938775510204078,0.84693877551020391,0.72448979591836704,0.6020408163265305,0.47959183673469391,0.35714285714285676,0.23469387755102014,0.11224489795918355,-0.010204081632653045,-0.13265306122448964,-0.25510204081632676,-0.37755102040816341,-0.5,-0.62244897959183709,-0.74489795918367374,-0.86734693877551028,-0.98979591836734682,-1.1122448979591835,-1.2346938775510206,-1.3571428571428572,-1.4795918367346939,-1.6020408163265309,-1.7244897959183676,-1.8469387755102042,-1.9693877551020407,-2.0918367346938775,-2.214285714285714,-2.3367346938775517,-2.4591836734693882,-2.581632653061225,-2.7040816326530615,-2.8265306122448979,-2.9489795918367347],[3.1530612244897958,3.0306122448979589,2.9081632653061225,2.7857142857142851,2.6632653061224487,2.5408163265306123,2.4183673469387754,2.2959183673469385,2.1734693877551017,2.0510204081632653,1.9285714285714284,1.8061224489795915,1.6836734693877549,1.5612244897959182,1.4387755102040813,1.3163265306122445,1.1938775510204078,1.0714285714285712,0.94897959183673442,0.82653061224489754,0.70408163265306101,0.58163265306122436,0.45918367346938727,0.33673469387755062,0.21428571428571405,0.091836734693877459,-0.030612244897959134,-0.15306122448979625,-0.2755102040816329,-0.3979591836734695,-0.52040816326530659,-0.64285714285714324,-0.76530612244897978,-0.88775510204081631,-1.010204081632653,-1.1326530612244901,-1.2551020408163267,-1.3775510204081634,-1.5000000000000004,-1.6224489795918371,-1.7448979591836737,-1.8673469387755102,-1.989795918367347,-2.1122448979591835,-2.2346938775510212,-2.3571428571428577,-2.4795918367346945,-2.6020408163265309,-2.7244897959183674,-2.8469387755102042],[3.2551020408163267,3.1326530612244898,3.0102040816326534,2.8877551020408161,2.7653061224489797,2.6428571428571432,2.5204081632653064,2.3979591836734695,2.2755102040816326,2.1530612244897962,2.0306122448979593,1.9081632653061225,1.7857142857142858,1.6632653061224492,1.5408163265306123,1.4183673469387754,1.2959183673469388,1.1734693877551021,1.0510204081632653,0.92857142857142849,0.80612244897959195,0.68367346938775531,0.56122448979591821,0.43877551020408156,0.31632653061224503,0.19387755102040841,0.071428571428571813,-0.051020408163265307,-0.17346938775510196,-0.29591836734693855,-0.41836734693877564,-0.54081632653061229,-0.66326530612244883,-0.78571428571428537,-0.90816326530612201,-1.0306122448979591,-1.1530612244897958,-1.2755102040816324,-1.3979591836734695,-1.5204081632653061,-1.6428571428571428,-1.7653061224489792,-1.8877551020408161,-2.0102040816326525,-2.1326530612244903,-2.2551020408163267,-2.3775510204081636,-2.5,-2.6224489795918364,-2.7448979591836733],[3.3571428571428572,3.2346938775510203,3.1122448979591839,2.9897959183673466,2.8673469387755102,2.7448979591836737,2.6224489795918369,2.5,2.3775510204081631,2.2551020408163267,2.1326530612244898,2.010204081632653,1.8877551020408163,1.7653061224489797,1.6428571428571428,1.5204081632653059,1.3979591836734693,1.2755102040816326,1.1530612244897958,1.0306122448979589,0.90816326530612246,0.78571428571428581,0.66326530612244872,0.54081632653061207,0.41836734693877553,0.29591836734693888,0.17346938775510232,0.051020408163265196,-0.071428571428571452,-0.19387755102040805,-0.31632653061224514,-0.43877551020408179,-0.56122448979591832,-0.68367346938775486,-0.80612244897959151,-0.9285714285714286,-1.0510204081632653,-1.1734693877551019,-1.295918367346939,-1.4183673469387756,-1.5408163265306123,-1.6632653061224487,-1.7857142857142856,-1.908163265306122,-2.0306122448979598,-2.1530612244897962,-2.2755102040816331,-2.3979591836734695,-2.5204081632653059,-2.6428571428571428],[3.4591836734693877,3.3367346938775508,3.2142857142857144,3.0918367346938771,2.9693877551020407,2.8469387755102042,2.7244897959183674,2.6020408163265305,2.4795918367346936,2.3571428571428572,2.2346938775510203,2.1122448979591835,1.9897959183673468,1.8673469387755102,1.7448979591836733,1.6224489795918364,1.4999999999999998,1.3775510204081631,1.2551020408163263,1.1326530612244894,1.010204081632653,0.88775510204081631,0.76530612244897922,0.64285714285714257,0.52040816326530603,0.39795918367346939,0.27551020408163285,0.1530612244897957,0.030612244897959051,-0.091836734693877542,-0.21428571428571463,-0.33673469387755128,-0.45918367346938782,-0.58163265306122436,-0.70408163265306101,-0.8265306122448981,-0.94897959183673475,-1.0714285714285714,-1.1938775510204085,-1.3163265306122451,-1.4387755102040818,-1.5612244897959182,-1.6836734693877551,-1.8061224489795915,-1.9285714285714293,-2.0510204081632657,-2.1734693877551026,-2.295918367346939,-2.4183673469387754,-2.5408163265306123],[3.5612244897959187,3.4387755102040818,3.3163265306122454,3.193877551020408,3.0714285714285716,2.9489795918367352,2.8265306122448983,2.7040816326530615,2.5816326530612246,2.4591836734693882,2.3367346938775513,2.2142857142857144,2.091836734693878,1.9693877551020411,1.8469387755102042,1.7244897959183674,1.6020408163265307,1.4795918367346941,1.3571428571428572,1.2346938775510203,1.1122448979591839,0.98979591836734726,0.86734693877551017,0.74489795918367352,0.62244897959183698,0.50000000000000033,0.3775510204081638,0.25510204081632665,0.13265306122449,0.010204081632653406,-0.11224489795918369,-0.23469387755102034,-0.35714285714285687,-0.47959183673469341,-0.60204081632653006,-0.72448979591836715,-0.8469387755102038,-0.96938775510204045,-1.0918367346938775,-1.2142857142857142,-1.3367346938775508,-1.4591836734693873,-1.5816326530612241,-1.7040816326530606,-1.8265306122448983,-1.9489795918367347,-2.0714285714285716,-2.193877551020408,-2.3163265306122445,-2.4387755102040813],[3.6632653061224492,3.5408163265306123,3.4183673469387759,3.2959183673469385,3.1734693877551021,3.0510204081632657,2.9285714285714288,2.806122448979592,2.6836734693877551,2.5612244897959187,2.4387755102040818,2.3163265306122449,2.1938775510204085,2.0714285714285716,1.9489795918367347,1.8265306122448979,1.7040816326530612,1.5816326530612246,1.4591836734693877,1.3367346938775508,1.2142857142857144,1.0918367346938778,0.96938775510204067,0.84693877551020402,0.72448979591836749,0.60204081632653084,0.4795918367346943,0.35714285714285715,0.2346938775510205,0.11224489795918391,-0.010204081632653184,-0.13265306122448983,-0.25510204081632637,-0.37755102040816291,-0.49999999999999956,-0.62244897959183665,-0.7448979591836733,-0.86734693877550995,-0.98979591836734704,-1.1122448979591837,-1.2346938775510203,-1.3571428571428568,-1.4795918367346936,-1.6020408163265301,-1.7244897959183678,-1.8469387755102042,-1.9693877551020411,-2.0918367346938775,-2.214285714285714,-2.3367346938775508],[3.7653061224489797,3.6428571428571428,3.5204081632653064,3.3979591836734691,3.2755102040816326,3.1530612244897962,3.0306122448979593,2.9081632653061225,2.7857142857142856,2.6632653061224492,2.5408163265306123,2.4183673469387754,2.295918367346939,2.1734693877551021,2.0510204081632653,1.9285714285714284,1.8061224489795917,1.6836734693877551,1.5612244897959182,1.4387755102040813,1.3163265306122449,1.1938775510204083,1.0714285714285712,0.94897959183673453,0.82653061224489799,0.70408163265306134,0.5816326530612248,0.45918367346938765,0.33673469387755101,0.21428571428571441,0.09183673469387732,-0.030612244897959329,-0.15306122448979587,-0.2755102040816324,-0.39795918367346905,-0.52040816326530615,-0.64285714285714279,-0.76530612244897944,-0.88775510204081653,-1.0102040816326532,-1.1326530612244898,-1.2551020408163263,-1.3775510204081631,-1.4999999999999996,-1.6224489795918373,-1.7448979591836737,-1.8673469387755106,-1.989795918367347,-2.1122448979591835,-2.2346938775510203],[3.8673469387755102,3.7448979591836733,3.6224489795918369,3.4999999999999996,3.3775510204081631,3.2551020408163267,3.1326530612244898,3.010204081632653,2.8877551020408161,2.7653061224489797,2.6428571428571428,2.5204081632653059,2.3979591836734695,2.2755102040816326,2.1530612244897958,2.0306122448979589,1.9081632653061222,1.7857142857142856,1.6632653061224487,1.5408163265306118,1.4183673469387754,1.2959183673469388,1.1734693877551017,1.051020408163265,0.92857142857142849,0.80612244897959184,0.68367346938775531,0.56122448979591821,0.43877551020408151,0.31632653061224492,0.19387755102040782,0.071428571428571175,-0.051020408163265363,-0.1734693877551019,-0.29591836734693855,-0.41836734693877564,-0.54081632653061229,-0.66326530612244894,-0.78571428571428603,-0.90816326530612268,-1.0306122448979593,-1.1530612244897958,-1.2755102040816326,-1.3979591836734691,-1.5204081632653068,-1.6428571428571432,-1.7653061224489801,-1.8877551020408165,-2.010204081632653,-2.1326530612244898],[3.9693877551020407,3.8469387755102038,3.7244897959183674,3.6020408163265301,3.4795918367346936,3.3571428571428572,3.2346938775510203,3.1122448979591835,2.9897959183673466,2.8673469387755102,2.7448979591836733,2.6224489795918364,2.5,2.3775510204081631,2.2551020408163263,2.1326530612244894,2.0102040816326525,1.8877551020408161,1.7653061224489792,1.6428571428571423,1.5204081632653059,1.3979591836734693,1.2755102040816322,1.1530612244897955,1.0306122448979589,0.90816326530612235,0.78571428571428581,0.66326530612244872,0.54081632653061207,0.41836734693877542,0.29591836734693833,0.17346938775510168,0.051020408163265141,-0.071428571428571397,-0.19387755102040805,-0.31632653061224514,-0.43877551020408179,-0.56122448979591844,-0.68367346938775553,-0.80612244897959218,-0.92857142857142883,-1.0510204081632653,-1.1734693877551021,-1.2959183673469385,-1.4183673469387763,-1.5408163265306127,-1.6632653061224496,-1.785714285714286,-1.9081632653061225,-2.0306122448979593],[4.0714285714285712,3.9489795918367347,3.8265306122448983,3.704081632653061,3.5816326530612246,3.4591836734693882,3.3367346938775513,3.2142857142857144,3.0918367346938775,2.9693877551020411,2.8469387755102042,2.7244897959183674,2.6020408163265305,2.4795918367346941,2.3571428571428572,2.2346938775510203,2.1122448979591839,1.989795918367347,1.8673469387755102,1.7448979591836733,1.6224489795918369,1.5000000000000002,1.3775510204081631,1.2551020408163265,1.1326530612244898,1.0102040816326534,0.88775510204081676,0.76530612244897966,0.64285714285714302,0.52040816326530637,0.39795918367346927,0.27551020408163263,0.15306122448979609,0.030612244897959551,-0.091836734693877098,-0.21428571428571419,-0.33673469387755084,-0.45918367346938749,-0.58163265306122458,-0.70408163265306123,-0.82653061224489788,-0.9489795918367343,-1.0714285714285712,-1.1938775510204076,-1.3163265306122454,-1.4387755102040818,-1.5612244897959187,-1.6836734693877551,-1.8061224489795915,-1.9285714285714284],[4.1734693877551017,4.0510204081632653,3.9285714285714288,3.8061224489795915,3.6836734693877551,3.5612244897959187,3.4387755102040818,3.3163265306122449,3.193877551020408,3.0714285714285716,2.9489795918367347,2.8265306122448979,2.704081632653061,2.5816326530612246,2.4591836734693877,2.3367346938775508,2.2142857142857144,2.0918367346938775,1.9693877551020407,1.8469387755102038,1.7244897959183674,1.6020408163265307,1.4795918367346936,1.357142857142857,1.2346938775510203,1.1122448979591839,0.98979591836734726,0.86734693877551017,0.74489795918367352,0.62244897959183687,0.49999999999999978,0.37755102040816313,0.25510204081632659,0.13265306122449005,0.010204081632653406,-0.11224489795918369,-0.23469387755102034,-0.35714285714285698,-0.47959183673469408,-0.60204081632653073,-0.72448979591836737,-0.8469387755102038,-0.96938775510204067,-1.0918367346938771,-1.2142857142857149,-1.3367346938775513,-1.4591836734693882,-1.5816326530612246,-1.704081632653061,-1.8265306122448979],[4.2755102040816322,4.1530612244897958,4.0306122448979593,3.908163265306122,3.7857142857142856,3.6632653061224492,3.5408163265306123,3.4183673469387754,3.2959183673469385,3.1734693877551021,3.0510204081632653,2.9285714285714284,2.8061224489795915,2.6836734693877551,2.5612244897959182,2.4387755102040813,2.3163265306122449,2.193877551020408,2.0714285714285712,1.9489795918367343,1.8265306122448979,1.7040816326530612,1.5816326530612241,1.4591836734693875,1.3367346938775508,1.2142857142857144,1.0918367346938778,0.96938775510204067,0.84693877551020402,0.72448979591836737,0.60204081632653028,0.47959183673469363,0.3571428571428571,0.23469387755102056,0.11224489795918391,-0.010204081632653184,-0.13265306122448983,-0.25510204081632648,-0.37755102040816357,-0.50000000000000022,-0.62244897959183687,-0.7448979591836733,-0.86734693877551017,-0.98979591836734659,-1.1122448979591844,-1.2346938775510208,-1.3571428571428577,-1.4795918367346941,-1.6020408163265305,-1.7244897959183674],[4.3775510204081636,4.2551020408163271,4.1326530612244898,4.0102040816326525,3.8877551020408165,3.7653061224489801,3.6428571428571432,3.5204081632653064,3.3979591836734695,3.2755102040816331,3.1530612244897962,3.0306122448979593,2.9081632653061229,2.785714285714286,2.6632653061224492,2.5408163265306123,2.4183673469387754,2.295918367346939,2.1734693877551021,2.0510204081632653,1.9285714285714288,1.8061224489795922,1.6836734693877551,1.5612244897959184,1.4387755102040818,1.3163265306122454,1.1938775510204087,1.0714285714285716,0.94897959183673497,0.82653061224489832,0.70408163265306123,0.58163265306122458,0.45918367346938804,0.33673469387755151,0.21428571428571486,0.091836734693877764,-0.030612244897958885,-0.15306122448979553,-0.27551020408163263,-0.39795918367346927,-0.52040816326530592,-0.64285714285714235,-0.76530612244897922,-0.88775510204081565,-1.0102040816326534,-1.1326530612244898,-1.2551020408163267,-1.3775510204081631,-1.4999999999999996,-1.6224489795918364],[4.4795918367346941,4.3571428571428577,4.2346938775510203,4.112244897959183,3.989795918367347,3.8673469387755106,3.7448979591836737,3.6224489795918369,3.5,3.3775510204081636,3.2551020408163267,3.1326530612244898,3.0102040816326534,2.8877551020408165,2.7653061224489797,2.6428571428571428,2.5204081632653059,2.3979591836734695,2.2755102040816326,2.1530612244897958,2.0306122448979593,1.9081632653061227,1.7857142857142856,1.6632653061224489,1.5408163265306123,1.4183673469387759,1.2959183673469392,1.1734693877551021,1.0510204081632655,0.92857142857142883,0.80612244897959173,0.68367346938775508,0.56122448979591855,0.43877551020408201,0.31632653061224536,0.19387755102040827,0.071428571428571619,-0.05102040816326503,-0.17346938775510212,-0.29591836734693877,-0.41836734693877542,-0.54081632653061185,-0.66326530612244872,-0.78571428571428514,-0.9081632653061229,-1.0306122448979593,-1.1530612244897962,-1.2755102040816326,-1.3979591836734691,-1.5204081632653059],[4.5816326530612246,4.4591836734693882,4.3367346938775508,4.2142857142857135,4.091836734693878,3.9693877551020411,3.8469387755102042,3.7244897959183674,3.6020408163265305,3.4795918367346941,3.3571428571428572,3.2346938775510203,3.1122448979591839,2.989795918367347,2.8673469387755102,2.7448979591836733,2.6224489795918364,2.5,2.3775510204081631,2.2551020408163263,2.1326530612244898,2.0102040816326534,1.8877551020408161,1.7653061224489794,1.6428571428571428,1.5204081632653064,1.3979591836734697,1.2755102040816326,1.153061224489796,1.0306122448979593,0.90816326530612224,0.78571428571428559,0.66326530612244905,0.54081632653061251,0.41836734693877586,0.29591836734693877,0.17346938775510212,0.051020408163265474,-0.071428571428571619,-0.19387755102040827,-0.31632653061224492,-0.43877551020408134,-0.56122448979591821,-0.68367346938775464,-0.8061224489795924,-0.92857142857142883,-1.0510204081632657,-1.1734693877551021,-1.2959183673469385,-1.4183673469387754],[4.6836734693877551,4.5612244897959187,4.4387755102040813,4.316326530612244,4.1938775510204085,4.0714285714285712,3.9489795918367347,3.8265306122448979,3.704081632653061,3.5816326530612246,3.4591836734693877,3.3367346938775508,3.2142857142857144,3.0918367346938775,2.9693877551020407,2.8469387755102038,2.7244897959183669,2.6020408163265305,2.4795918367346936,2.3571428571428568,2.2346938775510203,2.1122448979591839,1.9897959183673466,1.8673469387755099,1.7448979591836733,1.6224489795918369,1.5000000000000002,1.3775510204081631,1.2551020408163265,1.1326530612244898,1.0102040816326527,0.88775510204081609,0.76530612244897955,0.64285714285714302,0.52040816326530637,0.39795918367346927,0.27551020408163263,0.15306122448979598,0.030612244897958885,-0.091836734693877764,-0.21428571428571441,-0.33673469387755084,-0.45918367346938771,-0.58163265306122414,-0.7040816326530619,-0.82653061224489832,-0.94897959183673519,-1.0714285714285716,-1.193877551020408,-1.3163265306122449],[4.7857142857142856,4.6632653061224492,4.5408163265306118,4.4183673469387745,4.295918367346939,4.1734693877551017,4.0510204081632653,3.9285714285714284,3.8061224489795915,3.6836734693877551,3.5612244897959182,3.4387755102040813,3.3163265306122449,3.193877551020408,3.0714285714285712,2.9489795918367343,2.8265306122448974,2.704081632653061,2.5816326530612241,2.4591836734693873,2.3367346938775508,2.2142857142857144,2.0918367346938771,1.9693877551020404,1.8469387755102038,1.7244897959183674,1.6020408163265307,1.4795918367346936,1.357142857142857,1.2346938775510203,1.1122448979591832,0.98979591836734659,0.86734693877551006,0.74489795918367352,0.62244897959183687,0.49999999999999978,0.37755102040816313,0.25510204081632648,0.13265306122448939,0.010204081632652739,-0.11224489795918391,-0.23469387755102034,-0.35714285714285721,-0.47959183673469363,-0.60204081632653139,-0.72448979591836782,-0.84693877551020469,-0.96938775510204112,-1.0918367346938775,-1.2142857142857144],[4.8877551020408161,4.7653061224489797,4.6428571428571423,4.520408163265305,4.3979591836734695,4.2755102040816322,4.1530612244897958,4.0306122448979593,3.908163265306122,3.7857142857142856,3.6632653061224487,3.5408163265306118,3.4183673469387754,3.2959183673469385,3.1734693877551017,3.0510204081632648,2.9285714285714279,2.8061224489795915,2.6836734693877546,2.5612244897959178,2.4387755102040813,2.3163265306122449,2.1938775510204076,2.0714285714285712,1.9489795918367343,1.8265306122448979,1.7040816326530612,1.5816326530612241,1.4591836734693875,1.3367346938775508,1.2142857142857137,1.0918367346938771,0.96938775510204056,0.84693877551020402,0.72448979591836737,0.60204081632653028,0.47959183673469363,0.35714285714285698,0.23469387755101989,0.11224489795918324,-0.010204081632653406,-0.13265306122448983,-0.2551020408163267,-0.37755102040816313,-0.50000000000000089,-0.62244897959183731,-0.74489795918367419,-0.86734693877551061,-0.98979591836734704,-1.1122448979591839],[4.9897959183673475,4.8673469387755102,4.7448979591836746,4.6224489795918373,4.5,4.3775510204081645,4.2551020408163271,4.1326530612244898,4.0102040816326534,3.887755102040817,3.7653061224489801,3.6428571428571432,3.5204081632653068,3.3979591836734699,3.2755102040816331,3.1530612244897962,3.0306122448979593,2.9081632653061229,2.785714285714286,2.6632653061224492,2.5408163265306127,2.4183673469387763,2.295918367346939,2.1734693877551026,2.0510204081632657,1.9285714285714293,1.8061224489795926,1.6836734693877555,1.5612244897959189,1.4387755102040822,1.3163265306122451,1.1938775510204085,1.0714285714285721,0.94897959183673541,0.82653061224489877,0.70408163265306167,0.58163265306122502,0.45918367346938838,0.33673469387755128,0.21428571428571463,0.091836734693877986,-0.030612244897958441,-0.15306122448979531,-0.27551020408163174,-0.3979591836734695,-0.52040816326530592,-0.64285714285714279,-0.76530612244897922,-0.88775510204081565,-1.0102040816326525],[5.091836734693878,4.9693877551020407,4.8469387755102051,4.7244897959183678,4.6020408163265305,4.479591836734695,4.3571428571428577,4.2346938775510203,4.1122448979591839,3.9897959183673475,3.8673469387755106,3.7448979591836737,3.6224489795918373,3.5000000000000004,3.3775510204081636,3.2551020408163267,3.1326530612244898,3.0102040816326534,2.8877551020408165,2.7653061224489797,2.6428571428571432,2.5204081632653068,2.3979591836734695,2.2755102040816331,2.1530612244897962,2.0306122448979598,1.9081632653061231,1.785714285714286,1.6632653061224494,1.5408163265306127,1.4183673469387756,1.295918367346939,1.1734693877551026,1.0510204081632659,0.92857142857142927,0.80612244897959218,0.68367346938775553,0.56122448979591888,0.43877551020408179,0.31632653061224514,0.19387755102040849,0.071428571428572063,-0.051020408163264808,-0.17346938775510123,-0.29591836734693899,-0.41836734693877542,-0.54081632653061229,-0.66326530612244872,-0.78571428571428514,-0.90816326530612201],[5.1938775510204085,5.0714285714285712,4.9489795918367356,4.8265306122448983,4.704081632653061,4.5816326530612255,4.4591836734693882,4.3367346938775508,4.2142857142857144,4.091836734693878,3.9693877551020411,3.8469387755102042,3.7244897959183678,3.6020408163265309,3.4795918367346941,3.3571428571428572,3.2346938775510203,3.1122448979591839,2.989795918367347,2.8673469387755102,2.7448979591836737,2.6224489795918373,2.5,2.3775510204081636,2.2551020408163267,2.1326530612244903,2.0102040816326534,1.8877551020408165,1.7653061224489799,1.6428571428571432,1.5204081632653061,1.3979591836734695,1.2755102040816331,1.1530612244897964,1.0306122448979598,0.90816326530612268,0.78571428571428603,0.66326530612244938,0.54081632653061229,0.41836734693877564,0.29591836734693899,0.17346938775510257,0.051020408163265696,-0.071428571428570731,-0.19387755102040849,-0.31632653061224492,-0.43877551020408179,-0.56122448979591821,-0.68367346938775464,-0.80612244897959151],[5.295918367346939,5.1734693877551017,5.0510204081632661,4.9285714285714288,4.8061224489795915,4.683673469387756,4.5612244897959187,4.4387755102040813,4.3163265306122449,4.1938775510204085,4.0714285714285712,3.9489795918367347,3.8265306122448983,3.7040816326530615,3.5816326530612246,3.4591836734693877,3.3367346938775508,3.2142857142857144,3.0918367346938775,2.9693877551020407,2.8469387755102042,2.7244897959183678,2.6020408163265305,2.4795918367346941,2.3571428571428572,2.2346938775510208,2.1122448979591839,1.989795918367347,1.8673469387755104,1.7448979591836737,1.6224489795918366,1.5,1.3775510204081636,1.2551020408163269,1.1326530612244903,1.0102040816326532,0.88775510204081653,0.76530612244897989,0.64285714285714279,0.52040816326530615,0.3979591836734695,0.27551020408163307,0.1530612244897962,0.030612244897959773,-0.091836734693877986,-0.21428571428571441,-0.33673469387755128,-0.45918367346938771,-0.58163265306122414,-0.70408163265306101],[5.3979591836734695,5.2755102040816322,5.1530612244897966,5.0306122448979593,4.908163265306122,4.7857142857142865,4.6632653061224492,4.5408163265306118,4.4183673469387754,4.295918367346939,4.1734693877551017,4.0510204081632653,3.9285714285714288,3.806122448979592,3.6836734693877551,3.5612244897959182,3.4387755102040813,3.3163265306122449,3.193877551020408,3.0714285714285712,2.9489795918367347,2.8265306122448983,2.704081632653061,2.5816326530612246,2.4591836734693877,2.3367346938775513,2.2142857142857144,2.0918367346938775,1.9693877551020409,1.8469387755102042,1.7244897959183672,1.6020408163265305,1.4795918367346941,1.3571428571428574,1.2346938775510208,1.1122448979591837,0.98979591836734704,0.86734693877551039,0.7448979591836733,0.62244897959183665,0.5,0.37755102040816357,0.2551020408163267,0.13265306122449028,0.010204081632652517,-0.11224489795918391,-0.23469387755102078,-0.35714285714285721,-0.47959183673469363,-0.6020408163265305],[5.5,5.3775510204081627,5.2551020408163271,5.1326530612244898,5.0102040816326525,4.887755102040817,4.7653061224489797,4.6428571428571423,4.5204081632653059,4.3979591836734695,4.2755102040816322,4.1530612244897958,4.0306122448979593,3.9081632653061225,3.7857142857142856,3.6632653061224487,3.5408163265306118,3.4183673469387754,3.2959183673469385,3.1734693877551017,3.0510204081632653,2.9285714285714288,2.8061224489795915,2.6836734693877551,2.5612244897959182,2.4387755102040818,2.3163265306122449,2.193877551020408,2.0714285714285712,1.9489795918367347,1.8265306122448977,1.704081632653061,1.5816326530612246,1.4591836734693879,1.3367346938775513,1.2142857142857142,1.0918367346938775,0.96938775510204089,0.8469387755102038,0.72448979591836715,0.6020408163265305,0.47959183673469408,0.35714285714285721,0.23469387755102078,0.11224489795918302,-0.010204081632653406,-0.13265306122449028,-0.2551020408163267,-0.37755102040816313,-0.5]],"type":"surface","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="the-blood-pressure-example" class="level3">
<h3 class="anchored" data-anchor-id="the-blood-pressure-example">The blood pressure example</h3>
<p>Let’s write the equation for the blood pressure data:</p>
<p><span class="math display">\[bp_i = \beta_0 + \beta_1 \cdot age_i + \beta_2 \cdot mins\_exercise_i + \epsilon_i\]</span></p>
<p>where:</p>
<ul>
<li><span class="math inline">\(bp_i\)</span> is the blood pressure for the <span class="math inline">\(i\)</span>th observation</li>
<li><span class="math inline">\(age_i\)</span> is the age for the <span class="math inline">\(i\)</span>th observation</li>
<li><span class="math inline">\(mins\_exercise_i\)</span> is the minutes of exercise for the <span class="math inline">\(i\)</span>th observation</li>
<li><span class="math inline">\(\beta_0\)</span> is the intercept</li>
<li><span class="math inline">\(\beta_1\)</span> is the slope for age</li>
<li><span class="math inline">\(\beta_2\)</span> is the slope for minutes of exercise</li>
<li><span class="math inline">\(\epsilon_i\)</span> is the error term</li>
</ul>
<p>and the error term is assumed to be normally distributed with mean 0 and constant variance, just as was the case for simple linear regression:</p>
<p><span class="math display">\[\epsilon_i \sim N(0, \sigma^2)\]</span></p>
</section>
<section id="we-already-know-a-lot" class="level3">
<h3 class="anchored" data-anchor-id="we-already-know-a-lot">We already know a lot!</h3>
<p><strong>First</strong>, the five assumptions of the multiple linear regression model are the same as for the simple linear regression model:</p>
<ol type="a">
<li>Normality of residuals.</li>
<li>Homoscedasticity = constant variance of residuals.</li>
<li>Independence of residuals.</li>
<li>Linearity.</li>
<li>No outliers.</li>
</ol>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Think, Pair, Share (#assump-match)
</div>
</div>
<div class="callout-body-container callout-body">
<p>Review how we can check these assumptions in the simple linear regression model:</p>
<p>Match the following to the assumptions above:</p>
<ol type="1">
<li>Graph of size of residuals vs.&nbsp;fitted values.</li>
<li>QQ-plot.</li>
<li>Graph of residuals vs.&nbsp;fitted values.</li>
<li>Graph of leverage vs.&nbsp;standardized residuals.</li>
</ol>
<p>And what is missing?</p>
</div>
</div>
<p><strong>Second</strong>, we know how to estimate the parameters <span class="math inline">\(\beta_0, \beta_1, \ldots, \beta_p\)</span> using the method of least squares.</p>
<p><strong>Third</strong>, we know how to test the significance of the parameters using the <span class="math inline">\(t\)</span>-test.</p>
<p><strong>Fourth</strong>, we know how to calculate the confidence intervals for the parameters, and to make a confidence band.</p>
<p><strong>Fifth</strong>, we know how to calculate the <span class="math inline">\(R^2\)</span> value to measure the goodness of fit of the model.</p>
<p><strong>Sixth</strong>, we know how to infer the strength of the relationship between the response variable and an explanatory variable.</p>
<p><strong>Seventh</strong>, we know how to make predictions using the model, and to make a prediction band.</p>
<p><strong>What we don’t know</strong> is how to answer the four questions already mentioned above:</p>
<ul>
<li>Question 1: As an ensemble, are the explanatory variables associated with the response?</li>
<li>Question 2: Are each of the explanatory variables associated with the response?</li>
<li>Question 3: What proportion of variability is explained?</li>
<li>Question 4: Are some explanatory variables more important than others?</li>
</ul>
<p>Let’s answer these questions using the blood pressure example.</p>
</section>
<section id="fitting-the-model" class="level3">
<h3 class="anchored" data-anchor-id="fitting-the-model">Fitting the model</h3>
<p>In R, we can fit a multiple linear regression model using the <code>lm()</code> function in a very similar way to the simple linear regression model. Here is the code for the blood pressure example. To fit two explanatory variables, we simply add the second variable to the formula using the <code>+</code> sign:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(bp <span class="sc">~</span> age <span class="sc">+</span> mins_exercise, <span class="at">data =</span> bp_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="checking-the-assumptions" class="level3">
<h3 class="anchored" data-anchor-id="checking-the-assumptions">Checking the assumptions</h3>
<p>We can check the assumptions of the multiple linear regression model using the same methods as for the simple linear regression model. Here is the code for the blood pressure example:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check the assumptions</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(m1, <span class="at">which =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">5</span>), <span class="at">add.smooth =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="4-multiple-regression_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="480"></p>
</div>
</div>
<p>We see that the assumptions are met for the blood pressure example:</p>
<ol type="a">
<li>Normality of residuals: The QQ-plot shows that the residuals are normally distributed.</li>
<li>Homoscedasticity: The scale-location plot shows that the residuals have constant variance.</li>
<li>Independence of residuals: No evidence of pattern or clustering. But also need to know about study design to properly assess independence.</li>
<li>Linearity: The residuals vs.&nbsp;fitted values plot shows no clear pattern in the residuals.</li>
<li>No outliers: No points with high leverage or high residuals.</li>
</ol>
</section>
</section>
<section id="question-1-as-an-ensemble-are-the-explanatory-variables-associated-with-the-response" class="level2">
<h2 class="anchored" data-anchor-id="question-1-as-an-ensemble-are-the-explanatory-variables-associated-with-the-response">Question 1: As an ensemble, are the explanatory variables associated with the response?</h2>
<p>To answer this question, we can use the <strong><span class="math inline">\(F\)</span>-test</strong>. The null hypothesis is that the residual error variance is not significantly different from what would be expected by chance. The alternative hypothesis is that the residuals error variance is significantly lower than what would be expected by chance.</p>
<p>This hypothesis is similar to the null hypothesis that all of the slopes (regression coefficients) are equal to zero. If the null hypothesis is rejected, then at least one of the regression coefficients is significantly different from zero, and we can conclude that the explanatory variables are associated with the response.</p>
<p>OK, back to the <span class="math inline">\(F\)</span>-test.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>The <span class="math inline">\(F\)</span>-test is called the “<span class="math inline">\(F\)</span>-test” because it is based on the <span class="math inline">\(F\)</span>-distribution, which was named after the statistician <a href="https://en.wikipedia.org/wiki/Ronald_Fisher">Sir Ronald A. Fisher</a>. Fisher developed this statistical method as part of his pioneering work in analysis of variance (ANOVA) and other fields of experimental design and statistical inference.</p>
</div>
</div>
<p>Key Points Behind the Name:</p>
<ol type="1">
<li><span class="math inline">\(F\)</span>-Distribution: The test statistics of the <span class="math inline">\(F\)</span>-test (that is, the <span class="math inline">\(F\)</span>-statistic) follows the <span class="math inline">\(F\)</span>-distribution under the null hypothesis. This distribution arises when comparing the ratio of two independent sample variances or mean squares.</li>
<li>Ronald Fisher’s Contribution: Fisher introduced the <span class="math inline">\(F\)</span>-distribution in the early 20th century as a way to test hypotheses about the equality of variances and to analyze variance in regression and experimental designs. The “<span class="math inline">\(F\)</span>” in <span class="math inline">\(F\)</span>-distribution honors him.</li>
<li>Variance Ratio: The test statistic for the <span class="math inline">\(F\)</span>-test is the ratio of two variances (termed mean squares in this case), making the <span class="math inline">\(F\)</span>-distribution the natural choice for modeling this ratio when the null hypothesis is true.</li>
</ol>
<p>The <span class="math inline">\(F\)</span>-test is widely used in various contexts, including comparing variances, assessing the significance of regression models, conducting ANOVA to test for differences among group means, and comparing different models.</p>
<section id="but-what-is-the-f-statistic" class="level3">
<h3 class="anchored" data-anchor-id="but-what-is-the-f-statistic">But what is the <span class="math inline">\(F\)</span>-statistic?</h3>
<p><strong>The F-statistic is calculated as the ratio of the mean square of the model to the mean square error.</strong></p>
<p>Here’s the formula for the F-statistic: <span class="math display">\[\frac{MSM}{MSE}\]</span></p>
<p>where: * <span class="math inline">\(MSM\)</span> is the mean square of the model. * <span class="math inline">\(MSE\)</span> is the mean square error.</p>
<p>What on earth does that mean? Put simply, the F-statistic is a measure of how well the model fits the data. It compares the how much variability (variance) is explained to how much is not explained.</p>
<p>The mean square of the model (<span class="math inline">\(MSM\)</span>) is a measure of how much variability is explained.</p>
<p>The mean square of the residuals (<span class="math inline">\(MSE\)</span>) is a measure of how much variability is not explained.</p>
<ol type="1">
<li><p>If there are strong relationships in our data, a lot of variance will be explained (large <span class="math inline">\(MSM\)</span>) and not much will remain unexplained (low <span class="math inline">\(MES_{residual}\)</span>). The <span class="math inline">\(F\)</span>-statistic will be large.</p></li>
<li><p>If there are weak relationships in our data, not much variance will be explained (low <span class="math inline">\(MSM\)</span>) and a lot will remain unexplained (large <span class="math inline">\(MES_{residual}\)</span>). The F-statistic will be small.</p></li>
</ol>
<p>So, if the <span class="math inline">\(F\)</span>-statistic is large, we suspect that we can reject the null hypothesis that the explained explained variance is greater than we would expect by chance (i.e., when the slopes are zero). If the <span class="math inline">\(F\)</span>-statistic is small, we suspect that we cannot reject the null hypothesis that the explained variance is no greater than we would expect by chance, and we suspect that we cannot reject the null hypothesis that the slopes are zero.</p>
<p>The <span class="math inline">\(F\)</span>-statistic is then compared to the <span class="math inline">\(F\)</span>-distribution with <span class="math inline">\(p\)</span> and <span class="math inline">\(n-p-1\)</span> degrees of freedom, where <span class="math inline">\(p\)</span> is the number of explanatory variables and <span class="math inline">\(n\)</span> is the number of observations.</p>
</section>
<section id="calculating-the-f-statistic" class="level3">
<h3 class="anchored" data-anchor-id="calculating-the-f-statistic">Calculating the F-statistic</h3>
<p>The mean square of a model is the sum of squares of the model divided by the degrees of freedom of the model:</p>
<p><span class="math display">\[MSM = \frac{SSM}{df_{model}}\]</span></p>
<p>where <span class="math inline">\(SSM\)</span> is the sum of squares of the model and <span class="math inline">\(df_{model}\)</span> is the degrees of freedom of the model.</p>
<p>The mean square error is the sum of squares of the residuals divided by the degrees of freedom of the residuals:</p>
<p><span class="math display">\[MSE = \frac{SSE}{df_{residuals}}\]</span></p>
<p>where <span class="math inline">\(SSE\)</span> is the sum of squares of the residuals and <span class="math inline">\(df_{residuals}\)</span> is the degrees of freedom of the residuals.</p>
<section id="ssm-sse-and-sst" class="level4">
<h4 class="anchored" data-anchor-id="ssm-sse-and-sst">SSM, SSE, and SST</h4>
<p>This is a recap, since its the same as we learned in the simple linear regression model.</p>
<p><strong><span class="math inline">\(SST\)</span></strong>: The total sum of squares is the sum of the squared differences between the observed values of the response variable and the mean of the response variable. The <span class="math inline">\(SST\)</span> is a measure of the total variability in the response variable.</p>
<p>The formula for the <span class="math inline">\(SST\)</span> is:</p>
<p><span class="math display">\[SST = \sum_{i=1}^n (y_i - \bar{y})^2\]</span></p>
<p>where <span class="math inline">\(y_i\)</span> is the observed value of the response variable for the <span class="math inline">\(i\)</span>th observation, <span class="math inline">\(\bar{y}\)</span> is the mean of the response variable, and <span class="math inline">\(n\)</span> is the number of observations.</p>
<p><strong><span class="math inline">\(SSE\)</span></strong>: The residual sum of squares (<span class="math inline">\(SSE\)</span>) is the sum of the squared differences between the observed values of the response variable and the predicted values of the response variable. The equation is:</p>
<p><span class="math display">\[SSE = \sum_{i=1}^{n} (y_i - \hat{y}_i)^2\]</span></p>
<p>where <span class="math inline">\(y_i\)</span> is the observed value of the response variable, <span class="math inline">\(\hat{y}_i\)</span> is the predicted value of the response variable, and <span class="math inline">\(n\)</span> is the number of observations.</p>
<p><strong><span class="math inline">\(SSM\)</span></strong>: The model sum of squares is the sum of squares explained by the model. The model sum of squares can be calculated as:</p>
<p><span class="math display">\[SSM = SST - SSE\]</span></p>
<p>That is, the model sum of squares is the difference between the total sum of squares and the residual sum of squares.</p>
</section>
<section id="total-degrees-of-freedom" class="level4">
<h4 class="anchored" data-anchor-id="total-degrees-of-freedom">Total degrees of freedom</h4>
<p>The total degrees of freedom are the degrees of freedom associated with the total sum of squares (<span class="math inline">\(SST\)</span>).</p>
<p>In order to calculate the <span class="math inline">\(SST\)</span>, we need to calculate the mean of the response variable. This implies that we estimate one parameter (the mean of the response variable). As a consequence, we lose one degree of freedom and so there remain <span class="math inline">\(n-1\)</span> degrees of freedom associated with the total sum of squares (where <span class="math inline">\(n\)</span> is the number of observations).</p>
<p>What do we mean by “lose one degree of freedom”? Imagine we have ten observations. We can calculate the mean of these ten observations. But if we know the mean and nine of the observations, we can calculate the tenth observation. So, in a sense, once we calculate the mean, the value of one of the ten observations is fixed. This is what we mean by “losing one degree of freedom”. When we calculate and use the mean, one of the observations “loses its freedom”.</p>
<p>For example, take the numbers 1, 3, 5, 7, 9. The mean is 5. The sum of the squared differences between the observations and the mean is <span class="math inline">\((1-5)^2 + (3-5)^2 + (5-5)^2 + (7-5)^2 + (9-5)^2 = 20\)</span>. This is the total sum of squares. The degrees of freedom are <span class="math inline">\(5-1 = 4\)</span>.</p>
<p>The total degrees of freedom are the total number of observations minus one. That is, the total sum of squares is associated with <span class="math inline">\(n-1\)</span> degrees of freedom.</p>
<p>Another perspective in which to think about the total sum of squares and total degrees of freedom is to consider the intercept only model. The intercept only model is a model that only includes the intercept term. The equation of this model would be:</p>
<p><span class="math display">\[y_i = \beta_0 + \epsilon_i\]</span> The sum of the square of the residuals for this model is minimised when the predicted value of the response variable is the mean of the response variable. That is, the least squares estimate of <span class="math inline">\(\beta_0\)</span> is the mean of the response variable:</p>
<p><span class="math display">\[\hat{\beta}_0 = \bar{y}\]</span></p>
<p>Hence, the predicted value of the response variable is the mean of the response variable. The equation is:</p>
<p><span class="math display">\[\hat{y}_i = \bar{y} + \epsilon_i\]</span></p>
<p>The error term is therefore:</p>
<p><span class="math display">\[\epsilon_i = y_i - \bar{y}\]</span> And the total sum of squares is:</p>
<p><span class="math display">\[SST = \sum_{i=1}^n (y_i - \bar{y})^2\]</span></p>
<p>where <span class="math inline">\(\hat{y}_i\)</span> is the predicted value of the response variable for the <span class="math inline">\(i\)</span>th observation, <span class="math inline">\(\bar{y}\)</span> is the mean of the response variable, and <span class="math inline">\(\epsilon_i\)</span> is the residual for the <span class="math inline">\(i\)</span>th observation.</p>
<p>The intercept only model involves estimating only one parameter, so the total degrees of freedom are the total number of observations minus one <span class="math inline">\(n - 1\)</span>.</p>
<p>Therefore, the total degrees of freedom are the total number of observations minus one.</p>
<p>Bottom line: <span class="math inline">\(SST\)</span> is the residual sum of squares when we fit the intercept only model. The total degrees of freedom are the total number of observations minus one.</p>
</section>
<section id="model-degrees-of-freedom" class="level4">
<h4 class="anchored" data-anchor-id="model-degrees-of-freedom">Model degrees of freedom</h4>
<p>The model degrees of freedom are the degrees of freedom associated with the model sum of squares (<span class="math inline">\(SSM\)</span>).</p>
<p>In the case of the intercept only model, we estimated one parameter, the mean of the response variable.</p>
<p>In the case of a regression model with one continuous explanatory variable, we estimate one parameter in addition to the intercept. That is, we estimate the slope of the explanatory variable.</p>
<p>In the case of a regression model with two continuous explanatory variables, we estimate two parameters in addition to the intercept. That is, we estimate the slopes of the two explanatory variables.</p>
<p>More generally, in the case of a regression model with <span class="math inline">\(p\)</span> continuous explanatory variables, we estimate <span class="math inline">\(p\)</span> parameters in addition to the intercept. That is, we estimate the slopes of the <span class="math inline">\(p\)</span> explanatory variables.</p>
<p>Each time we estimate a new parameter, we lose a degree of freedom.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Think, Pair, Share (#lost-degrees)
</div>
</div>
<div class="callout-body-container callout-body">
<p>How many degrees of freedom are lost when this model is fit?:</p>
<p><span class="math display">\[y_i = \beta_0 + \beta_1 x_{1i} + \beta_2 x_{2i} + \epsilon_i\]</span></p>
</div>
</div>
<p>The model has three parameters: <span class="math inline">\(\beta_0\)</span>, <span class="math inline">\(\beta_1\)</span>, and <span class="math inline">\(\beta_2\)</span>. So, three degrees of freedom are lost. These three degrees of freedom are one for the intercept (<span class="math inline">\(\beta_0\)</span>) and two for the slopes of each of the two (<span class="math inline">\(p\)</span>) continuous explanatory variables (<span class="math inline">\(\beta_1\)</span> and <span class="math inline">\(\beta_2\)</span>).</p>
<p>In the case of a regression model with <span class="math inline">\(p\)</span> continuous explanatory variables, we estimate <span class="math inline">\(p+1\)</span> parameters when we include the degree of freedom used by the intercept. But recall that the hypothesis we are testing is that the slopes of the explanatory variables are zero. This means we are interested in the sum of squares explained by the model with the two slopes, compared to the sum of squares explained by the model with only the intercept. Hence the relevant degrees of freedom of the model are the difference between the degrees of freedom of the model with the two slopes and the degrees of freedom of the model with only the intercept. That is, the model degrees of freedom are <span class="math inline">\(p\)</span>.</p>
</section>
<section id="residual-degrees-of-freedom" class="level4">
<h4 class="anchored" data-anchor-id="residual-degrees-of-freedom">Residual degrees of freedom</h4>
<p>The residual degrees of freedom are the total degrees of freedom (<span class="math inline">\(n-1\)</span>) minus the degrees of freedom used by the regression model (<span class="math inline">\(p\)</span>).</p>
<p>Therefore, the residual degrees of freedom are the degrees of freedom remaining after we estimate the intercept and the slopes of the explanatory variables. There is one intercept and <span class="math inline">\(p\)</span> slopes, so the residual degrees of freedom are <span class="math inline">\(n-1-p\)</span>.</p>
</section>
<section id="finally" class="level4">
<h4 class="anchored" data-anchor-id="finally">Finally…</h4>
<p>We have everything we need to calculate the two mean squares:</p>
<p><span class="math display">\[MSE_{\text{model}} = \frac{SSM}{p}\]</span> <span class="math display">\[MSE_{\text{residual}} = \frac{SSE}{n-1-p}\]</span></p>
<p><strong>Why divide by the degrees of freedom?</strong> The more observations we have, the greater will be the total sum of squares. The more observations we have, the greater will be the residual sum of squares. So it is not very informative to compare totals. Rather, we need to compare the mean of the sums of squares. Except we don’t calculate the mean by dividing by the number of observations. Rather we divide by the degrees of freedom. The total mean square is an estimate of the variance of the response variable. And the residual mean square is an estimate of the variance of the residuals.</p>
</section>
</section>
<section id="sst-ssm-sse-and-degrees-of-freedom" class="level3">
<h3 class="anchored" data-anchor-id="sst-ssm-sse-and-degrees-of-freedom"><span class="math inline">\(SST\)</span>, <span class="math inline">\(SSM\)</span>, <span class="math inline">\(SSE\)</span>, and degrees of freedom</h3>
<p>Just a reminder and a summary of some of the material above:</p>
<ul>
<li><span class="math inline">\(SST\)</span>: degrees of freedom = <span class="math inline">\(n-1\)</span></li>
<li><span class="math inline">\(SSM\)</span>: degrees of freedom = <span class="math inline">\(p\)</span> *<span class="math inline">\(SSE\)</span>: degrees of freedom = <span class="math inline">\(n-1-p\)</span></li>
</ul>
<p>The sum of squares add up:</p>
<p><span class="math display">\[SST = SSM + SSE\]</span></p>
<p>and the degrees of freedom add up</p>
<p><span class="math display">\[(n-1) = (p) + (n-1-p)\]</span></p>
</section>
<section id="is-my-f-statistic-large-or-small" class="level3">
<h3 class="anchored" data-anchor-id="is-my-f-statistic-large-or-small">Is my <span class="math inline">\(F\)</span>-statistic large or small?</h3>
<p>Recall that “The <span class="math inline">\(F\)</span>-statistic is calculated as the ratio of the mean square of the model to the mean square error.” And that a large <span class="math inline">\(F\)</span>-statistic is evidence against the null hypothesis that the slopes of the explanatory variables are zero. And that a small <span class="math inline">\(F\)</span>-statistic is evidence to not reject the null hypothesis that the slopes of the explanatory variables are zero.</p>
<p>But how big does the F-statistic need to be in order to confidently reject the null hypothesis?</p>
<p>The null hypothesis that the explained variance of the model is no greater than would be expected by chance. Here, “by chance” means that the slopes of the explanatory variables are zero.</p>
<p><span class="math display">\[H_0: \beta_1 = \beta_2 = \ldots = \beta_p = 0\]</span> The alternative hypothesis is that the explained variance of the model is greater than would be expected by chance. This would occur if the slopes of some or all of the explanatory variables are not zero.</p>
<p><span class="math display">\[H_1: \beta_1 \neq 0 \text{ or } \beta_2 \neq 0 \text{ or } \ldots \text{ or } \beta_p \neq 0\]</span> To test this hypothesis we are going to, as usual, calculate a <span class="math inline">\(p\)</span>-value. The <span class="math inline">\(p\)</span>-value is the probability of observing a test statistic as or more extreme as the one we observed, assuming the null hypothesis is true. To do this, we need to know the distribution of the test statistic under the null hypothesis. The distribution of the test statistic under the null hypothesis is known as the <span class="math inline">\(F\)</span>-distribution.</p>
<p>The <span class="math inline">\(F\)</span>-distribution has two degrees of freedom values associated with it: the degrees of freedom of the model and the degrees of freedom of the residuals. The degrees of freedom of the model are the number of parameters estimated by the model corresponding to the null hypothesis. The degrees of freedom of the residuals are the total degrees of freedom minus the degrees of freedom of the model.</p>
<p>Here is the <span class="math inline">\(F\)</span>-distribution with 2 and 99 degrees of freedom:</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="4-multiple-regression_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="480"></p>
</div>
</div>
<p>The F-distribution is skewed to the right and has a long tail. The area to the right of 3.89 is shaded in red. This area represents the probability of observing an F-statistic as or more extreme as 3.89, assuming the null hypothesis is true. This probability is the <span class="math inline">\(p\)</span>-value of the hypothesis test.</p>
<p>The <span class="math inline">\(F\)</span>-statistic and <span class="math inline">\(F\)</span>-test is briefly recaptured in 3.1.f) of the Stahel script, but see also Mat183 chapter 6.2.5. It uses the fact that</p>
<p><span class="math display">\[\frac{MSM}{MSE} =  \frac{SSM/p}{SSE/(n-1-p)} \sim F_{p,n-1-p}\]</span></p>
<p>follows an <span class="math inline">\(F\)</span>-distribution with <span class="math inline">\(p\)</span> and <span class="math inline">\((n-1-p)\)</span> degrees of freedom, where <span class="math inline">\(p\)</span> are the number of continuous variables, <span class="math inline">\(n\)</span> the number of data points.</p>
<ul>
<li><span class="math inline">\(SSE=\sum_{i=1} ^n(y_i-\hat{y}_i)^2\)</span> is the residual sum of squares</li>
<li><span class="math inline">\(SSM = SST - SSE\)</span> is the sum of squares of the model</li>
<li><span class="math inline">\(SST=\sum_{i=1}^n(y_i-\overline{y})^2\)</span> is the total sum of squares</li>
<li><span class="math inline">\(n\)</span> is the number of data points</li>
<li><span class="math inline">\(p\)</span> is the number of explanatory variables in the regression model</li>
</ul>
</section>
<section id="source-of-variance-table" class="level3">
<h3 class="anchored" data-anchor-id="source-of-variance-table">Source of variance table</h3>
<p>The <strong>sources of variance table</strong> is a table that conveniently and clearly gives all of the quantities mentioned above. It breaks down the total sum of squares into the sum of squares explained by the model and the sum of squares due to error. The source of variance table is used to calculate the <span class="math inline">\(F\)</span>-statistic.</p>
<table class="table">
<caption>Sources of variance table</caption>
<colgroup>
<col style="width: 7%">
<col style="width: 14%">
<col style="width: 17%">
<col style="width: 30%">
<col style="width: 30%">
</colgroup>
<thead>
<tr class="header">
<th>Source</th>
<th>Sum of squares</th>
<th>Degrees of freedom</th>
<th>Mean square</th>
<th>F-statistic</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Model</td>
<td><span class="math inline">\(SSM\)</span></td>
<td><span class="math inline">\(p\)</span></td>
<td><span class="math inline">\(MSM = SSM / p\)</span></td>
<td><span class="math inline">\(\frac{MSM}{MSE_{error}}\)</span></td>
</tr>
<tr class="even">
<td>Error</td>
<td><span class="math inline">\(SSE\)</span></td>
<td><span class="math inline">\(n - 1 - p\)</span></td>
<td><span class="math inline">\(MSE_{error} = SSE / (n - 1 - p)\)</span></td>
<td></td>
</tr>
<tr class="odd">
<td>Total</td>
<td><span class="math inline">\(SST\)</span></td>
<td><span class="math inline">\(n - 1\)</span></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
</section>
<section id="the-blood-pressure-example-1" class="level3">
<h3 class="anchored" data-anchor-id="the-blood-pressure-example-1">The blood pressure example</h3>
<p>How many observations?</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] 100</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Think, Pair, Share (#three-degrees)
</div>
</div>
<div class="callout-body-container callout-body">
<p>We have two explanatory variables (age and minutes of exercise per week).</p>
<ul>
<li>How many total degrees of freedom?</li>
<li>How many degrees of freedom for the regression model?</li>
<li>How many degrees of freedom for the residuals?</li>
</ul>
</div>
</div>
<p>Fit the model in R:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(bp <span class="sc">~</span> age <span class="sc">+</span> mins_exercise, <span class="at">data =</span> bp_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Get the F-statistic:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m1)<span class="sc">$</span>fstatistic</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   value    numdf    dendf 
79.80361  2.00000 97.00000 </code></pre>
</div>
</div>
<p>Get the p-value:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>p_value <span class="ot">&lt;-</span> <span class="fu">pf</span>(<span class="fu">summary</span>(m1)<span class="sc">$</span>fstatistic[<span class="dv">1</span>],</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>              <span class="fu">summary</span>(m1)<span class="sc">$</span>fstatistic[<span class="dv">2</span>],</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>              <span class="fu">summary</span>(m1)<span class="sc">$</span>fstatistic[<span class="dv">3</span>],</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>p_value</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       value 
3.227666e-21 </code></pre>
</div>
</div>
<p>(The R-function <code>pf</code> calculates the cumulative probability distribution function of the F-distribution.)</p>
<p>And here is how we can get that information from the <code>summary</code> function. Look at the final line of the output:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = bp ~ age + mins_exercise, data = bp_data)

Residuals:
    Min      1Q  Median      3Q     Max 
-19.211  -7.032  -0.853   5.769  33.586 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   88.65837    3.75256  23.626  &lt; 2e-16 ***
age            0.51764    0.05768   8.974  2.2e-14 ***
mins_exercise -0.10086    0.01246  -8.094  1.7e-12 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 9.773 on 97 degrees of freedom
Multiple R-squared:  0.622, Adjusted R-squared:  0.6142 
F-statistic:  79.8 on 2 and 97 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
</section>
</section>
<section id="question-2-which-variables-are-associated-with-the-response" class="level2">
<h2 class="anchored" data-anchor-id="question-2-which-variables-are-associated-with-the-response">Question 2: Which variables are associated with the response?</h2>
<p>As we did for simple linear regression, we can perform a <span class="math inline">\(t\)</span>-test for each explanatory variable to determine if it is associated with the response. As before, the null hypothesis for each <span class="math inline">\(t\)</span>-test is that the slope of the explanatory variable is zero. The alternative hypothesis is that the slope of the explanatory variable is not zero.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m1)<span class="sc">$</span>coef</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                Estimate Std. Error   t value     Pr(&gt;|t|)
(Intercept)   88.6583701 3.75256098 23.626097 5.081665e-42
age            0.5176392 0.05767978  8.974362 2.195855e-14
mins_exercise -0.1008620 0.01246203 -8.093547 1.697396e-12</code></pre>
</div>
</div>
<p>Again, a 95% CI for each slope estimate <span class="math inline">\(\hat\beta_j\)</span> can be calculated with R:<br>
</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(m1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                   2.5 %      97.5 %
(Intercept)   81.2105754 96.10616493
age            0.4031609  0.63211765
mins_exercise -0.1255957 -0.07612834</code></pre>
</div>
</div>
<p>Reminder: The 95% confidence interval is <span class="math inline">\([\hat\beta - c \cdot \sigma^{(\beta)} ; \hat\beta + c \cdot \sigma^{(\beta)}]\)</span>, where <span class="math inline">\(c\)</span> is the 97.5% quantile of the <span class="math inline">\(t\)</span>-distribution with <span class="math inline">\(n-p\)</span> degrees of freedom).</p>
<p>We can also use the <code>tbl_regression</code> function within the <code>gtsummary</code> package to get a publication ready table of the coefficients and confidence intervals:</p>
<div class="cell" data-as.is="true">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gtsummary)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tbl_regression</span>(m1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div id="gcoxbxmykp" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#gcoxbxmykp table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#gcoxbxmykp thead, #gcoxbxmykp tbody, #gcoxbxmykp tfoot, #gcoxbxmykp tr, #gcoxbxmykp td, #gcoxbxmykp th {
  border-style: none;
}

#gcoxbxmykp p {
  margin: 0;
  padding: 0;
}

#gcoxbxmykp .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#gcoxbxmykp .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#gcoxbxmykp .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#gcoxbxmykp .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#gcoxbxmykp .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#gcoxbxmykp .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#gcoxbxmykp .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#gcoxbxmykp .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#gcoxbxmykp .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#gcoxbxmykp .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#gcoxbxmykp .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#gcoxbxmykp .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#gcoxbxmykp .gt_spanner_row {
  border-bottom-style: hidden;
}

#gcoxbxmykp .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#gcoxbxmykp .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#gcoxbxmykp .gt_from_md > :first-child {
  margin-top: 0;
}

#gcoxbxmykp .gt_from_md > :last-child {
  margin-bottom: 0;
}

#gcoxbxmykp .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#gcoxbxmykp .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#gcoxbxmykp .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#gcoxbxmykp .gt_row_group_first td {
  border-top-width: 2px;
}

#gcoxbxmykp .gt_row_group_first th {
  border-top-width: 2px;
}

#gcoxbxmykp .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#gcoxbxmykp .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#gcoxbxmykp .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#gcoxbxmykp .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#gcoxbxmykp .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#gcoxbxmykp .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#gcoxbxmykp .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#gcoxbxmykp .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#gcoxbxmykp .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#gcoxbxmykp .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#gcoxbxmykp .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#gcoxbxmykp .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#gcoxbxmykp .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#gcoxbxmykp .gt_left {
  text-align: left;
}

#gcoxbxmykp .gt_center {
  text-align: center;
}

#gcoxbxmykp .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#gcoxbxmykp .gt_font_normal {
  font-weight: normal;
}

#gcoxbxmykp .gt_font_bold {
  font-weight: bold;
}

#gcoxbxmykp .gt_font_italic {
  font-style: italic;
}

#gcoxbxmykp .gt_super {
  font-size: 65%;
}

#gcoxbxmykp .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#gcoxbxmykp .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#gcoxbxmykp .gt_indent_1 {
  text-indent: 5px;
}

#gcoxbxmykp .gt_indent_2 {
  text-indent: 10px;
}

#gcoxbxmykp .gt_indent_3 {
  text-indent: 15px;
}

#gcoxbxmykp .gt_indent_4 {
  text-indent: 20px;
}

#gcoxbxmykp .gt_indent_5 {
  text-indent: 25px;
}

#gcoxbxmykp .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#gcoxbxmykp div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="label"><span data-qmd-base64="PHN0cm9uZz5DaGFyYWN0ZXJpc3RpYzwvc3Ryb25nPg=="><span class="gt_from_md"><strong>Characteristic</strong></span></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="estimate"><span data-qmd-base64="PHN0cm9uZz5CZXRhPC9zdHJvbmc+"><span class="gt_from_md"><strong>Beta</strong></span></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="conf.low"><span data-qmd-base64="PHN0cm9uZz45NSUgQ0k8L3N0cm9uZz4="><span class="gt_from_md"><strong>95% CI</strong></span></span><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="p.value"><span data-qmd-base64="PHN0cm9uZz5wLXZhbHVlPC9zdHJvbmc+"><span class="gt_from_md"><strong>p-value</strong></span></span></th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="label" class="gt_row gt_left">age</td>
<td headers="estimate" class="gt_row gt_center">0.52</td>
<td headers="conf.low" class="gt_row gt_center">0.40, 0.63</td>
<td headers="p.value" class="gt_row gt_center">&lt;0.001</td></tr>
    <tr><td headers="label" class="gt_row gt_left">mins_exercise</td>
<td headers="estimate" class="gt_row gt_center">-0.10</td>
<td headers="conf.low" class="gt_row gt_center">-0.13, -0.08</td>
<td headers="p.value" class="gt_row gt_center">&lt;0.001</td></tr>
  </tbody>
  
  <tfoot class="gt_footnotes">
    <tr>
      <td class="gt_footnote" colspan="4"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span> <span data-qmd-base64="Q0kgPSBDb25maWRlbmNlIEludGVydmFs"><span class="gt_from_md">CI = Confidence Interval</span></span></td>
    </tr>
  </tfoot>
</table>
</div>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>However</strong> Please insert a note into your brain that we are dealing here with an ideal case of <strong>uncorrelated explanatory variables</strong>. You’ll learn later in the course about what happens when explanatory variables are correlated.</p>
</div>
</div>
</section>
<section id="question-3-what-proportion-of-variability-is-explained" class="level2">
<h2 class="anchored" data-anchor-id="question-3-what-proportion-of-variability-is-explained">Question 3: What proportion of variability is explained?</h2>
<section id="multiple-r2" class="level3">
<h3 class="anchored" data-anchor-id="multiple-r2">Multiple <span class="math inline">\(R^2\)</span></h3>
<p>We can calculate the <span class="math inline">\(R^2\)</span> value for the multiple linear regression model just like we already did for a simple linear regression model. The <span class="math inline">\(R^2\)</span> value is the proportion of variability in the response variable that is explained by the model. As before, the <span class="math inline">\(R^2\)</span> value ranges from 0 to 1, where 0 indicates that the model does not explain any variability in the response variable, and 1 indicates that the model explains all the variability in the response variable.</p>
<p>For multiple linear regression, we often use the term “multiple <span class="math inline">\(R^2\)</span>” to distinguish it from the <span class="math inline">\(R^2\)</span> value for simple linear regression. The multiple <span class="math inline">\(R^2\)</span> is the proportion of variability in the response variable that is explained by the model, taking into account all the explanatory variables in the model.</p>
<p>As before, for simple linear regression, the multiple <span class="math inline">\(R^2\)</span> value is calculated as the sum of squares explained by the model divided by the total sum of squares:</p>
<p><span class="math display">\[R^2 = \frac{SSM}{SST}\]</span></p>
<p>where <span class="math inline">\(SSM\)</span> is the sum of squares explained by the model and <span class="math inline">\(SST\)</span> is the total sum of squares, and <span class="math inline">\(SSM = SST - SSE\)</span>.</p>
<p>For the blood pressure data:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.6219904</code></pre>
</div>
</div>
<p><span class="math inline">\(R^2\)</span> for multiple linear regression can also be calculated as the squared correlation between <span class="math inline">\((y_1,\ldots,y_n)\)</span> and <span class="math inline">\((\hat{y}_1,\ldots,\hat{y}_n)\)</span>, where the <span class="math inline">\(\hat y\)</span> are the fitted values from the model. The fitted values are calculated as:</p>
<p><span class="math display">\[\hat{y}_i = \hat\beta_0 + \hat\beta_1 x^{(1)} + \ldots + \hat\beta_m x^{(m)}\]</span></p>
<p>In R:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>r_squared <span class="ot">&lt;-</span> <span class="fu">cor</span>(m1<span class="sc">$</span>fitted.values, bp_data<span class="sc">$</span>bp)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>r_squared</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.6219904</code></pre>
</div>
</div>
<p>Or:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>sss <span class="ot">&lt;-</span> <span class="fu">anova</span>(m1)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>SSM <span class="ot">&lt;-</span> sss<span class="sc">$</span><span class="st">`</span><span class="at">Sum Sq</span><span class="st">`</span>[<span class="dv">1</span>] <span class="sc">+</span> sss<span class="sc">$</span><span class="st">`</span><span class="at">Sum Sq</span><span class="st">`</span>[<span class="dv">2</span>]</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>SST <span class="ot">&lt;-</span> <span class="fu">sum</span>(sss<span class="sc">$</span><span class="st">`</span><span class="at">Sum Sq</span><span class="st">`</span>)</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>R_squared <span class="ot">&lt;-</span> SSM <span class="sc">/</span> SST</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>R_squared</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.6219904</code></pre>
</div>
</div>
</section>
<section id="adjusted-r2" class="level3">
<h3 class="anchored" data-anchor-id="adjusted-r2">Adjusted <span class="math inline">\(R^2\)</span></h3>
<p>However, we have a little problem to address. The <span class="math inline">\(R^2\)</span> value increases as we add more explanatory variables to the model, even if the additional variables are not associated with the response. This is because the <span class="math inline">\(R^2\)</span> value is calculated as the proportion of variability in the response variable that is explained by the model. As we add more explanatory variables to the model, the model will always explain more variability in the response variable, even if the additional variables are not associated with the response. Some of the variance will be explained by chance.</p>
<p>Here is an example of this problem. First, here’s the explanatory power of the model with only age and minutes of exercise as the explanatory variables:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.6219904</code></pre>
</div>
</div>
<p>Now, we can add a new explanatory variable to the blood pressure model that is not associated with the response:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>bp_data<span class="sc">$</span>random_variable <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="fu">nrow</span>(bp_data))</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>m2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(bp <span class="sc">~</span> age <span class="sc">+</span> mins_exercise <span class="sc">+</span> random_variable, <span class="at">data =</span> bp_data)</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m2)<span class="sc">$</span>r.squared</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.6264181</code></pre>
</div>
</div>
<p>The <span class="math inline">\(R^2\)</span> value for the model with the random variable is higher than the <span class="math inline">\(R^2\)</span> value for the model without the random variable. This is because the model with the random variable explains more variability in the response variable, even though the random variable is not associated with the response.</p>
<p>To address this problem, we can use the adjusted <span class="math inline">\(R^2\)</span> value. The adjusted <span class="math inline">\(R^2\)</span> value is calculated as:</p>
<p><span class="math display">\[R^2_{\text{adj}} = 1 - \frac{SSE / (n - p - 1)}{SST / (n - 1)}\]</span></p>
<p>where * <span class="math inline">\(SSE\)</span> is the sum of squared errors * <span class="math inline">\(SST\)</span> is the total sum of squares * <span class="math inline">\(n\)</span> is the number of observations * <span class="math inline">\(p\)</span> is the number of explanatory variables in the model.</p>
<p>Or put another way:</p>
<p><span class="math display">\[R^2_{adj} = 1-(1-R^2 )\frac{n-1}{n-p-1}\]</span> In this form, we can see that as <span class="math inline">\(p\)</span> increases (as we add explanatory variables) the term <span class="math inline">\((n-1)/(n-p-1)\)</span> increases, and the adjusted <span class="math inline">\(R^2\)</span> value will decrease if the additional variables are not associated with the response.</p>
<p>Take home: when we want to compare the explanatory power of models that differ in the number of explanatory variables, we should use the adjusted <span class="math inline">\(R^2\)</span> value.</p>
</section>
</section>
<section id="question-4-are-some-explanatory-variables-more-important-than-others" class="level2">
<h2 class="anchored" data-anchor-id="question-4-are-some-explanatory-variables-more-important-than-others">Question 4: Are some explanatory variables more important than others?</h2>
<p>How important are the explanatory variables and how important are they relative to each other?</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Think, Pair, Share (#variable-importance)
</div>
</div>
<div class="callout-body-container callout-body">
<p>How might we assess how important is each of the explanatory variables, and how important they are relative to each other?</p>
</div>
</div>
<p>The importance of an explanatory variable can be assessed by looking at the size of the coefficient for that variable. The larger the coefficient, the more important the variable is in explaining the response variable.</p>
<p>It is, however, important to remember that the size of the coefficient depends on the scale of the explanatory variable. If the explanatory variables are on different scales, then the coefficients will be on different scales and cannot be directly compared.</p>
<p>In our example, the age variable is measured in years, so the coefficient is in units mmHg (pressure) per year. The mins_exercise variable is measured in minutes, so the coefficient is in units mmHg per minute. The coefficients are on different scales and cannot be directly compared. Furthermore, the value of the coefficients would change if we measured age in months or minutes of exercise in hours.</p>
<p>There are other perspectives we can take when we’re assessing importance. For example, we cannot change our age, but we can change the number of minutes of exercise. So, the practical importance of the two variables is quite different in that sense also.</p>
<p>To compare the importance of the explanatory variables that are measured on different scales, we can standardize the variables before fitting the model. This means that we subtract the mean of the variable and divide by the standard deviation. This puts all the variables on the same scale, so the coefficients can be directly compared. The coefficients are then in units of the response variable per standard deviation of the explanatory variable.</p>
<p>However, the coefficients are then not in the original units of the explanatory variables, so it is not always easy to interpret the coefficients. So while we can compare the coefficients, they have lost a bit of their original meaning and are not so easy to interpret.</p>
<p>One way to relate the coefficients in this case is to realise that to compensate for the blood pressure increase associated with one year of age, one would need to exercise for a certain number of minutes more.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Think, Pair, Share (#exercise-age)
</div>
</div>
<div class="callout-body-container callout-body">
<p>How many minutes of exercise per week would we need to add to our fitness schedule to compensate for the blood pressure increase associated with one year of age?</p>
</div>
</div>
</section>
<section id="an-elephant-in-the-room-collinearity" class="level2">
<h2 class="anchored" data-anchor-id="an-elephant-in-the-room-collinearity">An elephant in the room: collinearity</h2>
<p>In the blood pressure data there is no evidence of correlation (collinearity) between the explanatory variables. Recall that we can check for correlation between the explanatory variables by making a scatter plot of the two explanatory variables.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="4-multiple-regression_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid figure-img" width="384"></p>
</figure>
</div>
</div>
</div>
<p>The lack of pattern is good, because with no evidence of collinearity between the explanatory variables the model coefficients are stable and easy to interpret. They are stable in the sense that including or excluding one of the explanatory variables does not change the coefficients of the other variables much.</p>
<p>If there is correlation between the explanatory variables, then the model coefficients can be unstable and difficult to interpret. This is because the model cannot distinguish between the effects of the correlated variables.</p>
<p>Here is a new version of the blood pressure data in which the age and minutes of exercise variables are correlated:</p>
<p><a href="data/bp_data_correlated.csv" download=""> Download the dataset. </a></p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="4-multiple-regression_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid figure-img" width="384"></p>
</figure>
</div>
</div>
</div>
<p>Now we fit a multiple linear regression model to the correlated data:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>                 Estimate Std. Error   t value     Pr(&gt;|t|)
(Intercept)   114.3902120 15.3868489  7.434284 4.187345e-11
age             0.3433312  0.1708701  2.009310 4.728268e-02
mins_exercise  -0.2277340  0.1469848 -1.549371 1.245493e-01</code></pre>
</div>
</div>
<p>There is a positive effect of age on blood pressure, and a negative effect of minutes of exercise. The age coefficient is just significant, with <span class="math inline">\(p = 0.473\)</span>. The minutes of exercise coefficient is not significant, with <span class="math inline">\(p = 0.125\)</span>.</p>
<p>Here is the model with only age included:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>             Estimate Std. Error   t value     Pr(&gt;|t|)
(Intercept) 91.551025 4.44272391 20.606958 2.124161e-37
age          0.574799 0.08352313  6.881914 5.627696e-10</code></pre>
</div>
</div>
<p>This gives quite different results for age. The coefficient is much larger (0.57 compared to 0.34) and it is very very unlikely that the observed relationship could have occurred if the null hypothesis were true (<span class="math inline">\(p &lt; 0.001\)</span>).</p>
<p>And here is the model with only minutes of exercise:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>                 Estimate Std. Error   t value     Pr(&gt;|t|)
(Intercept)   144.3629954 3.83158396 37.677106 4.104736e-60
mins_exercise  -0.4859533 0.07243686 -6.708646 1.273477e-09</code></pre>
</div>
</div>
<p>The same thing happens again. The coefficient for exercise is larger (-0.49 compared to -0.23) and it is very very unlikely that the observed relationship could have occurred if the null hypothesis were true (<span class="math inline">\(p &lt; 0.001\)</span>).</p>
<p>When each of the explanatory variables is included in the model separately, the coefficients are quite different from when both variables are included in the model. And when they are included in the model separately, their p-values are very low (reject null hypothesis of slope of zero), but when they are included in the model together, their p-values are much larger and give quite weak or no evidence to reject the null hypothesis of slope of zero.</p>
<p>These phenomena occur due to the correlation/collinearity between the explanatory variables. The model cannot distinguish between the effects of the correlated variables, so the coefficients are unstable and difficult to interpret.</p>
<p>Unfortunately, collinearity is a common feature of real data, and it can make the interpretation of multiple linear regression models difficult. It is sometimes possible to design observational studies to reduced or avoid collinearity, but in practice it is often difficult to escape from.</p>
<p>In designed experiments, it is standard to make the design of the experiments so that explanatory variables are completely independent (zero collinearity). A fully-factorial design with balanced replication is a good way to ensure that explanatory variables are independent. Two-way analysis of variance is then an appropriate statistical model. We will look at this design and analysis in a later lecture.</p>
<p>Collinearity also affects the interpretation of the <span class="math inline">\(R^2\)</span> values. Collinearity will cause the collinear explanatory variables to share some of the explained variance. The <span class="math inline">\(R^2\)</span> value of the multiple regression will then be less than the sum of the <span class="math inline">\(R^2\)</span> values of the individual regressions of the response variable on each of the explanatory variables separately.</p>
<p><span class="math inline">\(R^2\)</span> of the age only model:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m2_age)<span class="sc">$</span>r.squared</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.3258152</code></pre>
</div>
</div>
<p><span class="math inline">\(R^2\)</span> of the mins_exercise only model:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m2_mins_exercise)<span class="sc">$</span>r.squared</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.3147137</code></pre>
</div>
</div>
<p><span class="math inline">\(R^2\)</span> of the model with both age and mins_exercise:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m2_both)<span class="sc">$</span>r.squared</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.3420969</code></pre>
</div>
</div>
<p>In this case the two explanatory variables are strongly correlated and so share a lot of the explained variance. The <span class="math inline">\(R^2\)</span> value of the model with both explanatory variables is much less than the sum of the <span class="math inline">\(R^2\)</span> values of the models with each explanatory variable separately. In fact, either of the models with only one explanatory variable is nearly as good as the model with both explanatory variables. We don’t gain much from including another explanatory variable in the model when we already include one explanatory variable that is strongly correlated with the other.</p>
</section>
<section id="recap" class="level2">
<h2 class="anchored" data-anchor-id="recap">Recap</h2>
<p>Simple regression:</p>
<ul>
<li>How well does the model describe the data: Correlation and <span class="math inline">\(R^2\)</span></li>
<li>Are the parameter estimates compatible with some specific value (<span class="math inline">\(t\)</span>-test)?</li>
<li>What range of parameters values are compatible with the data (confidence intervals)?</li>
<li>What regression lines are compatible with the data (confidence band)?</li>
<li>What are plausible values of other data (prediction band)?</li>
</ul>
<p>Multiple regression:</p>
<ul>
<li>Multiple linear regression <span class="math inline">\(x_1\)</span>, <span class="math inline">\(x_2\)</span>, , <span class="math inline">\(x_m\)</span></li>
<li>Checking assumptions.</li>
<li><span class="math inline">\(R^2\)</span> in multiple linear regression</li>
<li><span class="math inline">\(t\)</span>-tests, <span class="math inline">\(F\)</span>-tests and <span class="math inline">\(p\)</span>-values</li>
</ul>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./3-regression.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Regression (L3&amp;4)</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./5-categorical-explanatory-variables.html" class="pagination-link">
        <span class="nav-page-text">Categorical explanatory variables (L5)</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>